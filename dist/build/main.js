(()=>{var e,t={6283:(e,t,r)=>{"use strict";var n=r(7294),a=r(3935),i=r(3727),o=r(6610),s=r(5991),c=r(3349),d=r(379),l=r(6070),m=r(7608),u=r(6156),p=r(5977),h=r(2122),f=r(1253),y=r(6010),v=r(1120),g=r(4670),_=r(2112),I=r(282),Z=r(2822),E=r(5517),T=r(998),P=r(6869),S=r(5757),C=r(8497),k=r(2865),w=r(5258),A=r(8358),D=r(2318),b=r(7812),x=r(8884),N=r(1749),O=r(9895),M=r(65),j=r(1423),R=r(5697),J=r.n(R),B=r(7748),H=r(868),L=r(8362),U=r(5431),z=r(8286),W=r(4837),F=r(3700),Y=r(5639),V=r(4436),q=r(3170),G=r(7329),K=r(8949),Q=r(381),X=r.n(Q),$=r(7563);(0,K.jQ)({enforceActions:"never"});var ee=new(function(){function e(){var t=this;if((0,o.Z)(this,e),(0,u.Z)(this,"items",""),(0,u.Z)(this,"itemsPromo",""),(0,u.Z)(this,"promoName",""),(0,u.Z)(this,"allItems",""),(0,u.Z)(this,"allItemsCat",""),(0,u.Z)(this,"banners",""),(0,u.Z)(this,"AllPrice",0),(0,u.Z)(this,"sum_div",0),(0,u.Z)(this,"cityName",0),(0,u.Z)(this,"cityNameRU",""),(0,u.Z)(this,"promo",null),(0,u.Z)(this,"userToken",null),(0,u.Z)(this,"userName",""),(0,u.Z)(this,"activePage",""),(0,u.Z)(this,"need_dops",""),(0,u.Z)(this,"free_items",""),(0,u.Z)(this,"cart_data",""),(0,u.Z)(this,"typeOrder",0),(0,u.Z)(this,"clientNumber",""),(0,u.Z)(this,"setSumDiv",(function(e){t.sum_div=parseInt(e)})),(0,u.Z)(this,"setDops",(function(e){t.need_dops=JSON.stringify(e)})),(0,u.Z)(this,"setFreeItems",(function(e){t.free_items=JSON.stringify(e)})),(0,u.Z)(this,"setCityRU",(function(e){t.cityNameRU=e})),(0,u.Z)(this,"setCity",(function(e){t.cityName=e})),(0,u.Z)(this,"setAllPrice",(function(e){t.AllPrice=e})),(0,u.Z)(this,"setPage",(function(e){t.activePage=e})),(0,u.Z)(this,"setToken",(function(e,r){t.userToken=e,t.setUserName(r),"undefined"!=typeof window&&localStorage.setItem("token",e)})),(0,u.Z)(this,"setPromo",(function(e,r){t.promo=e,localStorage.setItem("promo_name",r)})),(0,u.Z)(this,"setItemsPromo",(function(e){t.itemsPromo=JSON.stringify(e)})),(0,u.Z)(this,"setAllItemsCat",(function(e){t.allItemsCat=JSON.stringify(e)})),(0,u.Z)(this,"setItems",(function(e){var r=0,n=0,a=t.getItemsPromo();if(n=e.reduce((function(e,t){return e+parseInt(t.all_price)}),r),r=0,n+=a.reduce((function(e,t){return e+parseInt(t.all_price)}),r),t.setAllPrice(n),t.items=JSON.stringify(e),"undefined"!=typeof window){var i=e.filter((function(e){return e.count>0}));i=JSON.stringify(i),localStorage.setItem("my_cart",i)}})),(0,u.Z)(this,"saveCartData",(function(e){var r=JSON.stringify(e);t.cart_data=r,"undefined"!=typeof window&&localStorage.setItem("cartData",r)})),(0,u.Z)(this,"setAllItems",(function(e){t.allItems=JSON.stringify(e)})),"undefined"!=typeof window){if(localStorage.getItem("my_cart")){var r=JSON.parse(localStorage.getItem("my_cart")),n=[];r.forEach((function(e){n.push({name:e.name,item_id:e.item_id,count:e.count,one_price:parseInt(e.one_price),all_price:parseInt(e.one_price)*parseInt(e.count)})})),this.setItems(n)}localStorage.getItem("token")&&this.setToken(localStorage.getItem("token")),localStorage.getItem("cartData")&&(this.cartData=localStorage.getItem("cartData")),localStorage.getItem("promo_name")&&setTimeout((function(){t.getInfoPromo(localStorage.getItem("promo_name"))}),300)}(0,K.ky)(this)}return(0,s.Z)(e,[{key:"getSumDiv",value:function(){return this.sum_div}},{key:"getDops",value:function(){return 0==this.need_dops.length?[]:JSON.parse(this.need_dops,!0)}},{key:"getFreeItems",value:function(){return 0==this.free_items.length?[]:JSON.parse(this.free_items,!0)}},{key:"getCityRU",value:function(){return this.cityNameRU&&this.cityNameRU.length>0?this.cityNameRU:"Город"}},{key:"getCity",value:function(){return this.cityName}},{key:"getAllPrice",value:function(){return this.AllPrice}},{key:"getPage",value:function(){return this.activePage}},{key:"getUserName",value:function(){return this.userName&&this.userName.length>0?this.userName:""}},{key:"setUserName",value:function(e){this.userName=e}},{key:"getToken",value:function(){return this.userToken}},{key:"getInfoPromo",value:function(e){fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:$.stringify({type:"get_promo",city_id:ee.getCity(),promo_name:e})}).then((function(e){return e.json()})).then((function(t){ee.setPromo(JSON.stringify(t),e),!1===ee.checkPromo().st&&localStorage.removeItem("promo_name")}))}},{key:"getPromo",value:function(){return JSON.parse(this.promo,!0)}},{key:"checkPromo",value:function(){var e=ee.getCartData();ee.setItemsPromo([]);var t=0,r=0,n=e.orderTimes&&1!=parseInt(e.orderTimes)?e.orderPredDay+" "+e.orderPredTime:0,a=this.getPromo(),i=this.getItems(),o=this.getAllItems(),s=[];i.forEach((function(e,t){s.push({name:e.name,item_id:e.item_id,count:e.count,one_price:e.one_price,all_price:parseInt(e.one_price)*parseInt(e.count)})})),i=s,this.setItems(i);var c=[];r=i.reduce((function(e,t){return e+parseInt(t.all_price)}),t);var d,l,m=0,u=0,p=0;(e.orderType||0==e.orderType)&&(m=null!==(d=parseInt(e.orderType))&&void 0!==d?d:0,u=e.orderAddr?parseInt(e.orderAddr.point_id):0,p=null!==(l=parseInt(e.orderPic))&&void 0!==l?l:0);var h=X()(n).format("YYYY-MM-DD"),f=X()(n).format("H:mm"),y=parseInt(X()(n).format("E"));if(0==n?(h=X()(new Date).format("YYYY-MM-DD"),f=X()(new Date).format("H:mm"),y=parseInt(X()(new Date).format("E"))):(h=X()(n).format("YYYY-MM-DD"),f=X()(n).format("H:mm"),y=parseInt(X()(n).format("E"))),a){if(!a.status_promo)return{st:!1,text:a.promo_text.false};if(a.limits.date.min&&a.limits.date.max&&!(h>=a.limits.date.min&&h<=a.limits.date.max))return{st:!1,text:a.promo_text.false};if(0!=a.limits.time.min&&0!=a.limits.time.max&&!(f>=a.limits.time.min&&f<=a.limits.time.max))return{st:!1,text:a.promo_text.false};if(0!=a.limits.point_id&&!(0==m&&u==a.limits.point_id||1==m&&p==a.limits.point_id))return{st:!1,text:"Адрес для доставки или самовывоза указан некорректно. Проверьте правильность введённых данных."};if(!(0==a.limits.summ.min&&0==a.limits.summ.max||r>=a.limits.summ.min&&(a.limits.summ.max>=r||0==a.limits.summ.max)))return{st:!1,text:"Общая сумма вашего заказа превышает допустимую стоимость для применения промокода."};if(a.limits.dows&&0==parseInt(a.limits.dows[y]))return{st:!1,text:"Указанный вами день недели недоступен для применения промокода. Пожалуйста, выберите другую дату."};if(a.limits.type_order&&!(1==parseInt(a.limits.type_order)||3==parseInt(a.limits.type_order)&&0==m||2==parseInt(a.limits.type_order)&&1==m))return{st:!1,text:"Тип заказа не применим для данного промокода. Пожалуйста, отредактируйте заказ."};if(a.limits.only_kassa&&1==parseInt(a.limits.only_kassa))return{st:!1,text:"Указанный вами промокод действителен только при оплате на кассе. Пожалуйста, посетите для оформления заказа ближайшее к вам кафе."};if(a.limits.items.length>0){var v=0;if(a.limits.items.map((function(e){s.find((function(t){return t.item_id==e}))&&v++})),a.limits.items.length!=v)return{st:!1,text:a.promo_text.false}}var g=0,_=0,I=null;return 1==parseInt(a.promo_action)?(1==parseInt(a.sale.cat_sale)&&(_=parseInt(a.sale.count_sale),i.forEach((function(e,t){I=o.find((function(t){return t.id==e.item_id})),3!=parseInt(I.type)&&4!=parseInt(I.type)&&a.sale.sale_action.forEach((function(r){parseInt(e.item_id)==parseInt(r)&&(1==parseInt(a.sale.type_price)?_>0&&((g=parseInt(e.one_price)*parseInt(e.count)-parseInt(_))<=0&&(g=1),_-=parseInt(e.one_price)*parseInt(e.count),i[t].all_price=g):(g=parseInt(e.all_price)-parseInt(e.all_price)/100*parseInt(_),i[t].all_price=parseInt(g)))}))}))),2==parseInt(a.sale.cat_sale)&&(_=parseInt(a.sale.count_sale),i.forEach((function(e,t){I=o.find((function(t){return t.id==e.item_id})),3!=parseInt(I.type)&&4!=parseInt(I.type)&&a.sale.sale_action.forEach((function(r){parseInt(I.cat_id)==parseInt(r)&&(1==parseInt(a.sale.type_price)?_>0&&((g=parseInt(e.one_price)*parseInt(e.count)-parseInt(_))<=0&&(g=1),_-=parseInt(e.one_price)*parseInt(e.count),i[t].all_price=g):(g=parseInt(e.all_price)-parseInt(e.all_price)/100*parseInt(_),i[t].all_price=parseInt(g)))}))}))),3==parseInt(a.sale.cat_sale)&&(_=parseInt(a.sale.count_sale),i.forEach((function(e,t){I=o.find((function(t){return t.id==e.item_id})),3!=parseInt(I.type)&&4!=parseInt(I.type)&&(1==parseInt(a.sale.type_price)?_>0&&((g=parseInt(e.one_price)*parseInt(e.count)-parseInt(_))<=0&&(g=1),_-=parseInt(e.one_price)*parseInt(e.count),i[t].all_price=g):(g=parseInt(e.all_price)-parseInt(e.all_price)/100*parseInt(_),i[t].all_price=parseInt(g)))}))),t=0,r=0,r=i.reduce((function(e,t){return e+t.all_price}),t),ee.setAllPrice(r),{st:!0,text:a.promo_text.true}):(2==parseInt(a.promo_action)&&(a.items_add.forEach((function(e){I=o.find((function(t){return t.id==e.item_id})),c.push({item_id:e.item_id,count:e.count,one_price:I.price,all_price:e.price})})),t=0,r=0,r=i.reduce((function(e,t){return e+parseInt(t.all_price)}),t),t=0,r+=c.reduce((function(e,t){return e+parseInt(t.all_price)}),t),ee.setItemsPromo(c),ee.setAllPrice(r)),3==parseInt(a.promo_action)&&a.items_on_price.length>0&&(i.forEach((function(e,t){a.items_on_price.forEach((function(r){parseInt(e.item_id)==parseInt(r.id)&&(i[t].new_one_price=parseInt(r.price),i[t].all_price=parseInt(r.price)*parseInt(e.count))}))})),t=0,r=0,r=i.reduce((function(e,t){return e+parseInt(t.all_price)}),t),ee.setAllPrice(r)),this.setItems(i),{st:!0,text:a.promo_text.true})}return{st:!1,text:a.promo_text.false,test:a}}},{key:"getItemsPromo",value:function(){return 0==this.itemsPromo.length?[]:JSON.parse(this.itemsPromo,!0)}},{key:"getAllItemsCat",value:function(){return 0==this.allItemsCat.length?[]:JSON.parse(this.allItemsCat,!0)}},{key:"getCartData",value:function(){if("undefined"!=typeof window)return localStorage.getItem("cartData")?JSON.parse(localStorage.getItem("cartData")):[]}},{key:"getItems",value:function(){return 0==this.items.length?[]:JSON.parse(this.items,!0)}},{key:"getAllItems",value:function(){return 0==this.allItems.length?[]:JSON.parse(this.allItems,!0)}},{key:"AddItem",value:function(e){var t=ee.getItems(),r=ee.getAllItems(),n=ee.getPromo();if(!(r.length>0))return 0;var a=t.find((function(t){return t.item_id==e})),i=0;a&&(i=a.count);var o=r.find((function(t){return t.id==e}));if(o){var s=i+1,c=o.price,d=ee.check_max_count(parseInt(e));return parseInt(d)>=s?(t.some((function(t){return t.item_id==e}))?t.forEach((function(r,n){r.item_id==e&&(t[n].count=s,t[n].all_price=s*c)})):t.push({name:o.name,item_id:e,count:s,one_price:c,all_price:s*c}),ee.setItems(t),n&&ee.checkPromo(),s):s-1}}},{key:"AddCountItem",value:function(e,t){var r=ee.getItems(),n=ee.getAllItems(),a=ee.getPromo();if(!(n.length>0))return 0;var i=r.find((function(t){return t.item_id==e}));i&&i.count;var o=n.find((function(t){return t.id==e}));if(o){var s=t,c=o.price,d=ee.check_max_count(parseInt(e));return parseInt(d)>=s?(r.some((function(t){return t.item_id==e}))?r.forEach((function(t,n){t.item_id==e&&(r[n].count=s,r[n].all_price=s*c)})):r.push({name:o.name,item_id:e,count:s,one_price:c,all_price:s*c}),ee.setItems(r),a&&ee.checkPromo(),s):s-1}}},{key:"MinusItem",value:function(e){var t=ee.getItems(),r=ee.getAllItems(),n=ee.getPromo();if(r.length>0){var a=t.find((function(t){return t.item_id==e}));if(!a)return 0;var i=r.find((function(t){return t.id==e})),o=parseInt(a.count)-1,s=i.price;return o<=0&&(o=0),o>=0&&(t.map((function(r,n){r.item_id==e&&(t[n].count=o,t[n].all_price=o*s)})),ee.setItems(t)),n&&ee.checkPromo(),o}return 0}},{key:"delItem",value:function(e){var t=ee.getItems(),r=ee.getAllItems(),n=ee.getPromo();if(r.length>0){if(!t.find((function(t){return t.item_id==e})))return 0;var a=r.find((function(t){return t.id==e})),i=0,o=a.price;return i<=0&&(i=0),i>=0&&(t.map((function(r,n){r.item_id==e&&(t[n].count=i,t[n].all_price=i*o)})),ee.setItems(t)),n&&ee.checkPromo(),i}return 0}},{key:"check_need_dops",value:function(){var e=ee.getItems(),t=ee.getAllItems();if(!t||0==t.length)return[];var r=0,n=0,a=ee.getDops();if(0==a.length)return[];e.forEach((function(e){var a=t.find((function(t){return t.id==e.item_id}));if(!a)return[];14==parseInt(a.cat_id)?r+=parseInt(e.count):14!==parseInt(a.cat_id)&&5!==parseInt(a.cat_id)&&6!==parseInt(a.cat_id)&&7!==parseInt(a.cat_id)&&(n+=parseInt(e.count))}));var i=[];n>0&&0==r&&(i=a.rolls),0==n&&r>0&&(i=a.pizza),n>0&&r>0&&(i=[].concat((0,G.Z)(a.rolls),(0,G.Z)(a.pizza))),0==n&&0==r&&(i=[].concat((0,G.Z)(a.rolls),(0,G.Z)(a.pizza)));var o=[],s=[];return e.forEach((function(e){var r=t.find((function(t){return t.id==e.item_id}));if(!r)return[];7==parseInt(r.cat_id)&&o.push(r)})),o.forEach((function(e){var t=!1;i.forEach((function(r){parseInt(r.id)==parseInt(e.id)&&(t=!0)})),t||s.push(e)})),i=[].concat((0,G.Z)(i),s)}},{key:"check_max_count",value:function(e){var t=[],r=[],n=ee.getItems(),a=ee.getFreeItems();if(!a)return 99;n.forEach((function(e,n){a.forEach((function(n){parseInt(e.item_id)==parseInt(n.this_item_id)&&(n.count_in_cart=parseInt(e.count),t.push(n),r.push(parseInt(n.item_id)))}))})),r=(0,G.Z)(new Set(r));var i=[];r.forEach((function(e,r){t.forEach((function(t){if(parseInt(e)==parseInt(t.item_id)){var r=!1;i.forEach((function(n,a){parseInt(n.item_id)==parseInt(e)&&(r=!0,i[a].count+=t.count_in_cart*t.max_count)})),r||i.push({item_id:parseInt(e),count:t.count_in_cart*t.max_count})}}))}));var o=99;return i.forEach((function(t){parseInt(t.item_id)==parseInt(e)&&(o=parseInt(t.count))})),o}}]),e}());const te=ee;var re=r(3957),ne=r(64),ae=r(366),ie=r(2692),oe=r(5477),se=r(2302),ce=r(9613),de=r(8222),le=r(6847),me=r(3750),ue=r(7394),pe=r(2663),he=r(6856),fe=r(9525),ye=r(6627),ve=r.n(ye),ge=["children","value","index"];function _e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,m.Z)(e);if(t){var a=(0,m.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,l.Z)(this,r)}}var Ie=r(7563),Ze=(0,v.Z)((function(e){return{root2:{display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"center","& > svg, form":{borderRight:"0px!important"}},root3:{"& > *":{margin:e.spacing(1),width:50},"& .MuiOutlinedInput-input":{padding:"5px 10px"}},list:{width:250},fullList:{width:"auto"},root:{flexGrow:1},title:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary},paperCat:{padding:e.spacing(1),textAlign:"center",color:e.palette.text.secondary,position:"relative",justifyContent:"space-between",height:"calc(100% - 15px)",cursor:"pointer"},paperCatInfo:{position:"absolute",top:0,right:0},size1:{fontSize:"0.8rem"},scrollTable:{maxHeight:250,overflow:"auto",padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}}));function Ee(e){var t=e.children,r=e.value,a=e.index,i=(0,f.Z)(e,ge);return n.createElement("div",(0,h.Z)({role:"tabpanel",hidden:r!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},i),r===a&&n.createElement(B.Z,{p:3},t))}Ee.propTypes={children:J().node,index:J().any.isRequired,value:J().any.isRequired};var Te=(0,g.Z)((function(e){return{tooltip:{backgroundColor:"#f5f5f9",color:"rgba(0, 0, 0, 0.87)",maxWidth:220,fontSize:e.typography.pxToRem(12),border:"1px solid #dadde9"}}}))(H.ZP),Pe=function(e){(0,d.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,c.Z)(n),"changeCat",(function(e,t){n.setState({activeCat:t})})),n.state={classes:n.props.classes,activeCat:0,cats:n.props.cats},n}return(0,s.Z)(r,[{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentDidMount",value:function(){var e=this;(0,K.EH)((function(){var t=te.getAllItemsCat();te.getCity(),console.log(t),e.setState({cats:t})}))}},{key:"addToCart",value:function(e){te.AddItem(e)}},{key:"render",value:function(){var e=this;return n.createElement(n.Fragment,null,n.createElement(w.Z,{position:"static"},n.createElement(M.Z,{value:this.state.activeCat,onChange:this.changeCat,"aria-label":"simple tabs example"},this.state.cats.map((function(e,t){return n.createElement(j.Z,(0,h.Z)({label:e.name,style:{minWidth:"auto"},key:t},{id:"simple-tab-".concat(r=t),"aria-controls":"simple-tabpanel-".concat(r)}));var r})))),this.state.cats.map((function(t,r){return n.createElement(Ee,{value:e.state.activeCat,index:r,key:r},n.createElement(N.Z,{container:!0,spacing:2,className:"container",style:{paddingTop:0}},t.items.map((function(t,r){return n.createElement(N.Z,{key:r,item:!0,xs:2},n.createElement(O.Z,{className:e.state.classes.paperCat,onClick:e.addToCart.bind(e,t.id)},n.createElement(N.Z,{container:!0,direction:"column",style:{height:"100%",justifyContent:"space-around"}},n.createElement(D.Z,{component:"span",className:e.state.classes.size1},t.name),n.createElement(D.Z,{component:"span",className:e.state.classes.size1},t.price," р."),n.createElement(Te,{className:e.state.classes.paperCatInfo,placement:"top",title:n.createElement(n.Fragment,null,n.createElement("picture",null,n.createElement("source",{srcSet:"https://storage.yandexcloud.net/site-img/"+t.img_new+"300х200.webp?"+t.img_new_update,type:"image/webp"}),n.createElement("img",{src:"https://storage.yandexcloud.net/site-img/"+t.img_new+"300х200.jpg?"+t.img_new_update,alt:t.name,title:t.name,style:{height:150,width:"auto"}})),n.createElement(D.Z,{color:"inherit",className:e.state.classes.size1},t.tmp_desc),n.createElement(D.Z,{color:"inherit",className:e.state.classes.size1},t.info_weight))},n.createElement(L.Z,null)))))}))))})))}}]),r}(n.Component),Se=function(e){(0,d.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,c.Z)(n),"_isMounted",!1),n.state={classes:n.props.classes,item:n.props.item,type:n.props.type},n}return(0,s.Z)(r,[{key:"shouldComponentUpdate",value:function(e,t){return!!t.item&&(parseInt(this.state.item.all_price)!==parseInt(t.item.all_price)||parseInt(this.state.item.count)!==parseInt(t.item.count))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,(0,K.EH)((function(){if(!0===e._isMounted){var t=te.getItems().find((function(t){return t.item_id==e.state.item.item_id}));e.setState({item:t})}}))}},{key:"delItem",value:function(e){te.delItem(e)}},{key:"changeCount",value:function(e){var t=e.target.value,r=this.state.item.item_id;t.length>0&&te.AddCountItem(r,t)}},{key:"add",value:function(){te.AddItem(this.state.item.item_id)}},{key:"minus",value:function(){te.MinusItem(this.state.item.item_id)}},{key:"render",value:function(){return n.createElement(ue.Z,{hover:!0,style:0==this.state.item.count?{display:"none"}:{}},n.createElement(de.Z,null,this.state.item.name),n.createElement(de.Z,{style:{textAlign:"center"}},"promo"==this.state.type?n.createElement(D.Z,{component:"span",style:{padding:"11px 0",display:"block"}},this.state.item.count):n.createElement("div",{className:this.state.classes.root2},n.createElement(ne.Z,{onClick:this.minus.bind(this),style:{cursor:"pointer"}}),n.createElement("form",{className:this.state.classes.root3,noValidate:!0,autoComplete:"off"},n.createElement(z.Z,{variant:"outlined",onChange:this.changeCount.bind(this),value:this.state.item.count})),n.createElement(re.Z,{onClick:this.add.bind(this),style:{cursor:"pointer"}}))),n.createElement(de.Z,null,this.state.item.all_price),n.createElement(de.Z,null,"promo"!==this.state.type?n.createElement(ae.Z,{style:{cursor:"pointer",marginTop:5},onClick:this.delItem.bind(this,this.state.item.item_id)}):null))}}]),r}(n.Component),Ce=function(e){(0,d.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,c.Z)(n),"_isMounted",!1),n.state={classes:n.props.classes,items:[],main_items:[],dop_items:[],promo_items:[]},n}return(0,s.Z)(r,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0;var t=te.getItems(),r=te.getAllItems(),n=te.getItemsPromo(),a=[];n.map((function(e){var t=r.find((function(t){return t.id==e.item_id}));t&&a.push({id:e.item_id,cat_id:t.cat_id,name:t.name,desc:t.tmp_desc,count:e.count,all_price:e.all_price,img:t.img_new,imgUpdate:t.img_new_update})}));var i=[],o=[];r.length>0&&(t.map((function(e){var t=r.find((function(t){return t.id==e.item_id}));t&&7==parseInt(t.cat_id)?o.push(e):i.push(e)})),this.setState({dop_items:o,main_items:i,promo_items:a})),(0,K.EH)((function(){if(!0===e._isMounted){var t=te.getItems(),r=te.getAllItems(),n=te.getItemsPromo(),a=[];n.map((function(e){var t=r.find((function(t){return t.id==e.item_id}));t&&a.push({id:e.item_id,cat_id:t.cat_id,name:t.name,desc:t.tmp_desc,count:e.count,all_price:e.all_price,img:t.img_new,imgUpdate:t.img_new_update})}));var i=[],o=[];r.length>0&&(t.map((function(e){var t=r.find((function(t){return t.id==e.item_id}));t&&7==parseInt(t.cat_id)?o.push(e):i.push(e)})),e.setState({dop_items:o,main_items:i,promo_items:a}))}}))}},{key:"render",value:function(){var e=this;return n.createElement(O.Z,{style:{widows:"100%"}},n.createElement(le.Z,{style:{maxHeight:300}},n.createElement(se.Z,{stickyHeader:!0,"aria-label":"sticky table"},n.createElement(me.Z,null,n.createElement(ue.Z,null,n.createElement(de.Z,null,"Наимнование"),n.createElement(de.Z,{style:{textAlign:"center"}},"Кол-во"),n.createElement(de.Z,null,"Сумма"),n.createElement(de.Z,null," ",n.createElement(ae.Z,{style:{marginTop:5}})," "))),n.createElement(ce.Z,null,this.state.main_items.map((function(t,r){return n.createElement(Se,{key:r,item:t,classes:e.state.classes,type:"main"})})),this.state.dop_items.map((function(t,r){return n.createElement(Se,{key:r,item:t,classes:e.state.classes,type:"dop"})})),this.state.promo_items.map((function(t,r){return n.createElement(Se,{key:r,item:t,classes:e.state.classes,type:"promo"})}))))))}}]),r}(n.Component),ke=function(e){(0,d.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,c.Z)(n),"_isMounted",!1),n.state={classes:n.props.classes,all_addr:n.props.all_addr,defValStreet:"",defValHome:"",newAddrInfo:"",newAddrStreet:"",newAddrHome:"",newAddrPD:"",newAddrET:"",newAddrKV:"",newAddrDom:"",pd:"",et:"",kv:"",comment:"",sdacha:""},n}return(0,s.Z)(r,[{key:"checkNewAddr",value:function(){var e=this,t=document.querySelector("#newAddrStreet").value;t.length>0&&this.state.newAddrHome.length>0&&fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ie.stringify({type:"save_new_addr",city_id:te.getCity(),street:t,home:this.state.newAddrHome,user_id:-1})}).then((function(e){return e.json()})).then((function(t){if(t.st){e.setState({newAddrInfo:t.res});var r=te.getAllPrice();1==parseInt(t.res?t.res.free_drive:0)?parseInt(r)>0?te.setSumDiv(0):te.setSumDiv(1):te.setSumDiv(parseInt(t.res?t.res.sum_div:0)),e.saveData()}}))}},{key:"changeDomTrue",value:function(e){this.setState({newAddrDom:e}),this.changeData("domTrue",{target:{value:e}})}},{key:"changeData",value:function(e,t){var r=t.target.value;this.setState((0,u.Z)({},e,r)),this.saveData()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,(0,K.EH)((function(){if(e._isMounted){var t=te.getCartData();if(te.cart_data,t.orderType||0==t.orderType){e.setState({newAddrStreet:t.orderAddr&&t.orderAddr.street?t.orderAddr.street:"",newAddrHome:t.orderAddr&&t.orderAddr.home?t.orderAddr.home:"",pd:t.orderAddr&&t.orderAddr.pd?t.orderAddr.pd:"",et:t.orderAddr&&t.orderAddr.et?t.orderAddr.et:"",kv:t.orderAddr&&t.orderAddr.kv?t.orderAddr.kv:"",newAddrDom:!t.orderAddr||1!=parseInt(t.orderAddr.fake_dom)});var r=te.getAllPrice();1==parseInt(t.orderAddr?t.orderAddr.free_drive:0)?parseInt(r)>0?te.setSumDiv(0):te.setSumDiv(1):te.setSumDiv(parseInt(t.orderAddr?t.orderAddr.sum_div:0))}else e.setState({newAddrStreet:"",newAddrHome:"",pd:"",et:"",kv:"",newAddrDom:!0}),te.setSumDiv(0)}}));var t=te.getCartData();if(t.orderType||0==t.orderType){this.setState({});var r=te.getAllPrice();1==parseInt(t.orderAddr?t.orderAddr.free_drive:0)?parseInt(r)>0?te.setSumDiv(0):te.setSumDiv(1):te.setSumDiv(parseInt(t.orderAddr?t.orderAddr.sum_div:0))}}},{key:"saveData",value:function(){var e=this,t=te.getCartData();setTimeout((function(){var r={orderType:0,orderAddr:{id:-1,street:e.state.newAddrInfo?e.state.newAddrInfo.street:"",home:e.state.newAddrInfo?e.state.newAddrInfo.home:"",kv:e.state.kv,pd:e.state.pd,et:e.state.et,dom_true:e.state.newAddrDom?0:1,free_drive:e.state.newAddrInfo?e.state.newAddrInfo.free_drive:0,sum_div:e.state.newAddrInfo?e.state.newAddrInfo.sum_div:0,point_id:e.state.newAddrInfo?e.state.newAddrInfo.point_id:0,xy:e.state.newAddrInfo?e.state.newAddrInfo.xy:"",pay_active:e.state.newAddrInfo?e.state.newAddrInfo.pay_active:0},orderPic:t&&t.orderPic?t.orderPic:0,orderComment:t&&t.orderComment?t.orderComment:"",orderTimes:t&&t.orderTimes?t.orderTimes:"0",orderPredDay:t&&t.orderPredDay?t.orderPredDay:"",orderPredTime:t&&t.orderPredTime?t.orderPredTime:"",orderPay:t&&t.orderPay?t.orderPay:"0",orderSdacha:t&&t.orderSdacha?t.orderSdacha:""};te.saveCartData(r)}),500)}},{key:"render",value:function(){var e=this;return n.createElement(N.Z,{container:!0,spacing:3},n.createElement("div",{className:"mainAddr"},n.createElement(U.ZP,{freeSolo:!0,id:"newAddrStreet",style:{flex:3},value:this.state.newAddrStreet,onChange:function(t,r){e.setState({newAddrStreet:r})},onBlur:this.checkNewAddr.bind(this),options:this.state.all_addr.map((function(e){return e.value})),renderInput:function(e){return n.createElement(z.Z,(0,h.Z)({},e,{label:"Улица",margin:"normal",variant:"outlined"}))}}),n.createElement(z.Z,{label:"Дом",variant:"outlined",style:{margin:"16px 8px 8px 8px",flex:1},value:this.state.newAddrHome,onChange:function(t){return e.setState({newAddrHome:t.target.value})},onBlur:this.checkNewAddr.bind(this)})),n.createElement("div",{className:"otherAddr"},n.createElement(z.Z,{label:"Подъезд",variant:"outlined",style:{marginRight:4},value:this.state.pd,onChange:this.changeData.bind(this,"pd"),onBlur:this.changeData.bind(this,"pd")}),n.createElement(z.Z,{label:"Этаж",variant:"outlined",style:{marginRight:4,marginLeft:4},value:this.state.et,onBlur:this.changeData.bind(this,"et"),onChange:this.changeData.bind(this,"et")}),n.createElement(z.Z,{label:"Квартира",variant:"outlined",style:{marginRight:8,marginLeft:4},value:this.state.kv,onBlur:this.changeData.bind(this,"kv"),onChange:this.changeData.bind(this,"kv")})),n.createElement("div",{style:{width:"100%",marginRight:8}},n.createElement(W.Z,{disableElevation:!0,variant:"contained",className:"chooseDomTrue"},n.createElement(I.Z,{className:!0===this.state.newAddrDom?"active":"",onClick:this.changeDomTrue.bind(this,!0)},"Домофон работает"),n.createElement(I.Z,{className:!1===this.state.newAddrDom?"active":"",onClick:this.changeDomTrue.bind(this,!1)},"Домофон не работает"))))}}]),r}(n.Component),we=function(e){(0,d.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,c.Z)(n),"_isMounted",!1),n.state={classes:n.props.classes,clientAddr:n.props.clientAddr,chooseAddr:-1},n}return(0,s.Z)(r,[{key:"chooseAddr",value:function(e,t,r){var n=te.getAllPrice();if(1==parseInt(t?t.free_drive:0)?parseInt(n)>0?te.setSumDiv(0):te.setSumDiv(1):te.setSumDiv(parseInt(t?t.sum_div:0)),e!=this.state.chooseAddr){this.setState({chooseAddr:e});var a=te.getCartData();if(a.orderType||0==a.orderType){var i={orderType:0,type:"client",orderAddr:t,orderPic:a.orderPic,orderComment:a.orderComment,orderTimes:a.orderTimes,orderPredDay:a.orderPredDay,orderPredTime:a.orderPredTime,orderPay:a.orderPay,orderSdacha:a.orderSdacha};te.saveCartData(i)}else{var o={orderType:"0",type:"client",orderAddr:t,orderPic:0,orderComment:"",orderTimes:"1",orderPredDay:"",orderPredTime:"",orderPay:"",orderSdacha:""};te.saveCartData(o)}}}},{key:"chooseAddr2",value:function(e,t,r){var n=te.getAllPrice();1==parseInt(t?t.free_drive:0)?parseInt(n)>0?te.setSumDiv(0):te.setSumDiv(1):te.setSumDiv(parseInt(t?t.sum_div:0)),e!=this.state.chooseAddr&&this.setState({chooseAddr:e})}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,(0,K.EH)((function(){if(e._isMounted){var t=te.getCartData();te.cart_data,(t.orderType||0==t.orderType)&&setTimeout((function(){var r=e.state.clientAddr.findIndex((function(e,r){return e.street==t.orderAddr.street&&e.home==t.orderAddr.home}));console.log(t),r!=e.state.chooseAddr&&e.chooseAddr2(r,t.orderAddr)}),500)}}))}},{key:"saveData",value:function(){var e=this;setTimeout((function(){var t={orderType:e.state.orderType,orderAddr:e.state.orderAddr,orderPic:e.state.orderPic,orderComment:e.state.orderComment,orderTimes:e.state.orderTimes,orderPredDay:e.state.orderPredDay,orderPredTime:e.state.orderPredTime,orderPay:e.state.orderPay,orderSdacha:e.state.orderSdacha};te.saveCartData(t)}),500)}},{key:"render",value:function(){var e=this;return n.createElement(Z.Z,{component:"nav","aria-label":"main mailbox folders",style:{maxHeight:106,overflow:"auto",marginLeft:-13}},this.state.clientAddr.map((function(t,r){return n.createElement(T.Z,{button:!0,key:r,selected:e.state.chooseAddr===r,onClick:e.chooseAddr.bind(e,r,t),style:{paddingTop:0,paddingBottom:0}},n.createElement(S.Z,{primary:t.street+" "+t.home+(0==parseInt(t.pd)?"":", Пд. "+t.pd)+(0==parseInt(t.et)?"":", Эт. "+t.et)+(0==parseInt(t.kv)?"":", Кв. "+t.kv)}))})))}}]),r}(n.Component),Ae=function(e){(0,d.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,c.Z)(n),"_isMounted",!1),n.state={classes:n.props.classes,pic_point:n.props.pic_point,orderPic:0,picPointInfo:null},n}return(0,s.Z)(r,[{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,(0,K.EH)((function(){if(e._isMounted){var t=te.getCartData();te.cart_data,t.orderType&&setTimeout((function(){var r=e.state.pic_point.find((function(e){return parseInt(e.id)==parseInt(t.orderPic)}));r?e.choosePic(r):e.setState({orderPic:0,picPointInfo:null})}),500)}}));var t=te.getCartData();t.orderType&&1==t.orderType&&setTimeout((function(){var r=e.state.pic_point.find((function(e){return parseInt(e.id)==parseInt(t.orderPic)}));r&&e.choosePic(r)}),500)}},{key:"choosePic",value:function(e){this.setState({orderPic:e.id,picPointInfo:e}),te.setSumDiv(0),this.saveData()}},{key:"saveData",value:function(){var e=this,t=te.getCartData();setTimeout((function(){var r={orderType:1,orderAddr:t&&t.orderAddr?t.orderAddr:"",orderPic:e.state.orderPic,orderComment:t&&t.orderComment?t.orderComment:"",orderTimes:t&&t.orderTimes?t.orderTimes:"0",orderPredDay:t&&t.orderPredDay?t.orderPredDay:"",orderPredTime:t&&t.orderPredTime?t.orderPredTime:"",orderPay:t&&t.orderPay?t.orderPay:"0",orderSdacha:t&&t.orderSdacha?t.orderSdacha:""};te.saveCartData(r)}),500)}},{key:"render",value:function(){var e=this;return n.createElement(N.Z,{container:!0,direction:"column",justify:"space-between",alignItems:"stretch",spacing:3,className:"container"},this.state.pic_point.map((function(t,r){return n.createElement(I.Z,{key:r,onClick:e.choosePic.bind(e,t),style:{backgroundColor:e.state.orderPic==t.id?"#CC0033":"#e5e5e5",color:e.state.orderPic==t.id?"#fff":"#000"},className:"boxPic"},t.addr)})))}}]),r}(n.Component),De=function(e){(0,d.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,c.Z)(n),"_isMounted",!1),(0,u.Z)((0,c.Z)(n),"_thisEdit",!1),(0,u.Z)((0,c.Z)(n),"changeTypeTime",(function(e,t){n._thisEdit=!0,n.changeData("typeTime",{target:{value:t}}),n.loadTimeWait()})),n.state={classes:n.props.classes,textAvgTime:"Среднее время: ~",date:"",time:"",typeTime:0,timePred:[],date_pred:n.props.date_pred},n}return(0,s.Z)(r,[{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,(0,K.EH)((function(){te.getCartData(),te.cart_data,e._isMounted&&(e._thisEdit||e.startData())})),this.startData()}},{key:"loadTimePred",value:function(){var e,t,r=this,n=[],a=te.getItems(),i=te.getCartData();(i.orderType+1!=1||i.orderAddr&&i.orderAddr.point_id)&&(a.forEach((function(e){n.push({item_id:e.item_id,count:e.count})})),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ie.stringify({type:"get_times_pred_web",point_id:i.orderType+1==1?null!==(e=i.orderAddr.point_id)&&void 0!==e?e:0:null!==(t=i.orderPic)&&void 0!==t?t:0,type_order:1,date:i.date,cart:JSON.stringify(n)})}).then((function(e){return e.json()})).then((function(e){console.log(e),e.st&&r.setState({timePred:e.data})})))}},{key:"loadTimeWait",value:function(){var e,t,r=this,n=te.getCartData();fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ie.stringify({type:"load_time_wait",point_id:n.orderType+1==1?null!==(e=n.orderAddr.point_id)&&void 0!==e?e:0:null!==(t=n.orderPic)&&void 0!==t?t:0,city_id:te.getCity()})}).then((function(e){return e.json()})).then((function(e){r.setState({textAvgTime:e})}))}},{key:"changeData",value:function(e,t){var r=this;this._thisEdit=!0;var n=t.target.value;this.setState((0,u.Z)({},e,n)),"date"==e&&setTimeout((function(){r.loadTimePred()}),300),this.saveData()}},{key:"saveData",value:function(){var e=this,t=te.getCartData();setTimeout((function(){var r={orderType:t&&t.orderType?t.orderType:"0",orderAddr:t&&t.orderAddr?t.orderAddr:"",orderPic:t&&t.orderPic?t.orderPic:"0",orderComment:t&&t.orderComment?t.orderComment:"",orderTimes:e.state.typeTime,orderPredDay:e.state.date,orderPredTime:e.state.time,orderPay:t&&t.orderPay?t.orderPay:"0",orderSdacha:t&&t.orderSdacha?t.orderSdacha:""};te.saveCartData(r)}),500)}},{key:"startData",value:function(){var e=this;this._thisEdit=!0;var t=te.getCartData();if(t){var r=t.orderPredDay;if(0==this.state.date_pred.filter((function(e){return e.date<r})).length)return this.changeTypeTime(null,0),void this.setState({time:"",date:""});this.setState({date:r}),setTimeout((function(){e.loadTimePred(),setTimeout((function(){if(t.orderPredTime){var r=e.state.timePred.filter((function(e){return e.value==t.orderPredTime}));console.log("check_time",r),0==r.length?e.changeTypeTime(null,0):e.setState({time:t.orderPredTime})}}),1e3)}),500)}t.orderTimes&&this.setState({typeTime:t.orderTimes}),this._thisEdit=!1}},{key:"render",value:function(){return n.createElement(n.Fragment,null,n.createElement(N.Z,{container:!0,spacing:3,className:"container"},n.createElement(M.Z,{value:this.state.typeTime,onChange:this.changeTypeTime,style:{marginTop:15,width:"100%",marginBottom:10},indicatorColor:"primary",textColor:"primary",centered:!0},n.createElement(j.Z,{label:"По текущему"}),n.createElement(j.Z,{label:"Ко времени"}))),0==this.state.typeTime?n.createElement(N.Z,{container:!0,spacing:3,className:"container"},n.createElement(D.Z,{component:"span",style:{padding:"8px 0px",fontSize:"1rem"}},this.state.textAvgTime)):n.createElement(N.Z,{container:!0,spacing:3,className:"container"},n.createElement("div",{className:"formPred"},n.createElement(V.Z,{variant:"outlined",className:"formControl"},n.createElement(F.Z,null,"Дата"),n.createElement(q.Z,{value:this.state.date,onChange:this.changeData.bind(this,"date"),label:"Дата"},this.state.date_pred.map((function(e,t){return n.createElement(Y.Z,{key:t,value:e.date},e.text)})))),n.createElement(V.Z,{variant:"outlined",className:"formControl"},n.createElement(F.Z,null,"Время"),n.createElement(q.Z,{value:this.state.time,onChange:this.changeData.bind(this,"time"),label:"Время"},this.state.timePred.map((function(e,t){return n.createElement(Y.Z,{key:t,value:e.value},e.text)})))))))}}]),r}(n.Component),be=function(e){(0,d.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,c.Z)(n),"_isMounted",!1),(0,u.Z)((0,c.Z)(n),"clickOrderStart",!1),(0,u.Z)((0,c.Z)(n),"startOrderInterval",90),(0,u.Z)((0,c.Z)(n),"startOrderIntervalTimer",null),(0,u.Z)((0,c.Z)(n),"componentDidMount",(function(){n._isMounted=!0;var e=te.getCartData(),t=localStorage.getItem("cityID");t?(te.setCity(t),n.setState({cityID:t})):(te.setCity(1),n.setState({cityID:1})),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ie.stringify({type:"get_cat",city_id:te.getCity()})}).then((function(e){return e.json()})).then((function(e){n.setState({cats:e.arr,cityList:e.city_list}),te.setAllItemsCat(e.arr),te.setAllItems(e.all_items)})).catch((function(e){})),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ie.stringify({type:"get_by_mi",city_id:te.getCity(),user_id:0})}).then((function(e){return e.json()})).then((function(e){n.setState({pic_point:e.get_addr_pic.points,all_addr:e.get_addr,date_pred:e.date_pred})})),(0,K.EH)((function(){if(n._isMounted){var e=te.getCity(),t=te.getCartData();te.cart_data,parseInt(e)!=parseInt(n.state.cityID)&&(n.setState({cityID:e}),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ie.stringify({type:"get_cat",city_id:e})}).then((function(e){return e.json()})).then((function(e){n.setState({cats:e.arr,cityList:e.city_list}),console.log("update",e.arr),te.setAllItemsCat(e.arr),te.setAllItems(e.all_items)})).catch((function(e){})),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ie.stringify({type:"get_by_mi",city_id:e,user_id:0})}).then((function(e){return e.json()})).then((function(e){n.setState({pic_point:e.get_addr_pic.points,all_addr:e.get_addr,date_pred:e.date_pred})}))),parseInt(t.orderType)!=parseInt(n.state.typeOrder)&&n.setState({typeOrder:t.orderType}),t.orderComment!=n.state.comment&&n.setState({comment:t.orderComment}),parseInt(t.orderSdacha)!=parseInt(n.state.sdacha)&&n.setState({sdacha:t.orderSdacha}),te.clientNumber!=n.state.clientNumber&&(n.setState({clientNumber:te.clientNumber}),setTimeout((function(){n.getAddr()}),300));var r=te.getAllPrice(),a=te.getSumDiv();parseInt(r)!=parseInt(n.state.AllPrice)&&n.setState({AllPrice:r}),parseInt(a)!=parseInt(n.state.sumDiv)&&n.setState({sumDiv:a})}})),e&&e.orderType&&n.setState({activeTab:1==parseInt(e.orderType)?1:0,typeOrder:parseInt(e.orderType),comment:e.comment?e.comment:"",sdacha:e.sdacha?e.sdacha:""})})),(0,u.Z)((0,c.Z)(n),"changeTab",(function(e,t){var r=0==parseInt(t)||1==parseInt(t)?parseInt(t):0;n.setState({activeTab:t,typeOrder:r}),n.saveData()})),n.state={classes:n.props.classes,newOrder:null,orderCheck:!1,spiner:!1,cityID:0,AllPrice:0,sumDiv:0,activeTab:0,clientNumber:"",cityList:[],cats:[],all_addr:[],pic_point:[],timePred:[],date_pred:[],clientAddr:[],comment:"",sdacha:"",orderDate:"",orderTime:"",typeOrder:0},n}return(0,s.Z)(r,[{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"getAddr",value:function(){var e=this;fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ie.stringify({type:"get_user_addrs",city_id:te.getCity(),login:this.state.clientNumber})}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({clientAddr:t})}))}},{key:"changeData",value:function(e,t){var r=t.target.value;this.setState((0,u.Z)({},e,r)),this.saveData()}},{key:"saveData",value:function(){var e=this,t=te.getCartData();setTimeout((function(){var r={orderType:e.state.typeOrder,orderAddr:t&&t.orderAddr?t.orderAddr:"",orderPic:t&&t.orderPic?t.orderPic:"0",orderComment:e.state.comment,orderTimes:t&&t.orderTimes?t.orderTimes:"0",orderPredDay:t&&t.orderPredDay?t.orderPredDay:"",orderPredTime:t&&t.orderPredTime?t.orderPredTime:"",orderPay:t&&t.orderPay?t.orderPay:"0",orderSdacha:e.state.sdacha};te.saveCartData(r)}),500)}},{key:"startOrderNext",value:function(){var e=this;if(0==this.clickOrderStart){this.clickOrderStart=!0,clearTimeout(this.startOrderIntervalTimer);var t=te.getCartData();this.setState({spiner:!0});var r=[];te.getItems().forEach((function(e){e.count>0&&r.push({name:e.name,count:e.count,price:e.all_price,id:e.item_id})})),console.log({timePred:JSON.stringify({value:0==parseInt(t.orderTimes)?0:t.orderPredDay+" "+t.orderPredTime}),typeOrder:t.orderType,addrPic:t.orderPic,comment:t.orderComment,sdacha:t.orderSdacha,addrDev:t.orderAddr?JSON.stringify(t.orderAddr):"",payFull:JSON.stringify({type:"cash"}),cart:JSON.stringify(r),promo_name:localStorage.getItem("promo_name"),number:te.clientNumber}),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ie.stringify({type:"createOrder",city_id:te.getCity(),user_id:0,timePred:JSON.stringify({value:0==parseInt(t.orderTimes)?0:t.orderPredDay+" "+t.orderPredTime}),typeOrder:t.orderType,addrPic:t.orderPic,comment:t.orderComment,sdacha:t.orderSdacha,addrDev:t.orderAddr?JSON.stringify(t.orderAddr):"",payFull:JSON.stringify({type:"cash"}),cart:JSON.stringify(r),promo_name:localStorage.getItem("promo_name"),number:te.clientNumber})}).then((function(e){return e.json()})).then((function(r){console.log("start",r),setTimeout((function(){e.setState({spiner:!1}),e.clickOrderStart=!1}),500),e.setState({newOrder:{cart:r.my_cart,order_id:r.order_id,point_name:r.point_name,time_wait:r.time_wait_order,typeOrder:0==parseInt(t.orderType)?"Доставка":"Самовывоз",number:te.clientNumber,comment:0==parseInt(t.orderType)?t.orderComment:"",sdacha:0==parseInt(t.orderType)?t.orderSdacha:"",timePred:0==parseInt(t.orderTimes)?"":t.orderPredDay+" "+t.orderPredTime,addr:0==parseInt(t.orderType)?t.orderAddr:{},promoName:localStorage.getItem("promo_name")}}),setTimeout((function(){e.setState({orderCheck:!0}),console.log(e.state.newOrder)}),500),console.log({cart:r.my_cart,order_id:r.order_id,point_name:r.point_name,typeOrder:0==parseInt(t.orderType)?"Доставка":"Самовывоз",number:te.clientNumber,comment:0==parseInt(t.orderType)?t.orderComment:"",sdacha:0==parseInt(t.orderType)?t.orderSdacha:"",timePred:0==parseInt(t.orderTimes)?"":t.orderPredDay+" "+t.orderPredTime,addr:0==parseInt(t.orderType)?t.orderAddr:{},cartData:t})}))}}},{key:"render",value:function(){var e,t=this;return n.createElement(N.Z,{container:!0,spacing:0},n.createElement(ie.Z,{open:this.state.spiner,style:{zIndex:99,color:"#fff"}},n.createElement(oe.Z,{color:"inherit"})),n.createElement(N.Z,{item:!0,xs:8,style:{paddingRight:16}},this.state.cityList.length>0?n.createElement(xe,{classes:this.state.classes,cityList:this.state.cityList}):null),n.createElement(N.Z,{item:!0,xs:8,style:{padding:"24px 8px 0px 16px"}},n.createElement(Ce,{classes:this.state.classes})),n.createElement(N.Z,{item:!0,xs:4,style:{padding:"16px",marginTop:-50},className:"container"},n.createElement(M.Z,{value:this.state.activeTab,onChange:this.changeTab,indicatorColor:"primary",textColor:"primary",centered:!0,style:{width:"100%",marginBottom:10}},n.createElement(j.Z,{label:"Доставка"}),n.createElement(j.Z,{label:"Самовывоз"}),n.createElement(j.Z,{label:"Адрес клиента"})),0==this.state.activeTab?this.state.all_addr.length>0?n.createElement(ke,{classes:this.state.classes,all_addr:this.state.all_addr}):null:1==this.state.activeTab?this.state.pic_point.length>0?n.createElement(Ae,{classes:this.state.classes,pic_point:this.state.pic_point}):null:this.state.clientAddr.length>0?n.createElement(we,{classes:this.state.classes,clientAddr:this.state.clientAddr}):null,(0==this.state.activeTab||2==this.state.activeTab)&&this.state.all_addr.length>0?n.createElement(N.Z,{container:!0,spacing:3,style:{marginTop:12}},n.createElement("div",{className:"addrComment"},n.createElement(z.Z,(e={label:"Комментарий курьеру",variant:"outlined",multiline:!0,rowsMax:2},(0,u.Z)(e,"variant","outlined"),(0,u.Z)(e,"value",this.state.comment),(0,u.Z)(e,"onChange",this.changeData.bind(this,"comment")),(0,u.Z)(e,"onBlur",this.changeData.bind(this,"comment")),e)),n.createElement(z.Z,{label:"Сдача",variant:"outlined",value:this.state.sdacha,onChange:this.changeData.bind(this,"sdacha"),onBlur:this.changeData.bind(this,"sdacha")}))):null,this.state.date_pred.length>0?n.createElement(De,{classes:this.state.classes,date_pred:this.state.date_pred}):null,n.createElement(N.Z,{container:!0,spacing:3,className:"container"},n.createElement("form",{className:"blockTotalOrder",noValidate:!0,autoComplete:"off",style:{width:"100%",marginRight:8,marginTop:3}},n.createElement("div",{style:{display:"flex",flexDirection:"column"}},n.createElement(D.Z,{variant:"h6",component:"span",style:{fontSize:"0.8rem",color:"#bababa"}},"Доставка: ",this.state.sumDiv," р"),n.createElement(D.Z,{variant:"h6",component:"span"},"К оплате: ",parseInt(this.state.AllPrice)+parseInt(this.state.sumDiv)," р")),n.createElement(I.Z,{variant:"contained",color:"primary",onClick:this.startOrderNext.bind(this)},"Оформить заказ")))),n.createElement(N.Z,{item:!0,xs:12,style:{padding:"16px 0px 0px 0px"}},this.state.cats.length>0?n.createElement(Pe,{classes:this.state.classes,cats:this.state.cats}):null),!0===this.state.orderCheck?n.createElement(pe.Z,{open:this.state.orderCheck,fullWidth:!0,onClose:function(){return t.setState({orderCheck:!1})},className:"DialogOrderCheckDialog"},n.createElement(D.Z,{variant:"h5",component:"span",className:"orderCheckTitle"}," ",this.state.newOrder.typeOrder," #",this.state.newOrder.order_id," на ",this.state.newOrder.point_name),n.createElement(ae.Z,{className:"closeDialog",color:"inherit",onClick:function(){return t.setState({orderCheck:!1})}}),n.createElement(fe.Z,{style:{display:"flex",flexDirection:"column"}},""!==this.state.newOrder.timePred?n.createElement(D.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Время предзаказа: ",this.state.newOrder.timePred):n.createElement(D.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Время ожидания: ",this.state.newOrder.time_wait),"Доставка"==this.state.newOrder.typeOrder?n.createElement(D.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Доставка: ",this.state.newOrder.addr?this.state.newOrder.addr.street+" "+this.state.newOrder.addr.home+(0==parseInt(this.state.newOrder.addr.pd)?"":", Пд. "+this.state.newOrder.addr.pd)+(0==parseInt(this.state.newOrder.addr.et)?"":", Эт. "+this.state.newOrder.addr.et)+(0==parseInt(this.state.newOrder.addr.kv)?"":", Кв. "+this.state.newOrder.addr.kv):null):n.createElement(D.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Самовывоз: ",this.state.newOrder.point_name),"Доставка"==this.state.newOrder.typeOrder&&this.state.newOrder.addr&&1==parseInt(this.state.newOrder.addr.dom_true)?n.createElement(D.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Домофон не работает"):null,this.state.newOrder.promoName?n.createElement(D.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Промокод: ",this.state.newOrder.promoName):null,"Доставка"==this.state.newOrder.typeOrder&&this.state.newOrder.comment.length>0?n.createElement(D.Z,{variant:"h5",component:"span",className:"nameSdacha orderCheckText"},"Комментарий: ",this.state.newOrder.comment):null,"Доставка"==this.state.newOrder.typeOrder&&this.state.newOrder.sdacha.length>0?n.createElement(D.Z,{variant:"h5",component:"span",className:"nameSdacha orderCheckText"},"Сдача с: ",this.state.newOrder.sdacha,"р"):null,n.createElement("table",{className:"tableOrderCheck"},n.createElement("tbody",null,this.state.newOrder.cart.map((function(e,t){return parseInt(e.count)>0?n.createElement("tr",{key:t},n.createElement("td",{style:{width:"60%"}},n.createElement(D.Z,{variant:"h5",component:"span",className:"orderCheckText"},e.name)),n.createElement("td",null,n.createElement(D.Z,{variant:"h5",component:"span",className:"orderCheckText"},e.count)),n.createElement("td",null,n.createElement(D.Z,{variant:"h5",component:"span",className:"namePrice orderCheckText"},e.new_full_price?e.new_full_price:e.full_price," р"))):null})),"Доставка"==this.state.newOrder.typeOrder?n.createElement("tr",null,n.createElement("td",{style:{width:"60%"}},n.createElement(D.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Доставка")),n.createElement("td",null,n.createElement(D.Z,{variant:"h5",component:"span",className:"orderCheckText"},"1")),n.createElement("td",null,n.createElement(D.Z,{variant:"h5",component:"span",className:"namePrice orderCheckText"},te.getSumDiv()," р"))):null),n.createElement("tfoot",null,n.createElement("tr",null,n.createElement("td",{colSpan:"2"},n.createElement(D.Z,{variant:"h5",component:"span",className:"orderCheckText bold"},"Сумма заказа")),n.createElement("td",null,n.createElement(D.Z,{variant:"h5",component:"span",className:"namePrice orderCheckText"},parseInt(te.getAllPrice())+parseInt(te.getSumDiv())," р")))))),n.createElement(he.Z,{style:{padding:"12px 24px",paddingBottom:24}},n.createElement(W.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorder",style:{width:"100%"},onClick:function(){}},n.createElement(I.Z,{variant:"contained",style:{width:"100%"},className:"BtnCardMain CardInCardItem"},"Подтвердить заказ")))):null)}}]),r}(n.Component),xe=function(e){(0,d.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,c.Z)(n),"componentDidMount",(function(){n._isMounted=!0;var e="";if(localStorage.getItem("clientNumber")&&(e=localStorage.getItem("clientNumber"),te.clientNumber=e,n.setState({number:e})),localStorage.getItem("promo_name")){var t=localStorage.getItem("promo_name");setTimeout((function(){n.setState({promo_name:t}),n.checkPromo({target:{value:t}})}),500)}})),n.state={classes:n.props.classes,cityList:n.props.cityList,city:te.getCity(),number:"",orderPromoText:"",promo_name:"",promoST:!1,top:!1,left:!1,bottom:!1,right:!1},n}return(0,s.Z)(r,[{key:"saveNumber",value:function(e){var t=e.target.value;t=(t=(t=(t=(t=t.split(" ").join("")).split("(").join("")).split(")").join("")).split("-").join("")).slice(1),te.clientNumber="8"+t,localStorage.setItem("clientNumber","8"+t)}},{key:"checkPromo",value:function(e){var t=this,r=e.target.value;fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ie.stringify({type:"get_promo",city_id:te.getCity(),promo_name:r})}).then((function(e){return e.json()})).then((function(e){te.setPromo(JSON.stringify(e),r);var n=te.checkPromo();!1===n.st&&localStorage.removeItem("promo_name"),0==r.length?t.setState({orderPromoText:"",promoST:!1}):t.setState({orderPromoText:n.text,promoST:n.st})}))}},{key:"toggleDrawer2",value:function(e,t,r){this.setState((0,u.Z)({},e,t))}},{key:"clear",value:function(){te.clientNumber="",localStorage.removeItem("clientNumber"),te.setItems([]),te.saveCartData({orderType:"0",orderAddr:"",orderPic:0,orderComment:"",orderTimes:0,orderPredDay:"",orderPredTime:"",orderPay:"",orderSdacha:""}),this.checkPromo({target:{value:""}}),this.setState({number:"",promo_name:"",orderPromoText:""})}},{key:"changeCity",value:function(e){var t=e.target.value;this.setState({city:t}),te.setCity(t),localStorage.setItem("cityID",t),te.saveCartData({orderType:"0",orderAddr:"",orderPic:0,orderComment:"",orderTimes:0,orderPredDay:"",orderPredTime:"",orderPay:"",orderSdacha:""}),setTimeout((function(){location.reload()}),500)}},{key:"render",value:function(){var e=this;return n.createElement("div",{className:this.state.classes.root},n.createElement(w.Z,{position:"static",style:{backgroundColor:"#fff",color:"#000"}},n.createElement(A.Z,{style:{minHeight:48,height:48}},n.createElement(b.Z,{edge:"start",onClick:this.toggleDrawer2.bind(this,"left",!0),color:"inherit","aria-label":"menu"},n.createElement(x.Z,null)),n.createElement(N.Z,{container:!0,className:"headerInput"},n.createElement(N.Z,{item:!0,xs:3},n.createElement(V.Z,{className:this.state.classes.formControl},n.createElement(F.Z,{style:{paddingBottom:2}},"Город"),n.createElement(q.Z,{style:{marginTop:9},value:this.state.city,onChange:this.changeCity.bind(this)},this.state.cityList.map((function(e,t){return n.createElement(Y.Z,{key:t,value:e.id},e.name)}))))),n.createElement(N.Z,{item:!0,xs:6,style:{paddingTop:5,display:"flex",alignItems:"baseline"}},n.createElement(z.Z,{label:"Промокод",value:this.state.promo_name,onChange:function(t){return e.setState({promo_name:t.target.value})},onBlur:this.checkPromo.bind(this),style:{marginRight:4,marginLeft:4}}),n.createElement(Te,{placement:"bottom",title:n.createElement(n.Fragment,null,n.createElement(D.Z,{color:"inherit",className:this.state.classes.size1},this.state.orderPromoText))},n.createElement(I.Z,{variant:"contained",color:"primary",style:{padding:"2px 6px",minWidth:30,marginRight:8,backgroundColor:!1===this.state.promoST&&0==this.state.orderPromoText.length?"gray":!1===this.state.promoST&&this.state.orderPromoText.length>0?"red":"green"}},"?")),n.createElement(I.Z,{variant:"contained",color:"primary",style:{padding:"2px 6px",minWidth:30},onClick:this.clear.bind(this)},"Х")),n.createElement(N.Z,{item:!0,xs:3,style:{paddingTop:14}},n.createElement(ve(),{className:"InputMask",mask:"8 (999) 999-99-99",placeholder:"8 (999) 999-99-99",style:{marginRight:4,marginLeft:4},value:this.state.number,onChange:function(t){return e.setState({number:t.target.value})},onBlur:this.saveNumber.bind(this)}))))),n.createElement(_.ZP,{anchor:"left",open:this.state.left,onClose:this.toggleDrawer2.bind(this,"left",!1)},n.createElement("div",{className:(0,y.Z)(this.state.classes.list),role:"presentation"},n.createElement(Z.Z,null,["Inbox","Starred","Send email","Drafts"].map((function(e,t){return n.createElement(T.Z,{button:!0,key:e},n.createElement(P.Z,null,t%2==0?n.createElement(C.Z,null):n.createElement(k.Z,null)),n.createElement(S.Z,{primary:e}))}))),n.createElement(E.Z,null),n.createElement(Z.Z,null,["All mail","Trash","Spam"].map((function(e,t){return n.createElement(T.Z,{button:!0,key:e},n.createElement(P.Z,null,t%2==0?n.createElement(C.Z,null):n.createElement(k.Z,null)),n.createElement(S.Z,{primary:e}))}))))))}}]),r}(n.Component);function Ne(){var e=Ze();return n.createElement("div",{className:e.root},n.createElement(be,{classes:e}))}r(7563);var Oe=function(e){(0,d.Z)(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,m.Z)(t);if(r){var a=(0,m.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,l.Z)(this,e)});function i(e){var t;return(0,o.Z)(this,i),t=a.call(this,e),(0,u.Z)((0,c.Z)(t),"componentDidMount",(function(){})),t.state={categoryItems:[],cartItems:[],activePage:"",is_load:!1,openCity:!1,cityName:"",testData:[1,2,3,4,5,6,7],cityList:[],openLogin:!1,userLogin:"",userLoginFormat:"",userCode:"",stage_1:!0,stage_2:!1,timerSMS:59,errPhone:"",errSMS:"",userName:"",soc_link:null},t}return(0,s.Z)(i,[{key:"render",value:function(){return n.createElement("div",null)}}]),i}(n.Component),Me=r(150);r(7563);var je={itemsStore:te};function Re(e){var t=e.code,r=e.children;return n.createElement(p.AW,{render:function(e){var n=e.staticContext;return n&&(n.status=t),r}})}function Je(){return n.createElement(Re,{code:404},n.createElement(N.Z,{container:!0,className:"Contact mainContainer MuiGrid-spacing-xs-3",style:{marginTop:64}},n.createElement(N.Z,{item:!0,xs:12},n.createElement(D.Z,{variant:"h5",component:"h1"},"404 Страница не найдена"))))}var Be=function(e){(0,d.Z)(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,m.Z)(t);if(r){var a=(0,m.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,l.Z)(this,e)});function i(e){var t;return(0,o.Z)(this,i),t=a.call(this,e),(0,u.Z)((0,c.Z)(t),"componentDidMount",(function(){})),t.state={categoryItems:[],cartItems:[],activePage:"",is_load:!1,openCity:!1,cityName:"",testData:[1,2,3,4,5,6,7,8,9],cityList:[],openLogin:!1,userLogin:"",userLoginFormat:"",userCode:"",stage_1:!0,stage_2:!1,timerSMS:59,errPhone:"",errSMS:"",userName:"",soc_link:null},t}return(0,s.Z)(i,[{key:"render",value:function(){return n.createElement(Me.zt,je,n.createElement(Oe,null),n.createElement(p.rs,null,n.createElement(p.AW,{path:"/",exact:!0,component:Ne}),n.createElement(p.AW,{component:Je})))}}]),i}(n.Component);a.hydrate(n.createElement(i.VK,null,n.createElement(Be,null)),document.getElementById("app"))},8293:(e,t,r)=>{var n={"./ru":1793,"./ru.js":1793};function a(e){var t=i(e);return r(t)}function i(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=i,e.exports=a,a.id=8293}},r={};function n(e){var a=r[e];if(void 0!==a)return a.exports;var i=r[e]={id:e,loaded:!1,exports:{}};return t[e].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=t,e=[],n.O=(t,r,a,i)=>{if(!r){var o=1/0;for(d=0;d<e.length;d++){for(var[r,a,i]=e[d],s=!0,c=0;c<r.length;c++)(!1&i||o>=i)&&Object.keys(n.O).every((e=>n.O[e](r[c])))?r.splice(c--,1):(s=!1,i<o&&(o=i));s&&(e.splice(d--,1),t=a())}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[r,a,i]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={179:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var a,i,[o,s,c]=r,d=0;for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(c)var l=c(n);for(t&&t(r);d<o.length;d++)i=o[d],n.o(e,i)&&e[i]&&e[i][0](),e[o[d]]=0;return n.O(l)},r=self.webpackChunkreact_ssr=self.webpackChunkreact_ssr||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var a=n.O(void 0,[736],(()=>n(6283)));a=n.O(a)})();
//# sourceMappingURL=main.js.map