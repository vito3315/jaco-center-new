"use strict";(self.webpackChunkreact_ssr=self.webpackChunkreact_ssr||[]).push([[227],{7227:(e,t,r)=>{r.r(t),r.d(t,{default:()=>ve});var a=r(5861),n=r(5671),i=r(3144),o=r(7326),s=r(136),l=r(6215),c=r(1120),d=r(4942),m=r(7462),u=r(5987),h=r(4687),p=r.n(h),f=r(7294),v=r(381),g=r.n(v),Z=r(4593),y=r(4998),_=r(8811),E=r.n(_),T=r(8949),k=r(5350),S=r(4567),I=r(9062),b=r(5725),P=r(3720),w=r(4386),x=r(9986),D=r(5697),A=r.n(D),C=r(20),O=r(2640),N=r(2658),M=r(1508),W=r(6501),z=r(4563),H=r(5116),L=r(9573),B=r(8732),j=r(3887),R=r(6926),Y=r(6011),J=r(3694),F=r(7896),U=r(2642),q=r(8044),$=r(2440),G=r(799),V=r(9334),K=r(7645),Q=r(7750),X=r(8979),ee=r(6408),te=r(4666),re=r(3094),ae=r(594),ne=r(4895),ie=r(4721),oe=r(6540),se=r(2288),le=["children","value","index"];function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=(0,c.Z)(e);if(t){var n=(0,c.Z)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,l.Z)(this,r)}}var de=r(7563);function me(e){var t=e.children,r=e.value,a=e.index,n=(0,u.Z)(e,le);return f.createElement("div",(0,m.Z)({role:"tabpanel",hidden:r!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},n),r===a&&f.createElement(M.Z,{sx:{p:3}},t))}function ue(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}me.propTypes={children:A().node,index:A().number.isRequired,value:A().number.isRequired};var he=function(e){(0,s.Z)(r,e);var t=ce(r);function r(e){var a;return(0,n.Z)(this,r),a=t.call(this,e),(0,d.Z)((0,o.Z)(a),"_isMounted",!1),a.state={item:a.props.item,type:a.props.type},a}return(0,i.Z)(r,[{key:"shouldComponentUpdate",value:function(e,t){return!!t.item&&(parseInt(this.state.item.all_price)!==parseInt(t.item.all_price)||parseInt(this.state.item.count)!==parseInt(t.item.count))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,(0,T.EH)((function(){if(!0===e._isMounted&&e.state.item.item_id){var t=y.Z.getItems().find((function(t){return t.item_id==e.state.item.item_id}));e.setState({item:t})}}))}},{key:"delItem",value:function(e){y.Z.delItem(e)}},{key:"changeCount",value:function(e){var t=e.target.value,r=this.state.item.item_id;t.length>0&&y.Z.AddCountItem(r,t)}},{key:"add",value:function(){y.Z.AddItem(this.state.item.item_id)}},{key:"minus",value:function(){y.Z.MinusItem(this.state.item.item_id)}},{key:"render",value:function(){return f.createElement(J.Z,{hover:!0,style:0==this.state.item.count?{display:"none"}:{}},f.createElement(R.Z,{style:{fontSize:"1rem"}},this.state.item.name),f.createElement(R.Z,{style:{textAlign:"center",fontSize:"1rem"}},"promo"==this.state.type?f.createElement(N.Z,{component:"span",style:{padding:"11px 0",display:"block",fontSize:"1rem"}},this.state.item.count):f.createElement("div",{className:"root2"},f.createElement(ne.Z,{onClick:this.minus.bind(this),style:{cursor:"pointer"}}),f.createElement("form",{className:"root3",noValidate:!0,autoComplete:"off"},f.createElement(H.Z,{variant:"outlined",onChange:this.changeCount.bind(this),value:this.state.item.count})),f.createElement(oe.Z,{onClick:this.add.bind(this),style:{cursor:"pointer"}}))),f.createElement(R.Z,{style:{fontSize:"1rem"}},this.state.item.all_price),f.createElement(R.Z,{style:{fontSize:"1rem"}},this.state.item.new_one_price?parseInt(this.state.item.one_price)*parseInt(this.state.item.count)-parseInt(this.state.item.new_one_price)*parseInt(this.state.item.count):""),f.createElement(R.Z,{style:{fontSize:"1rem"}},"promo"!==this.state.type?f.createElement(ae.Z,{style:{cursor:"pointer",marginTop:5},onClick:this.delItem.bind(this,this.state.item.item_id)}):null))}}]),r}(f.Component),pe=function(e){(0,s.Z)(r,e);var t=ce(r);function r(e){var a;return(0,n.Z)(this,r),a=t.call(this,e),(0,d.Z)((0,o.Z)(a),"_isMounted",!1),a.state={main_items:[],dop_items:[],promo_items:[]},a}return(0,i.Z)(r,[{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,(0,T.EH)((function(){if(e._isMounted){var t=y.Z.getItems(),r=y.Z.getAllItems(),a=y.Z.getItemsPromo(),n=[];a.map((function(e){var t=r.find((function(t){return t.id==e.item_id}));t&&n.push({id:e.item_id,cat_id:t.cat_id,name:t.name,desc:t.tmp_desc,count:e.count,all_price:e.all_price,img:t.img_new,imgUpdate:t.img_new_update})}));var i=[],o=[];r.length>0&&(t.map((function(e){var t=r.find((function(t){return t.id==e.item_id}));t||alert("В корзине произошла ошибка"),t&&7==parseInt(t.cat_id)?o.push(e):i.push(e)})),e.setState({dop_items:o,main_items:i,promo_items:n}))}}))}},{key:"render",value:function(){return f.createElement(W.Z,{style:{width:"100%"}},f.createElement(F.Z,{style:{maxHeight:420,overflow:"auto"}},f.createElement(L.Z,{stickyHeader:!0,size:"small"},f.createElement(Y.Z,null,f.createElement(J.Z,null,f.createElement(R.Z,null,"Наимнование"),f.createElement(R.Z,{style:{textAlign:"center"}},"Кол-во"),f.createElement(R.Z,null,"Сумма"),f.createElement(R.Z,null,"Скидка"),f.createElement(R.Z,null))),f.createElement(B.Z,null,this.state.main_items.map((function(e,t){return f.createElement(he,{key:t,item:e,type:"main"})})),this.state.dop_items.map((function(e,t){return f.createElement(he,{key:t,item:e,type:"dop"})})),this.state.promo_items.map((function(e,t){return f.createElement(he,{key:t,item:e,type:"promo"})}))))))}}]),r}(f.Component),fe=function(e){(0,s.Z)(M,e);var t,r,l,c,u,h,v,_,D,A=ce(M);function M(e){var t,r;return(0,n.Z)(this,M),r=A.call(this,e),(0,d.Z)((0,o.Z)(r),"interval",null),(0,d.Z)((0,o.Z)(r),"clickOrderStart",!1),(0,d.Z)((0,o.Z)(r),"startOrderInterval",300),(0,d.Z)((0,o.Z)(r),"startOrderIntervalTimer",null),(0,d.Z)((0,o.Z)(r),"loadTimeCheck",null),(0,d.Z)((0,o.Z)(r),"componentDidMount",(function(){r._isMounted=!0,console.log("mount"),document.title="Оформление нового заказа",localStorage.getItem("cityID")?r.setState({cityId:localStorage.getItem("cityID")}):localStorage.setItem("cityID",1),r.interval=setInterval((function(){return r.checkLogin()}),36e5),r.checkLogin(),setTimeout((function(){r.start()}),100),(0,T.EH)((function(){if(r._isMounted){console.log("is mounted autorun");var e=y.Z.getAllPrice(),t=y.Z.getSumDiv();if(parseInt(e)==parseInt(r.state.allPrice)&&parseInt(t)==parseInt(r.state.sumDiv)||(r.setState({sumDiv:t,AllPrice:e}),setTimeout((function(){var e=y.Z.getCartData();e&&e.orderTimes&&1==parseInt(e.orderTimes)?r.loadTimePred():(console.log("load 1"),r.loadTimeWait())}),100)),y.Z.updateMyPromos!=r.state.updateMyPromos){console.log("autorun updateMyPromos");var a=y.Z.getMyPromos(),n=[],i=g()(new Date).add(-7,"days").format("YYYY-MM-DD");a=a.filter((function(e){return e.date>=i})),localStorage.setItem("MyPromos",JSON.stringify(a)),a.forEach((function(e){var t=n.find((function(t){return t.promo==e.promo}));console.log(n,t,e.promo),t?n.forEach((function(t,r){t.promo==e.promo&&n[r].count++})):(e.count=1,n.push(e))})),n=n.filter((function(e){return e.count>1}));var o=(s=function(e){return e.name},l={},n.forEach((function(e){l[s(e)]=e})),Object.keys(l).map((function(e){return l[e]})));console.log("MyPromos 1",o),r.setState({updateMyPromos:y.Z.updateMyPromos,MyPromos:o})}}var s,l}))})),(0,d.Z)((0,o.Z)(r),"getData",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!0===a&&r.setState({is_load:!0}),t.type=e,t.token=y.Z.getToken(),fetch(E().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:de.stringify(t)}).then((function(e){return e.json()})).then((function(e){if(!1!==e.st||"redir"!=e.type){if(!1!==e.st||"auth"!=e.type)return setTimeout((function(){r.setState({is_load:!1})}),300),e;window.location.pathname="/auth"}else window.location.pathname="/"})).catch((function(e){console.log(e),r.setState({is_load:!1})}))})),(0,d.Z)((0,o.Z)(r),"changeCat",(function(e,t){r.setState({activeCat:t})})),(0,d.Z)((0,o.Z)(r),"changeTab",(function(e,t){if(1==parseInt(t)&&y.Z.setSumDiv(0),0==parseInt(t)||2==parseInt(t)){var a=r.state.newAddrInfo;if(console.log(a),a){var n=y.Z.getAllPrice();1==parseInt(a.free_drive)||1==parseInt(y.Z.free_drive)?parseInt(n)>0?y.Z.setSumDiv(0):y.Z.setSumDiv(1):y.Z.setSumDiv(parseInt(a.sum_div))}}r.setState({activeTab:t}),r.saveData(),setTimeout((function(){0==parseInt(r.state.typeTime)?(console.log("load 4"),r.loadTimeWait()):r.loadTimePred(),r.state.promo_name.length>0&&r.checkPromo({target:{value:r.state.promo_name}})}),300)})),(0,d.Z)((0,o.Z)(r),"changeTypeTime",(function(e,t){r.changeDataTime("typeTime",{target:{value:t}}),0==parseInt(t)?(console.log("load 9"),r.loadTimeWait()):r.loadTimePred()})),r.state=(t={is_load:!1,check_home_true:!0,cityId:1,sumDiv:0,AllPrice:0,cats:[],cityList:[],allItems:[],pic_point:[],all_addr:[],date_pred:[],timePred:[],clientAddr:[],newAddrStreet:null,newAddrHome:"",newAddrInfo:null,newAddrDom:!0,pd:"",et:"",kv:"",comment:"",sdacha:"",point_id:0,orderPic:0,picPointInfo:null,thisItem:null,activeCat:0,main_items:[],dop_items:[],promo_items:[],activeTab:0,list_addr_choose:!1,list_addr_for_choose:[],promoName:"",promoList:[],openErr:!1,vertical:"top",horizontal:"right",msgText:"",number:"",chooseAddr:null,orderPromoText:"",promoST:!1,promo_name:""},(0,d.Z)(t,"thisItem",null),(0,d.Z)(t,"checkClear",!1),(0,d.Z)(t,"textAvgTime","Среднее время: ~"),(0,d.Z)(t,"date",""),(0,d.Z)(t,"time",""),(0,d.Z)(t,"typeTime",0),(0,d.Z)(t,"errorOpen",!1),(0,d.Z)(t,"error",{title:"",text:""}),(0,d.Z)(t,"updateMyPromos",null),(0,d.Z)(t,"MyPromos",[]),t),r}return(0,i.Z)(M,[{key:"componentWillUnmount",value:function(){console.log("umount"),this._isMounted=!1,clearInterval(this.interval)}},{key:"checkLogin",value:(D=(0,a.Z)(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={token:y.Z.getToken()},e.next=3,this.getData("check_login_center",t);case 3:!0===e.sent||(localStorage.removeItem("token"),clearInterval(this.interval),setTimeout((function(){window.location.href="/auth"}),500));case 5:case"end":return e.stop()}}),e,this)}))),function(){return D.apply(this,arguments)})},{key:"start",value:(_=(0,a.Z)(p().mark((function e(){var t,r,a=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={city_id:this.state.cityId},e.next=3,this.getData("get_cat_center_new",t);case 3:return r=e.sent,this.setState({cats:r.arr,cityList:r.city_list,allItems:r.all_items}),y.Z.setAllItemsCat(r.arr),y.Z.setAllItems(r.all_items),y.Z.setFreeItems(r.free_items),t={city_id:this.state.cityId,user_id:y.Z.getToken()},e.next=11,this.getData("get_by_mi_new",t);case 11:r=e.sent,this.setState({pic_point:r.get_addr_pic.points,all_addr:r.get_addr,date_pred:r.date_pred}),setTimeout((function(){a.loadSavedData()}),300);case 14:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:"loadSavedData",value:function(){var e=this,t=y.Z.getCartData();if(t&&t.orderType&&1==parseInt(t.orderType)){var r=this.state.pic_point.find((function(e){return e.id==parseInt(t.orderPic)}));r&&this.choosePic(r,!1)}if(t&&0==parseInt(t.orderType)){this.setState({newAddrInfo:t.orderAddr?t.orderAddr:null,point_id:t.orderAddr?t.orderAddr.point_id:0,newAddrStreet:t.orderAddr&&t.orderAddr.street,newAddrHome:t.orderAddr&&t.orderAddr.home?t.orderAddr.home:"",pd:t.orderAddr&&t.orderAddr.pd?t.orderAddr.pd:"",et:t.orderAddr&&t.orderAddr.et?t.orderAddr.et:"",kv:t.orderAddr&&t.orderAddr.kv?t.orderAddr.kv:"",newAddrDom:!t.orderAddr||0!=parseInt(t.orderAddr.dom_true),activeTab:0});var a=y.Z.getAllPrice();1==parseInt(t.orderAddr?t.orderAddr.free_drive:0)||1==parseInt(y.Z.free_drive)?parseInt(a)>0?y.Z.setSumDiv(0):y.Z.setSumDiv(1):y.Z.setSumDiv(parseInt(t.orderAddr?t.orderAddr.sum_div:0))}if(t&&t.orderComment!=this.state.comment&&this.setState({comment:t.orderComment}),t&&t.orderSdacha&&parseInt(t.orderSdacha)!=parseInt(this.state.sdacha)&&this.setState({sdacha:t.orderSdacha}),localStorage.getItem("clientNumber")){var n=localStorage.getItem("clientNumber");y.Z.clientNumber=n,this.setState({number:n}),setTimeout((function(){e.getAddr()}),300)}if(localStorage.getItem("promo_name")){var i=localStorage.getItem("promo_name");setTimeout((function(){e.setState({promo_name:i}),e.checkPromo({target:{value:i}})}),500)}parseInt(this.state.typeTime)!=parseInt(t.orderTimes)&&(this.setState({typeTime:t.orderTimes}),this.setState({time:t.orderPredTime,date:t.orderPredDay,typeTime:t.orderTimes}),0==t.orderType&&(1==parseInt(t.orderTimes)?this.loadTimePred():(console.log("load 2"),this.loadTimeWait())),1==parseInt(t.orderTimes)?this.loadTimePred():(console.log("load 3"),this.loadTimeWait()))}},{key:"addToCart",value:function(e){y.Z.AddItem(e)}},{key:"addItemCustom",value:function(e,t){var r=this,a=this.state.allItems.find((function(e){return e.name==t}));this.addToCart(a.id),this.setState({thisItem:t}),setTimeout((function(){r.setState({thisItem:null})}),100)}},{key:"choosePic",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setState({orderPic:e.id,picPointInfo:e,activeTab:1,point_id:e.id,sumDiv:0}),!0===r&&this.saveData(),setTimeout((function(){t.state.promo_name.length>0&&t.checkPromo({target:{value:t.state.promo_name}}),0==parseInt(t.state.typeTime)?(console.log("load 5"),t.loadTimeWait()):t.loadTimePred(),y.Z.setSumDiv(0)}),300)}},{key:"checkNewAddr",value:(v=(0,a.Z)(p().mark((function e(t){var r,a,n,i,o=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(setTimeout((function(){o.clickOrderStart=!0}),10),this.setState({check_home_true:!0}),!((r=document.querySelector("#newAddrStreet").value).length>0&&this.state.newAddrHome.length>0)){e.next=18;break}return a={city_id:this.state.cityId,street:r,home:this.state.newAddrHome},e.next=7,this.getData("check_addr",a,!1);case 7:if(n=e.sent,console.log("checkNewAddr",n),0!=parseInt(n.count)){e.next=14;break}return!0===t&&this.setState({openErr:!0,msgText:"Адрес не найден, или не входит в зону доставки"}),this.setState({newAddrInfo:null,point_id:0,check_home_true:!1}),setTimeout((function(){o.saveDataOther(),o.clickOrderStart=!1}),100),e.abrupt("return");case 14:parseInt(n.count)>1&&(this.setState({list_addr_for_choose:n.addrs,list_addr_choose:!0,openErr:!1}),setTimeout((function(){o.clickOrderStart=!1}),100)),1==parseInt(n.count)&&(n.addrs=n.addrs[0],this.setState({newAddrInfo:n.addrs,point_id:n.addrs.point_id,openErr:!1}),i=y.Z.getAllPrice(),1==parseInt(n.addrs.free_drive)||1==parseInt(y.Z.free_drive)?parseInt(i)>0?y.Z.setSumDiv(0):y.Z.setSumDiv(1):y.Z.setSumDiv(parseInt(n.addrs.sum_div)),this.saveDataOther(),setTimeout((function(){0==parseInt(o.state.typeTime)?(console.log("load 6"),o.loadTimeWait()):o.loadTimePred(),o.clickOrderStart=!1}),300),this.state.promo_name.length>0&&this.checkPromo({target:{value:this.state.promo_name}})),e.next=20;break;case 18:this.setState({newAddrInfo:null,point_id:0}),setTimeout((function(){o.saveDataOther(),o.clickOrderStart=!1}),300);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"chooseAddr",value:function(e){var t=this;this.setState({newAddrInfo:e,point_id:e.point_id,list_addr_for_choose:[],list_addr_choose:!1});var r=y.Z.getAllPrice();1==parseInt(e.free_drive)||1==parseInt(y.Z.free_drive)?parseInt(r)>0?y.Z.setSumDiv(0):y.Z.setSumDiv(1):y.Z.setSumDiv(parseInt(e.sum_div)),setTimeout((function(){t.saveDataOther(),0==parseInt(t.state.typeTime)?(console.log("load 7"),t.loadTimeWait()):t.loadTimePred(),t.state.promo_name.length>0&&t.checkPromo({target:{value:t.state.promo_name}})}),300)}},{key:"cheangeAddrCustom",value:function(e,t){console.log(t),this.setState({newAddrStreet:t})}},{key:"chooseAddrFull",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.setState({newAddrStreet:e.street,newAddrHome:e.home,pd:e.pd,et:e.et,kv:e.kv,newAddrDom:0!=parseInt(e.fake_dom)}),this.setState({newAddrInfo:e,point_id:e.point_id,chooseAddr:r,list_addr_for_choose:[],list_addr_choose:!1});var a=y.Z.getAllPrice();1==parseInt(e.free_drive)||1==parseInt(y.Z.free_drive)?parseInt(a)>0?y.Z.setSumDiv(0):y.Z.setSumDiv(1):y.Z.setSumDiv(parseInt(e.sum_div)),setTimeout((function(){t.saveDataOther(),0==parseInt(t.state.typeTime)?(console.log("load 8"),t.loadTimeWait()):t.loadTimePred(),t.state.promo_name.length>0&&t.checkPromo({target:{value:t.state.promo_name}})}),300)}},{key:"changeDataOther",value:function(e,t){var r=t.target.value;isNaN(r)||(this.setState((0,d.Z)({},e,r)),this.saveDataOther())}},{key:"changeDomTrue",value:function(e){this.setState({newAddrDom:e}),this.changeDataOther("dom_true",{target:{value:e?1:0}})}},{key:"changeData",value:function(e,t){var r=this,a=t.target.value;"sdacha"==e&&isNaN(a)||"comment"==e&&a.length>100||(this.setState((0,d.Z)({},e,a)),this.saveData(),"sdacha"!=e&&"comment"!=e&&"time"!=e&&setTimeout((function(){r.loadTimePred()}),300))}},{key:"saveData",value:function(){var e=this,t=y.Z.getCartData();setTimeout((function(){var r={orderType:0==parseInt(e.state.activeTab)||1==parseInt(e.state.activeTab)?parseInt(e.state.activeTab):0,orderAddr:t&&t.orderAddr?t.orderAddr:"",orderPic:e.state.orderPic,orderComment:e.state.comment,orderTimes:e.state.typeTime,orderPredDay:e.state.date,orderPredTime:e.state.time,orderPay:t&&t.orderPay?t.orderPay:"0",orderSdacha:e.state.sdacha};y.Z.saveCartData(r)}),100)}},{key:"saveDataOther",value:function(){var e=this,t=y.Z.getCartData(),r=this.state.newAddrInfo?this.state.newAddrInfo:t.orderAddr;setTimeout((function(){var a={orderType:0==parseInt(e.state.activeTab)||1==parseInt(e.state.activeTab)?parseInt(e.state.activeTab):0,orderAddr:{id:-1,street:e.state.newAddrInfo&&r.street?r.street:"",home:r.home?r.home:"",kv:e.state.kv,pd:e.state.pd,et:e.state.et,dom_true:e.state.newAddrDom?1:0,free_drive:r.free_drive?r.free_drive:0,sum_div:r.sum_div?r.sum_div:0,point_id:r.point_id?r.point_id:0,xy:r.xy?r.xy:"",pay_active:r.pay_active?r.pay_active:0},orderPic:e.state.orderPic,orderComment:e.state.comment,orderTimes:e.state.typeTime,orderPredDay:e.state.date,orderPredTime:e.state.time,orderPay:t&&t.orderPay?t.orderPay:"0",orderSdacha:e.state.sdacha};y.Z.saveCartData(a)}),100)}},{key:"changeCity",value:function(e){var t=this;this.setState({cityId:e.target.value}),localStorage.setItem("cityID",e.target.value),setTimeout((function(){t.start()}),300)}},{key:"saveNumber",value:function(e){var t=this,r=e.target.value,a="";(r+="").length>0&&("7"!=(r=(r=(r=(r=(r=r.split(" ").join("")).split("(").join("")).split(")").join("")).split("-").join("")).split("+").join(""))[0]&&7!=r[0]||((a=r.split(""))[0]=8,r=a.join("")),11!=r.length)?this.setState({openErr:!0,msgText:"Номер введен в не верном формате"}):(this.setState({number:r}),y.Z.clientNumber=r,localStorage.setItem("clientNumber",r),0==r.length?this.setState({clientAddr:[]}):setTimeout((function(){t.getAddr()}),300))}},{key:"changeNumber",value:function(e){var t=e.target.value;isNaN(t)||this.setState({number:t})}},{key:"closeErr",value:function(){var e=this;setTimeout((function(){e.setState({openErr:!1})}),5e3)}},{key:"getAddr",value:(h=(0,a.Z)(p().mark((function e(){var t,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={city_id:this.state.cityId,login:this.state.number},e.next=3,this.getData("get_user_addrs",t,!1);case 3:r=e.sent,this.setState({clientAddr:r});case 5:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"checkPromo",value:(u=(0,a.Z)(p().mark((function e(t){var r,a,n,i,o,s,l,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.target.value,a={city_id:this.state.cityId,promo_name:r},e.next=4,this.getData("get_promo",a,!1);case 4:n=e.sent,console.log(n),y.Z.setPromo(JSON.stringify(n),r),!1===(i=y.Z.checkPromo()).st&&localStorage.removeItem("promo_name"),0==r.length?(this.setState({orderPromoText:"",promo_name:"",promoST:!1}),localStorage.removeItem("promo_name")):(this.setState({orderPromoText:i.text,promoST:i.st,promo_name:r}),r&&r.length>0&&(o=function(e,t){var r={};return e.forEach((function(e){r[t(e)]=e})),Object.keys(r).map((function(e){return r[e]}))},(s=y.Z.getMyPromos()).find((function(e){return e.promo.toLowerCase()==r.toLowerCase()}))?(console.log("promo change"),l=s.findIndex((function(e){return e.promo.toLowerCase()==r.toLowerCase()})),s[l].count++):(console.log("promo add"),s.push({date:g()(new Date).format("YYYY-MM-DD"),promo:r.toLowerCase(),name:r.toLowerCase(),count:1})),c=o(s,(function(e){return e.name})),y.Z.setMyPromos(c),console.log("MyPromos 2",c),this.setState({MyPromos:c})));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"clear",value:function(){var e=this;console.log("clear"),y.Z.clientNumber="",localStorage.removeItem("clientNumber"),localStorage.removeItem("promo_name"),y.Z.setItems([]),y.Z.setItemsPromo([]);var t={orderType:"0",orderAddr:"",orderPic:0,orderComment:"",orderTimes:0,orderPredDay:"",orderPredTime:"",orderPay:"",orderSdacha:"",dateTime:new Date,date:"",time:"",typeTime:0};y.Z.dateTimeDel=new Date,y.Z.saveCartData(t),setTimeout((function(){y.Z.setPromo(null,"")}),300),this.setState({number:"",promo_name:"",orderPromoText:""}),this.setState((0,d.Z)({newAddrStreet:"",newAddrHome:"",pd:"",et:"",kv:"",newAddrDom:!0,newAddrInfo:"",chooseAddr:-1,orderPic:0,picPointInfo:null,point_id:0,comment:"",sdacha:"",number:"",clientNumber:"",checkClear:!1,clientAddr:[],typeTime:0,date:"",time:""},"typeTime",0)),y.Z.setSumDiv(0),y.Z.setAllPrice(0),setTimeout((function(){e.changeTypeTime(null,0)}),300)}},{key:"loadTimePred",value:(c=(0,a.Z)(p().mark((function e(){var t,r,a,n,i,o,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],n=y.Z.getItems(),i=y.Z.getCartData(),n.forEach((function(e){a.push({item_id:e.item_id,count:e.count})})),o={point_id:i.orderType+1==1?null!==(t=i.orderAddr.point_id)&&void 0!==t?t:0:null!==(r=i.orderPic)&&void 0!==r?r:0,type_order:i.orderType+1,date:this.state.date,cart:JSON.stringify(a)},e.next=7,this.getData("get_times_pred_center",o,!1);case 7:(s=e.sent).st&&this.setState({timePred:s.data});case 9:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"loadTimeWait",value:(l=(0,a.Z)(p().mark((function e(){var t,r,a,n,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return JSON.stringify(y.Z.getItems()),a=y.Z.getCartData(),n={point_id:a.orderType+1==1?null!==(t=a.orderAddr.point_id)&&void 0!==t?t:0:null!==(r=a.orderPic)&&void 0!==r?r:0,type_order:a.orderType,city_id:this.state.cityId,cart:JSON.stringify(y.Z.getItems()),cartPromo:JSON.stringify(y.Z.getItemsPromo())},e.next=5,this.getData("load_time_wait_test",n,!1);case 5:i=e.sent,this.setState({textAvgTime:i.text});case 7:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"changeDataTime",value:function(e,t){var r=this,a=t.target.value;this.setState((0,d.Z)({},e,a)),"date"==e&&setTimeout((function(){r.loadTimePred()}),300),this.saveData()}},{key:"startOrderNext",value:(r=(0,a.Z)(p().mark((function e(){var t,r,a,n,i,o,s,l,c,d,m,u,h=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.clickOrderStart&&1!=this.state.is_load){e.next=45;break}if(this.clickOrderStart=!0,clearTimeout(this.startOrderIntervalTimer),t=y.Z.getCartData(),this.setState({is_load:!0}),r=[],a=y.Z.getItems(),n=0,a.forEach((function(e){e.count>0&&(r.push({name:e.name,count:e.count,price:e.all_price,id:e.item_id}),n+=e.all_price)})),0==parseInt(this.state.AllPrice)&&(0==y.Z.getAllPrice()?this.setState({AllPrice:n}):this.setState({AllPrice:y.Z.getAllPrice()})),0===parseInt(t.orderTimes)){e.next=16;break}if(0!=t.orderPredDay.length||0!=t.orderPredTime.length){e.next=16;break}return this.setState({error:{title:"Предупреждение",text:"Не выбрано дата / время предзаказа"},errorOpen:!0,spiner:!1}),this.clickOrderStart=!1,this.setState({is_load:!1}),e.abrupt("return");case 16:if(0!=parseInt(t.orderType)){e.next=38;break}if(!1!==this.state.check_home_true){e.next=22;break}return this.setState({error:{title:"Предупреждение",text:"Адрес не найден, или не входит в зону доставки"},errorOpen:!0,spiner:!1}),this.clickOrderStart=!1,this.setState({is_load:!1}),e.abrupt("return");case 22:if(console.log(t.orderAddr),0!=t.orderAddr.et.length){e.next=28;break}return this.setState({error:{title:"Предупреждение",text:"Не указан этаж"},errorOpen:!0,spiner:!1}),this.clickOrderStart=!1,this.setState({is_load:!1}),e.abrupt("return");case 28:if(0!=t.orderAddr.pd.length){e.next=33;break}return this.setState({error:{title:"Предупреждение",text:"Не указан подъезд"},errorOpen:!0,spiner:!1}),this.clickOrderStart=!1,this.setState({is_load:!1}),e.abrupt("return");case 33:if(0!=t.orderAddr.kv.length){e.next=38;break}return this.setState({error:{title:"Предупреждение",text:"Не указана квартира"},errorOpen:!0,spiner:!1}),this.clickOrderStart=!1,this.setState({is_load:!1}),e.abrupt("return");case 38:return i=this.state.promo_name,o={typeCreate:"center",city_id:this.state.cityId,user_id:y.Z.getToken(),timePred:JSON.stringify({value:0==parseInt(t.orderTimes)?0:t.orderPredDay+" "+t.orderPredTime}),typeOrder:t.orderType,addrPic:t.orderPic,comment:t.orderComment,sdacha:t.orderSdacha,addrDev:t.orderAddr?JSON.stringify(t.orderAddr):"",payFull:JSON.stringify({type:"cash"}),cart:JSON.stringify(r),promo_name:i,number:y.Z.clientNumber},e.next=42,this.getData("createOrder",o);case 42:s=e.sent,setTimeout((function(){h.clickOrderStart=!1}),500),s.st?(localStorage.getItem("promo_name")&&localStorage.getItem("promo_name").length>0&&(l=function(e,t){var r={};return e.forEach((function(e){r[t(e)]=e})),Object.keys(r).map((function(e){return r[e]}))},c=localStorage.getItem("promo_name"),(d=y.Z.getMyPromos()).push({date:g()(new Date).format("YYYY-MM-DD"),promo:c,name:c,count:1}),m=l(d,(function(e){return e.name})),y.Z.setMyPromos(m),console.log("MyPromos 3",m),this.setState({MyPromos:m})),u=[],s.my_cart.map((function(e){3!=parseInt(e.type)&&4!=parseInt(e.type)&&u.push(e)})),s.my_cart.map((function(e){3!=parseInt(e.type)&&4!=parseInt(e.type)||u.push(e)})),this.setState({newOrder:{cart:u,order_id:s.order_id,point_id:s.point_id,point_name:s.point_name,time_wait:s.time_wait_order,typeOrder:0==parseInt(t.orderType)?"Доставка":"Самовывоз",number:y.Z.clientNumber,comment:0==parseInt(t.orderType)?t.orderComment:"",sdacha:0==parseInt(t.orderType)?t.orderSdacha:"",timePred:0==parseInt(t.orderTimes)?"":t.orderPredDay+" "+t.orderPredTime,addr:0==parseInt(t.orderType)?t.orderAddr:{},promoName:localStorage.getItem("promo_name"),dop_text:s.dop_text}}),setTimeout((function(){h.setState({orderCheck:!0})}),500),this.startOrderIntervalTimer=setTimeout((function(){h.setState({orderCheck:!1,newOrderData:null})}),1e3*this.startOrderInterval)):(s.type&&"new_pred"==s.type&&this.setState({timePred:s.times}),this.setState({error:{title:"Предупреждение",text:s.text_err},errorOpen:!0}));case 45:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"trueOrder",value:(t=(0,a.Z)(p().mark((function e(){var t,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={city_id:this.state.cityId,order_id:this.state.newOrder.order_id,point_id:this.state.newOrder.point_id},e.next=3,this.getData("trueOrder",t);case 3:0==(r=e.sent).st?this.setState({error:{title:"При подтверждении оплаты произошла ошибка",text:r.text_err},errorOpen:!0}):(this.setState({error:{title:"Подтверждение заказа",text:"Заказ успешно оформлен"},errorOpen:!0,orderCheck:!1,newOrderData:null}),this.clear(),clearTimeout(this.startOrderIntervalTimer));case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this;return f.createElement(b.ZP,{container:!0,spacing:3},f.createElement(Z.q,null,f.createElement("title",null,"Оформление заказа")),f.createElement(x.Z,{anchorOrigin:{vertical:this.state.vertical,horizontal:this.state.horizontal},autoHideDuration:5e3,open:this.state.openErr,onClose:this.closeErr.bind(this),key:"topcenter"},f.createElement(se.Z,{severity:"error",variant:"filled"},this.state.msgText)),f.createElement(P.Z,{style:{backgroundColor:"transparent",position:"absolute",overflow:"hidden",width:"calc(100% - 50px)",left:50,zIndex:5},elevation:0},f.createElement(w.Z,null,f.createElement(b.ZP,{container:!0,spacing:3},f.createElement(b.ZP,{item:!0,xs:2},f.createElement(k.$S,{is_none:!1,data:this.state.cityList,value:this.state.cityId,func:this.changeCity.bind(this),label:"Город"})),f.createElement(b.ZP,{item:!0,xs:2},f.createElement(k.e_,{id:"promoName",onBlur:this.checkPromo.bind(this),freeSolo:!0,type:"MyPromos",data:this.state.MyPromos,value:this.state.promo_name,func:function(t,r){e.setState({promo_name:r})},multiple:!1,label:"Промокод"})),f.createElement(b.ZP,{item:!0,xs:1},f.createElement(q.Z,{disableElevation:!0,variant:"contained"},0==this.state.orderPromoText.length?f.createElement(U.Z,{style:{height:40,backgroundColor:"#bababa"}}," ",f.createElement(re.Z,null)," "):f.createElement(z.Z,{placement:"bottom",title:f.createElement(f.Fragment,null,f.createElement(N.Z,{color:"inherit"},this.state.orderPromoText))},f.createElement(U.Z,{variant:"contained",color:"primary",style:{height:40,backgroundColor:!1===this.state.promoST&&0==this.state.orderPromoText.length?"#bababa":!1===this.state.promoST&&this.state.orderPromoText.length>0?"red":"green"}}," ",f.createElement(re.Z,null)," ")),f.createElement(U.Z,{style:{height:40},onClick:function(){e.setState({checkClear:!0})}}," ",f.createElement(ae.Z,null)," "))),f.createElement(b.ZP,{item:!0,xs:2},f.createElement(k.rZ,{onBlur:this.saveNumber.bind(this),value:this.state.number,func:this.changeNumber.bind(this),placeholder:"8 (999) 999-99-99",label:"Телефон"})),f.createElement(b.ZP,{item:!0,xs:1}),f.createElement(b.ZP,{item:!0,xs:4},f.createElement(P.Z,{position:"static",style:{backgroundColor:"#fff",borderRadius:12,overflow:"hidden"}},f.createElement(C.Z,{value:this.state.activeTab,onChange:this.changeTab.bind(this),indicatorColor:"secondary",variant:"fullWidth",style:{height:40,minHeight:40}},f.createElement(O.Z,(0,m.Z)({label:"Доставка",style:{minWidth:"auto",height:40,minHeight:40}},ue(0))),f.createElement(O.Z,(0,m.Z)({label:"Самовывоз",style:{minWidth:"auto",height:40,minHeight:40}},ue(1))),f.createElement(O.Z,(0,m.Z)({label:"Адрес клиента",style:{minWidth:"auto",height:40,minHeight:40}},ue(2))))))))),f.createElement(S.Z,{open:this.state.is_load,style:{zIndex:999,color:"#fff"}},f.createElement(I.Z,{color:"inherit"})),f.createElement(te.Z,{onClose:function(){e.setState({list_addr_choose:!1})},open:this.state.list_addr_choose},f.createElement(K.Z,{style:{textAlign:"center"}},"Выбор адреса"),f.createElement($.Z,{sx:{pt:0}},this.state.list_addr_for_choose.map((function(t,r){return f.createElement(G.ZP,{button:!0,key:r,onClick:e.chooseAddr.bind(e,t)},f.createElement(V.Z,{primary:t.city_name+", "+(t.city_name_dop.length>0?t.city_name_dop+", ":"")+t.street+", "+t.home}))})))),f.createElement(te.Z,{onClose:function(){},open:this.state.checkClear},f.createElement(K.Z,null,"Точно очистить ?"),f.createElement($.Z,{sx:{pt:0,pb:0}},f.createElement(G.ZP,{button:!0,onClick:function(){e.setState({checkClear:!1})},className:"checkClearFalse"},f.createElement(V.Z,{primary:"Отмена"})),f.createElement(G.ZP,{button:!0,onClick:this.clear.bind(this),className:"checkClearTrue"},f.createElement(V.Z,{primary:"Очистить"})))),!0===this.state.orderCheck?f.createElement(te.Z,{open:this.state.orderCheck,fullWidth:!0,onClose:function(){return e.setState({orderCheck:!1})},className:"DialogOrderCheckDialog"},f.createElement(K.Z,{className:"DialogOrderCheckDialogTitle"},f.createElement(N.Z,{variant:"h5",component:"span",className:"orderCheckTitle"}," ",this.state.newOrder.typeOrder," #",this.state.newOrder.order_id," на ",this.state.newOrder.point_name)),f.createElement(ae.Z,{className:"closeDialog",onClick:function(){return e.setState({orderCheck:!1})}}),f.createElement(Q.Z,{className:"DialogOrderCheckDialogBody"},""!==this.state.newOrder.timePred?f.createElement(N.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Время предзаказа: ",this.state.newOrder.timePred):f.createElement(N.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Время ожидания: ",this.state.newOrder.time_wait),"Доставка"==this.state.newOrder.typeOrder?f.createElement(N.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Доставка: ",this.state.newOrder.addr?this.state.newOrder.addr.street+" "+this.state.newOrder.addr.home+(0==this.state.newOrder.addr.pd.length?"":", Пд. "+this.state.newOrder.addr.pd)+(0==this.state.newOrder.addr.et.length?"":", Эт. "+this.state.newOrder.addr.et)+(0==this.state.newOrder.addr.kv.length?"":", Кв. "+this.state.newOrder.addr.kv):null):f.createElement(N.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Самовывоз: ",this.state.newOrder.point_name),"Доставка"==this.state.newOrder.typeOrder?this.state.newOrder.addr&&0==parseInt(this.state.newOrder.addr.dom_true)?f.createElement(N.Z,{variant:"h5",component:"span",className:"orderCheckText",style:{color:"red",fontWeight:900}},"Домофон не работает"):f.createElement(N.Z,{variant:"h5",component:"span",className:"orderCheckText",style:{color:"green",fontWeight:900}},"Домофон работает"):null,f.createElement(N.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Номер телефона: ",this.state.newOrder.number),this.state.newOrder.promoName?f.createElement(N.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Промокод: ",this.state.newOrder.promoName):null,"Доставка"==this.state.newOrder.typeOrder&&this.state.newOrder.comment&&this.state.newOrder.comment.length>0?f.createElement(N.Z,{variant:"h5",component:"span",className:"nameSdacha orderCheckText"},"Комментарий: ",this.state.newOrder.comment):null,"Доставка"==this.state.newOrder.typeOrder&&this.state.newOrder.sdacha&&this.state.newOrder.sdacha.length>0?f.createElement(N.Z,{variant:"h5",component:"span",className:"nameSdacha orderCheckText"},"Сдача с: ",this.state.newOrder.sdacha,"р"):null,"Доставка"==this.state.newOrder.typeOrder?null:this.state.newOrder.dop_text&&this.state.newOrder.dop_text.length>0?f.createElement(N.Z,{variant:"h5",component:"span",style:{fontWeight:"bold"},className:"nameSdacha orderCheckText"},this.state.newOrder.dop_text):null,f.createElement(L.Z,{size:"small"},f.createElement(B.Z,null,this.state.newOrder.cart.map((function(e,t){return parseInt(e.count)>0?f.createElement(J.Z,{key:t},f.createElement(R.Z,{style:{width:"60%",paddingLeft:0,fontSize:"1rem"}},e.name),f.createElement(R.Z,{style:{fontSize:"1rem"}},e.count),f.createElement(R.Z,{style:{fontSize:"1rem"}},e.new_full_price||0==e.new_full_price?e.new_full_price:e.full_price," р")):null})),"Доставка"==this.state.newOrder.typeOrder?f.createElement(J.Z,null,f.createElement(R.Z,{style:{width:"60%",paddingLeft:0,fontSize:"1rem"}},"Доставка"),f.createElement(R.Z,{style:{fontSize:"1rem"}},"1"),f.createElement(R.Z,{style:{fontSize:"1rem"}},this.state.sumDiv," р")):null),f.createElement(j.Z,null,f.createElement(J.Z,{style:{borderBottom:0}},f.createElement(R.Z,{style:{paddingLeft:0,fontSize:"1rem",fontWeight:"bolder",color:"#000"}},"Сумма заказа"),f.createElement(R.Z,null),f.createElement(R.Z,{style:{fontSize:"1rem",fontWeight:"bolder",color:"#000"}},parseInt(this.state.AllPrice)+parseInt(this.state.sumDiv)," р"))))),f.createElement(X.Z,{style:{padding:"12px 24px",paddingBottom:24}},f.createElement(q.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorder",style:{width:"100%"},onClick:this.trueOrder.bind(this)},f.createElement(U.Z,{variant:"contained",style:{width:"100%"},className:"BtnCardMain CardInCardItem"},"Подтвердить заказ")))):null,f.createElement(te.Z,{open:this.state.errorOpen,onClose:function(){return e.setState({errorOpen:!1})},fullWidth:!0,className:"DialogOrderCheckDialog"},f.createElement(K.Z,{className:"DialogOrderCheckDialogTitle"},this.state.error.title),f.createElement(ae.Z,{className:"closeDialog",color:"inherit",onClick:function(){return e.setState({errorOpen:!1})}}),f.createElement(Q.Z,null,f.createElement(ee.Z,null,this.state.error.text)),f.createElement(X.Z,null,f.createElement(U.Z,{onClick:function(){return e.setState({errorOpen:!1})}},"Хорошо"))),f.createElement(b.ZP,{item:!0,xs:8,style:{paddingTop:5}},f.createElement(pe,null)),f.createElement(b.ZP,{item:!0,xs:4,style:{paddingTop:5}},0==this.state.activeTab&&this.state.all_addr.length>0?f.createElement(b.ZP,{container:!0,spacing:2},f.createElement(b.ZP,{item:!0,xs:8},f.createElement(k.e_,{id:"newAddrStreet",onBlur:this.checkNewAddr.bind(this,!0),freeSolo:!0,data:this.state.all_addr,value:this.state.newAddrStreet,func:this.cheangeAddrCustom.bind(this),multiple:!1,label:"Улица"})),f.createElement(b.ZP,{item:!0,xs:4},f.createElement(k.rZ,{onBlur:this.checkNewAddr.bind(this,!0),value:this.state.newAddrHome,func:function(t){e.setState({newAddrHome:t.target.value}),setTimeout((function(){e.checkNewAddr(!1)}),10)},label:"Дом"})),f.createElement(b.ZP,{item:!0,xs:4},f.createElement(k.rZ,{value:this.state.pd,func:this.changeDataOther.bind(this,"pd"),label:"Подъезд"})),f.createElement(b.ZP,{item:!0,xs:4},f.createElement(k.rZ,{value:this.state.et,func:this.changeDataOther.bind(this,"et"),label:"Этаж"})),f.createElement(b.ZP,{item:!0,xs:4},f.createElement(k.rZ,{value:this.state.kv,func:this.changeDataOther.bind(this,"kv"),label:"Квартира"})),f.createElement(b.ZP,{item:!0,xs:12},f.createElement(q.Z,{disableElevation:!0,variant:"contained",className:"chooseDomTrue"},f.createElement(U.Z,{className:!0===this.state.newAddrDom?"active":"",onClick:this.changeDomTrue.bind(this,!0)},"Домофон работает"),f.createElement(U.Z,{className:!1===this.state.newAddrDom?"active":"",onClick:this.changeDomTrue.bind(this,!1)},"Домофон не работает")))):null,1==this.state.activeTab&&this.state.pic_point.length>0?f.createElement(b.ZP,{container:!0,direction:"column",spacing:0},this.state.pic_point.map((function(t,r){return f.createElement(b.ZP,{item:!0,xs:12,key:r},f.createElement(U.Z,{onClick:e.choosePic.bind(e,t,!0),style:{backgroundColor:e.state.orderPic==t.id?"#6ab04c":"#e5e5e5",color:e.state.orderPic==t.id?"#fff":"#000"},className:"boxPic"},t.addr))}))):null,2==this.state.activeTab&&this.state.clientAddr.length>0?f.createElement($.Z,{component:"nav","aria-label":"main mailbox folders",style:{maxHeight:150,overflow:"auto"}},this.state.clientAddr.map((function(t,r){return f.createElement(G.ZP,{button:!0,key:r,selected:e.state.chooseAddr===r,onClick:e.chooseAddrFull.bind(e,t,r),style:{paddingTop:0,paddingBottom:0}},f.createElement(V.Z,{primary:t.street+" "+t.home+(0==t.pd.length?"":", Пд. "+t.pd)+(0==t.et.length?"":", Эт. "+t.et)+(0==t.kv.length?"":", Кв. "+t.kv)}))}))):null,(0==this.state.activeTab||2==this.state.activeTab)&&this.state.all_addr.length>0?f.createElement(b.ZP,{container:!0,spacing:2,marginTop:0},f.createElement(b.ZP,{item:!0,xs:12},f.createElement(k.rZ,{multiline:!0,maxRows:2,value:this.state.comment,func:this.changeData.bind(this,"comment"),label:"Комментарий курьеру"})),f.createElement(b.ZP,{item:!0,xs:4},f.createElement(k.rZ,{type:"number",value:this.state.sdacha,func:this.changeData.bind(this,"sdacha"),label:"Сдача"}))):null,f.createElement(b.ZP,{container:!0,spacing:2,marginTop:0},f.createElement(b.ZP,{item:!0,xs:12},f.createElement(P.Z,{position:"static",style:{backgroundColor:"#fff",borderRadius:12,overflow:"hidden"}},f.createElement(C.Z,{value:this.state.typeTime,onChange:this.changeTypeTime,indicatorColor:"secondary",variant:"fullWidth",style:{height:40,minHeight:40}},f.createElement(O.Z,(0,m.Z)({label:"По текущему",style:{minWidth:"auto",height:40,minHeight:40}},ue(0))),f.createElement(O.Z,(0,m.Z)({label:"Ко времени",style:{minWidth:"auto",height:40,minHeight:40}},ue(1)))))),0==this.state.typeTime?f.createElement(b.ZP,{item:!0,xs:12},f.createElement(N.Z,{variant:"h6",component:"span"},this.state.textAvgTime)):f.createElement(f.Fragment,null,f.createElement(b.ZP,{item:!0,xs:6},f.createElement(k.$S,{data:this.state.date_pred,value:this.state.date,func:this.changeData.bind(this,"date"),label:"Дата"})),f.createElement(b.ZP,{item:!0,xs:6},f.createElement(k.$S,{data:this.state.timePred,value:this.state.time,func:this.changeData.bind(this,"time"),label:"Время"})))),f.createElement(b.ZP,{container:!0,spacing:2,marginTop:0},f.createElement(b.ZP,{item:!0,xs:12},f.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},f.createElement("div",{style:{display:"flex",flexDirection:"column"}},f.createElement(N.Z,{variant:"h6",component:"span",style:{fontSize:"0.8rem",color:"#bababa"}},"Доставка: ",this.state.sumDiv," р"),f.createElement(N.Z,{variant:"h6",component:"span"},"К оплате: ",parseInt(this.state.AllPrice)+parseInt(this.state.sumDiv)," р")),f.createElement(U.Z,{style:{height:"fit-content",color:"#fff"},variant:"contained",color:"secondary",onClick:this.startOrderNext.bind(this)},"Оформить заказ"))))),f.createElement(b.ZP,{item:!0,xs:4},this.state.cats.length>0&&this.state.allItems.length>0?f.createElement(k.e_,{id:"addItemsAll",data:this.state.allItems,value:this.state.thisItem,func:this.addItemCustom.bind(this),multiple:!1,label:"Товары"}):null),f.createElement(b.ZP,{item:!0,xs:12},this.state.cats.length>0&&this.state.allItems.length>0?f.createElement(f.Fragment,null,f.createElement(P.Z,{position:"static",style:{backgroundColor:"#fff",borderRadius:12,overflow:"hidden"}},f.createElement(C.Z,{value:this.state.activeCat,onChange:this.changeCat,indicatorColor:"secondary",variant:"fullWidth"},this.state.cats.map((function(e,t){return f.createElement(O.Z,(0,m.Z)({label:e.name,style:{minWidth:"auto"},key:t},ue(t)))})))),this.state.cats.map((function(t,r){return f.createElement(me,{value:e.state.activeCat,index:r,key:r},f.createElement(b.ZP,{container:!0,spacing:2,className:"container",style:{paddingTop:0}},t.items.map((function(t,r){return f.createElement(b.ZP,{key:r,item:!0,xs:2},f.createElement(W.Z,{className:"paperCat",style:{display:"flex",flexDirection:"column",height:"100%",justifyContent:"space-around",position:"relative"},onClick:e.addToCart.bind(e,t.id)},f.createElement(N.Z,{component:"span"},t.name),f.createElement(N.Z,{component:"span"},t.price," р."),f.createElement(z.Z,{placement:"top",style:{position:"absolute",top:0,right:0},title:f.createElement(f.Fragment,null,f.createElement(N.Z,{color:"inherit"},t.tmp_desc),f.createElement(N.Z,{color:"inherit"},t.info_weight))},f.createElement(ie.Z,null))))}))))}))):null))}}]),M}(f.Component);function ve(){return f.createElement("div",{style:{flexGrow:1}},f.createElement(fe,null))}}}]);
//# sourceMappingURL=227.2a2d0f6377d214f206af.js.map