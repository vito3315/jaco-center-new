(()=>{var e,t={5858:(e,t,r)=>{"use strict";var n=r(7294),a=r(3935),i=r(3727),o=r(6610),s=r(5991),l=r(3349),c=r(379),d=r(6070),m=r(7608),u=r(6156),p=r(5977),h=r(2122),f=r(1253),y=r(1120),g=r(4670),v=r(282),_=r(2822),Z=r(998),E=r(5757),I=r(381),C=r.n(I),T=r(4593),w=r(1749),b=r(5258),k=r(2318),P=r(9895),x=r(65),S=r(1423),O=r(5697),D=r.n(O),A=r(7748),N=r(868),M=r(8362),j=r(5431),R=r(8286),B=r(4837),L=r(3700),W=r(5639),J=r(4436),z=r(3200),H=r(7329),U=r(8949),Y=r(7563);(0,U.jQ)({enforceActions:"never"});var F=new(function(){function e(){var t=this;if((0,o.Z)(this,e),(0,u.Z)(this,"items",""),(0,u.Z)(this,"itemsPromo",""),(0,u.Z)(this,"promoName",""),(0,u.Z)(this,"allItems",""),(0,u.Z)(this,"allItemsCat",""),(0,u.Z)(this,"banners",""),(0,u.Z)(this,"AllPrice",0),(0,u.Z)(this,"sum_div",0),(0,u.Z)(this,"cityName",0),(0,u.Z)(this,"cityNameRU",""),(0,u.Z)(this,"promo",null),(0,u.Z)(this,"userToken",null),(0,u.Z)(this,"userName",""),(0,u.Z)(this,"activePage",""),(0,u.Z)(this,"need_dops",""),(0,u.Z)(this,"free_items",""),(0,u.Z)(this,"cart_data",""),(0,u.Z)(this,"typeOrder",0),(0,u.Z)(this,"clientNumber",""),(0,u.Z)(this,"clear",!1),(0,u.Z)(this,"MyPromos",""),(0,u.Z)(this,"updateMyPromos",""),(0,u.Z)(this,"setMyPromos",(function(e){t.MyPromos=JSON.stringify(e),t.updateMyPromos=new Date,localStorage.setItem("MyPromos",JSON.stringify(e))})),(0,u.Z)(this,"setSumDiv",(function(e){t.sum_div=parseInt(e)})),(0,u.Z)(this,"setDops",(function(e){t.need_dops=JSON.stringify(e)})),(0,u.Z)(this,"setFreeItems",(function(e){t.free_items=JSON.stringify(e)})),(0,u.Z)(this,"setCityRU",(function(e){t.cityNameRU=e})),(0,u.Z)(this,"setCity",(function(e){t.cityName=e})),(0,u.Z)(this,"setAllPrice",(function(e){t.AllPrice=e})),(0,u.Z)(this,"setPage",(function(e){t.activePage=e})),(0,u.Z)(this,"setToken",(function(e,r){t.userToken=e,t.setUserName(r),"undefined"!=typeof window&&localStorage.setItem("token",e)})),(0,u.Z)(this,"setPromo",(function(e,r){t.promo=e,localStorage.setItem("promo_name",r)})),(0,u.Z)(this,"setItemsPromo",(function(e){t.itemsPromo=JSON.stringify(e)})),(0,u.Z)(this,"setAllItemsCat",(function(e){t.allItemsCat=JSON.stringify(e)})),(0,u.Z)(this,"setItems",(function(e){var r=0,n=0,a=t.getItemsPromo();if(n=e.reduce((function(e,t){return e+parseInt(t.all_price)}),r),r=0,n+=a.reduce((function(e,t){return e+parseInt(t.all_price)}),r),t.setAllPrice(n),t.items=JSON.stringify(e),"undefined"!=typeof window){var i=e.filter((function(e){return e.count>0}));i=JSON.stringify(i),localStorage.setItem("my_cart",i)}})),(0,u.Z)(this,"saveCartData",(function(e){var r=JSON.stringify(e);t.cart_data=r,"undefined"!=typeof window&&localStorage.setItem("cartData",r)})),(0,u.Z)(this,"setAllItems",(function(e){t.allItems=JSON.stringify(e),t.checkCart()})),"undefined"!=typeof window){if(localStorage.getItem("my_cart")){var r=JSON.parse(localStorage.getItem("my_cart")),n=(this.getAllItems(),[]);r.forEach((function(e){n.push({name:e.name,item_id:e.item_id,count:e.count,one_price:parseInt(e.one_price),all_price:parseInt(e.one_price)*parseInt(e.count)})})),this.setItems(n)}localStorage.getItem("token")&&this.setToken(localStorage.getItem("token")),localStorage.getItem("cartData")&&(this.cartData=localStorage.getItem("cartData")),localStorage.getItem("promo_name")&&setTimeout((function(){t.getInfoPromo(localStorage.getItem("promo_name"))}),300),localStorage.getItem("MyPromos")&&localStorage.getItem("MyPromos").length>0&&this.setMyPromos(JSON.parse(localStorage.getItem("MyPromos"),!0))}(0,U.ky)(this)}return(0,s.Z)(e,[{key:"getMyPromos",value:function(){return 0==this.MyPromos.length?[]:JSON.parse(this.MyPromos,!0)}},{key:"getSumDiv",value:function(){return this.sum_div}},{key:"getDops",value:function(){return 0==this.need_dops.length?[]:JSON.parse(this.need_dops,!0)}},{key:"getFreeItems",value:function(){return 0==this.free_items.length?[]:JSON.parse(this.free_items,!0)}},{key:"getCityRU",value:function(){return this.cityNameRU&&this.cityNameRU.length>0?this.cityNameRU:"Город"}},{key:"getCity",value:function(){return this.cityName}},{key:"getAllPrice",value:function(){return this.AllPrice}},{key:"getPage",value:function(){return this.activePage}},{key:"getUserName",value:function(){return this.userName&&this.userName.length>0?this.userName:""}},{key:"setUserName",value:function(e){this.userName=e}},{key:"getToken",value:function(){return this.userToken}},{key:"getInfoPromo",value:function(e){fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Y.stringify({type:"get_promo",city_id:F.getCity(),promo_name:e})}).then((function(e){return e.json()})).then((function(t){F.setPromo(JSON.stringify(t),e),!1===F.checkPromo().st&&localStorage.removeItem("promo_name")}))}},{key:"getPromo",value:function(){return JSON.parse(this.promo,!0)}},{key:"checkPromo",value:function(){var e=F.getCartData();F.setItemsPromo([]);var t=0,r=0,n=e.orderTimes&&1!=parseInt(e.orderTimes)?e.orderPredDay+" "+e.orderPredTime:0,a=this.getPromo(),i=this.getItems(),o=this.getAllItems(),s=[];i.forEach((function(e,t){s.push({name:e.name,item_id:e.item_id,count:e.count,one_price:e.one_price,all_price:parseInt(e.one_price)*parseInt(e.count)})})),i=s,this.setItems(i);var l=[];r=i.reduce((function(e,t){return e+parseInt(t.all_price)}),t);var c,d,m=0,u=0,p=0;(e.orderType||0==e.orderType)&&(m=null!==(c=parseInt(e.orderType))&&void 0!==c?c:0,u=e.orderAddr?parseInt(e.orderAddr.point_id):0,p=null!==(d=parseInt(e.orderPic))&&void 0!==d?d:0);var h=C()(n).format("YYYY-MM-DD"),f=C()(n).format("H:mm"),y=parseInt(C()(n).format("E"));if(0==n?(h=C()(new Date).format("YYYY-MM-DD"),f=C()(new Date).format("H:mm"),y=parseInt(C()(new Date).format("E"))):(h=C()(n).format("YYYY-MM-DD"),f=C()(n).format("H:mm"),y=parseInt(C()(n).format("E"))),a){if(!a.status_promo)return{st:!1,text:a.promo_text.false};if(a.limits.date.min&&a.limits.date.max&&!(h>=a.limits.date.min&&h<=a.limits.date.max))return{st:!1,text:a.promo_text.false};if(0!=a.limits.time.min&&0!=a.limits.time.max&&!(f>=a.limits.time.min&&f<=a.limits.time.max))return{st:!1,text:a.promo_text.false};if(0!=a.limits.point_id&&!(0==m&&u==a.limits.point_id||1==m&&p==a.limits.point_id))return{st:!1,text:"Адрес для доставки или самовывоза указан некорректно. Проверьте правильность введённых данных."};if(!(0==a.limits.summ.min&&0==a.limits.summ.max||r>=a.limits.summ.min&&(a.limits.summ.max>=r||0==a.limits.summ.max)))return{st:!1,text:"Общая сумма вашего заказа превышает допустимую стоимость для применения промокода."};if(a.limits.dows&&0==parseInt(a.limits.dows[y]))return{st:!1,text:"Указанный вами день недели недоступен для применения промокода. Пожалуйста, выберите другую дату."};if(a.limits.type_order&&!(1==parseInt(a.limits.type_order)||3==parseInt(a.limits.type_order)&&0==m||2==parseInt(a.limits.type_order)&&1==m))return{st:!1,text:"Тип заказа не применим для данного промокода. Пожалуйста, отредактируйте заказ."};if(a.limits.only_kassa&&1==parseInt(a.limits.only_kassa))return{st:!1,text:"Указанный вами промокод действителен только при оплате на кассе. Пожалуйста, посетите для оформления заказа ближайшее к вам кафе."};if(a.limits.items.length>0){var g=0;if(a.limits.items.map((function(e){s.find((function(t){return t.item_id==e}))&&g++})),a.limits.items.length!=g)return{st:!1,text:a.promo_text.false}}var v=0,_=0,Z=null;return 1==parseInt(a.promo_action)?(1==parseInt(a.sale.cat_sale)&&(_=parseInt(a.sale.count_sale),i.forEach((function(e,t){Z=o.find((function(t){return t.id==e.item_id})),3!=parseInt(Z.type)&&4!=parseInt(Z.type)&&a.sale.sale_action.forEach((function(r){parseInt(e.item_id)==parseInt(r)&&(1==parseInt(a.sale.type_price)?_>0&&((v=parseInt(e.one_price)*parseInt(e.count)-parseInt(_))<=0&&(v=1),_-=parseInt(e.one_price)*parseInt(e.count),i[t].all_price=v):(v=parseInt(e.all_price)-parseInt(e.all_price)/100*parseInt(_),i[t].all_price=parseInt(v)))}))}))),2==parseInt(a.sale.cat_sale)&&(_=parseInt(a.sale.count_sale),i.forEach((function(e,t){Z=o.find((function(t){return t.id==e.item_id})),3!=parseInt(Z.type)&&4!=parseInt(Z.type)&&a.sale.sale_action.forEach((function(r){parseInt(Z.cat_id)==parseInt(r)&&(1==parseInt(a.sale.type_price)?_>0&&((v=parseInt(e.one_price)*parseInt(e.count)-parseInt(_))<=0&&(v=1),_-=parseInt(e.one_price)*parseInt(e.count),i[t].all_price=v):(v=parseInt(e.all_price)-parseInt(e.all_price)/100*parseInt(_),i[t].all_price=parseInt(v)))}))}))),3==parseInt(a.sale.cat_sale)&&(_=parseInt(a.sale.count_sale),i.forEach((function(e,t){Z=o.find((function(t){return t.id==e.item_id})),3!=parseInt(Z.type)&&4!=parseInt(Z.type)&&(1==parseInt(a.sale.type_price)?_>0&&((v=parseInt(e.one_price)*parseInt(e.count)-parseInt(_))<=0&&(v=1),_-=parseInt(e.one_price)*parseInt(e.count),i[t].all_price=v):(v=parseInt(e.all_price)-parseInt(e.all_price)/100*parseInt(_),i[t].all_price=parseInt(v)))}))),t=0,r=0,r=i.reduce((function(e,t){return e+t.all_price}),t),F.setAllPrice(r),{st:!0,text:a.promo_text.true}):(2==parseInt(a.promo_action)&&(a.items_add.forEach((function(e){Z=o.find((function(t){return t.id==e.item_id})),l.push({item_id:e.item_id,count:e.count,one_price:Z.price,all_price:e.price})})),t=0,r=0,r=i.reduce((function(e,t){return e+parseInt(t.all_price)}),t),t=0,r+=l.reduce((function(e,t){return e+parseInt(t.all_price)}),t),F.setItemsPromo(l),F.setAllPrice(r)),3==parseInt(a.promo_action)&&a.items_on_price.length>0&&(i.forEach((function(e,t){a.items_on_price.forEach((function(r){parseInt(e.item_id)==parseInt(r.id)&&(i[t].new_one_price=parseInt(r.price),i[t].all_price=parseInt(r.price)*parseInt(e.count))}))})),t=0,r=0,r=i.reduce((function(e,t){return e+parseInt(t.all_price)}),t),F.setAllPrice(r)),this.setItems(i),{st:!0,text:a.promo_text.true})}return{st:!1,text:a.promo_text.false,test:a}}},{key:"getItemsPromo",value:function(){return 0==this.itemsPromo.length?[]:JSON.parse(this.itemsPromo,!0)}},{key:"getAllItemsCat",value:function(){return 0==this.allItemsCat.length?[]:JSON.parse(this.allItemsCat,!0)}},{key:"getCartData",value:function(){if("undefined"!=typeof window)return localStorage.getItem("cartData")?JSON.parse(localStorage.getItem("cartData")):[]}},{key:"checkCart",value:function(){var e=this.getItems(),t=this.getAllItems(),r=[];e.forEach((function(e){var n=t.find((function(t){return parseInt(t.id)==parseInt(e.item_id)}));r.push({name:e.name,item_id:e.item_id,count:e.count,one_price:parseInt(n.price),all_price:parseInt(n.price)*parseInt(e.count)})})),this.setItems(r)}},{key:"getItems",value:function(){return 0==this.items.length?[]:JSON.parse(this.items,!0)}},{key:"getAllItems",value:function(){return 0==this.allItems.length?[]:JSON.parse(this.allItems,!0)}},{key:"AddItem",value:function(e){var t=F.getItems(),r=F.getAllItems(),n=F.getPromo();if(!(r.length>0))return 0;var a=t.find((function(t){return t.item_id==e})),i=0;a&&(i=a.count);var o=r.find((function(t){return t.id==e}));if(o){var s=i+1,l=o.price,c=F.check_max_count(parseInt(e));return parseInt(c)>=s?(t.some((function(t){return t.item_id==e}))?t.forEach((function(r,n){r.item_id==e&&(t[n].count=s,t[n].all_price=s*l)})):t.push({name:o.name,item_id:e,count:s,one_price:l,all_price:s*l}),F.setItems(t),n&&F.checkPromo(),s):s-1}}},{key:"AddCountItem",value:function(e,t){var r=F.getItems(),n=F.getAllItems(),a=F.getPromo();if(!(n.length>0))return 0;var i=r.find((function(t){return t.item_id==e}));i&&i.count;var o=n.find((function(t){return t.id==e}));if(o){var s=t,l=o.price,c=F.check_max_count(parseInt(e));return parseInt(c)>=s?(r.some((function(t){return t.item_id==e}))?r.forEach((function(t,n){t.item_id==e&&(r[n].count=s,r[n].all_price=s*l)})):r.push({name:o.name,item_id:e,count:s,one_price:l,all_price:s*l}),F.setItems(r),a&&F.checkPromo(),s):s-1}}},{key:"MinusItem",value:function(e){var t=F.getItems(),r=F.getAllItems(),n=F.getPromo();if(r.length>0){var a=t.find((function(t){return t.item_id==e}));if(!a)return 0;var i=r.find((function(t){return t.id==e})),o=parseInt(a.count)-1,s=i.price;return o<=0&&(o=0),o>=0&&(t.map((function(r,n){r.item_id==e&&(t[n].count=o,t[n].all_price=o*s)})),F.setItems(t)),n&&F.checkPromo(),o}return 0}},{key:"delItem",value:function(e){var t=F.getItems(),r=F.getAllItems(),n=F.getPromo();if(r.length>0){if(!t.find((function(t){return t.item_id==e})))return 0;var a=r.find((function(t){return t.id==e})),i=0,o=a.price;return i<=0&&(i=0),i>=0&&(t.map((function(r,n){r.item_id==e&&(t[n].count=i,t[n].all_price=i*o)})),F.setItems(t)),n&&F.checkPromo(),i}return 0}},{key:"check_need_dops",value:function(){var e=F.getItems(),t=F.getAllItems();if(!t||0==t.length)return[];var r=0,n=0,a=F.getDops();if(0==a.length)return[];e.forEach((function(e){var a=t.find((function(t){return t.id==e.item_id}));if(!a)return[];14==parseInt(a.cat_id)?r+=parseInt(e.count):14!==parseInt(a.cat_id)&&5!==parseInt(a.cat_id)&&6!==parseInt(a.cat_id)&&7!==parseInt(a.cat_id)&&(n+=parseInt(e.count))}));var i=[];n>0&&0==r&&(i=a.rolls),0==n&&r>0&&(i=a.pizza),n>0&&r>0&&(i=[].concat((0,H.Z)(a.rolls),(0,H.Z)(a.pizza))),0==n&&0==r&&(i=[].concat((0,H.Z)(a.rolls),(0,H.Z)(a.pizza)));var o=[],s=[];return e.forEach((function(e){var r=t.find((function(t){return t.id==e.item_id}));if(!r)return[];7==parseInt(r.cat_id)&&o.push(r)})),o.forEach((function(e){var t=!1;i.forEach((function(r){parseInt(r.id)==parseInt(e.id)&&(t=!0)})),t||s.push(e)})),i=[].concat((0,H.Z)(i),s)}},{key:"check_max_count",value:function(e){var t=[],r=[],n=F.getItems(),a=F.getFreeItems();if(!a)return 99;n.forEach((function(e,n){a.forEach((function(n){parseInt(e.item_id)==parseInt(n.this_item_id)&&(n.count_in_cart=parseInt(e.count),t.push(n),r.push(parseInt(n.item_id)))}))})),r=(0,H.Z)(new Set(r));var i=[];r.forEach((function(e,r){t.forEach((function(t){if(parseInt(e)==parseInt(t.item_id)){var r=!1;i.forEach((function(n,a){parseInt(n.item_id)==parseInt(e)&&(r=!0,i[a].count+=t.count_in_cart*t.max_count)})),r||i.push({item_id:parseInt(e),count:t.count_in_cart*t.max_count})}}))}));var o=99;return i.forEach((function(t){parseInt(t.item_id)==parseInt(e)&&(o=parseInt(t.count))})),o}}]),e}());const q=F;var K=r(64),G=r(366),V=r(3957),Q=r(2692),X=r(5477),$=r(2302),ee=r(9613),te=r(8222),re=r(6847),ne=r(3750),ae=r(7394),ie=r(2663),oe=r(6856),se=r(9525),le=r(7212),ce=r(6010),de=r(2112),me=r(5517),ue=r(8358),pe=r(7812),he=r(8884);r(6627);var fe=r(7563),ye=(0,g.Z)((function(e){return{tooltip:{backgroundColor:"#f5f5f9",color:"rgba(0, 0, 0, 0.87)",maxWidth:220,fontSize:e.typography.pxToRem(12),border:"1px solid #dadde9"}}}))(N.ZP),ge=function(e){(0,c.Z)(p,e);var t,r,a=(t=p,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,m.Z)(t);if(r){var a=(0,m.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,d.Z)(this,e)});function p(e){var t;return(0,o.Z)(this,p),t=a.call(this,e),(0,u.Z)((0,l.Z)(t),"componentDidMount",(function(){t._isMounted=!0;var e="";if(localStorage.getItem("clientNumber")&&(e=localStorage.getItem("clientNumber"),q.clientNumber=e,t.setState({number:e})),localStorage.getItem("promo_name")){var r=localStorage.getItem("promo_name");setTimeout((function(){t.setState({promo_name:r}),t.checkPromo({target:{value:r}})}),500)}(0,U.EH)((function(){if(q.updateMyPromos!=t.state.updateMyPromos){var e=q.getMyPromos(),r=[],n=C()(new Date).add(-7,"days").format("YYYY-MM-DD");e=e.filter((function(e){return e.date>=n})),localStorage.setItem("MyPromos",JSON.stringify(e)),e.forEach((function(e){var t=r.find((function(t){return t.promo==e.promo}));t&&0!=t.length?r.forEach((function(t,n){t.promo==e.promo&&r[n].count++})):(e.count=1,r.push(e))})),r=r.filter((function(e){return e.count>1})),t.setState({updateMyPromos:q.updateMyPromos,MyPromos:r})}!0===q.clear&&(t.clear(),q.clear=!1)}))})),t.state={classes:t.props.classes,cityList:t.props.cityList,city:q.getCity(),page:t.props.page,updateMyPromos:null,MyPromos:[],number:"",orderPromoText:"",promo_name:"",promoST:!1,top:!1,left:!1,bottom:!1,right:!1},t}return(0,s.Z)(p,[{key:"saveNumber",value:function(e){var t=e.target.value,r="";(t+="").length>0&&("7"!=(t=(t=(t=(t=(t=t.split(" ").join("")).split("(").join("")).split(")").join("")).split("-").join("")).split("+").join(""))[0]&&7!=t[0]||((r=t.split(""))[0]=8,t=r.join("")),11!=t.length)?alert("Номер введен в не верном формате!"):(this.setState({number:t}),q.clientNumber=t,localStorage.setItem("clientNumber",t))}},{key:"checkPromo",value:function(e){var t=this,r=e.target.value;fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:fe.stringify({type:"get_promo",city_id:q.getCity(),promo_name:r})}).then((function(e){return e.json()})).then((function(e){q.setPromo(JSON.stringify(e),r);var n=q.checkPromo();!1===n.st&&localStorage.removeItem("promo_name"),0==r.length?t.setState({orderPromoText:"",promoST:!1}):t.setState({orderPromoText:n.text,promoST:n.st})}))}},{key:"toggleDrawer2",value:function(e,t,r){this.setState((0,u.Z)({},e,t))}},{key:"clear",value:function(){q.clientNumber="",localStorage.removeItem("clientNumber"),q.setItems([]),q.saveCartData({orderType:"0",orderAddr:"",orderPic:0,orderComment:"",orderTimes:0,orderPredDay:"",orderPredTime:"",orderPay:"",orderSdacha:""}),this.checkPromo({target:{value:""}}),this.setState({number:"",promo_name:"",orderPromoText:""})}},{key:"changeCity",value:function(e){var t=e.target.value;this.setState({city:t}),q.setCity(t),localStorage.setItem("cityID",t),q.saveCartData({orderType:"0",orderAddr:"",orderPic:0,orderComment:"",orderTimes:0,orderPredDay:"",orderPredTime:"",orderPay:"",orderSdacha:""}),setTimeout((function(){}),500)}},{key:"logOut",value:function(){localStorage.removeItem("token"),setTimeout((function(){window.location.reload()}),500)}},{key:"render",value:function(){var e=this;return n.createElement("div",{className:this.state.classes.root},n.createElement(b.Z,{position:"static",style:{backgroundColor:"#fff",color:"#000"}},n.createElement(ue.Z,{style:{minHeight:48,height:48}},n.createElement(pe.Z,{edge:"start",onClick:this.toggleDrawer2.bind(this,"left",!0),color:"inherit","aria-label":"menu"},n.createElement(he.Z,null)),"createOrder"==this.state.page?n.createElement(w.Z,{container:!0,className:"headerInput"},n.createElement(w.Z,{item:!0,xs:3},n.createElement(J.Z,{className:this.state.classes.formControl},n.createElement(L.Z,{style:{paddingBottom:2}},"Город"),n.createElement(z.Z,{style:{marginTop:9},value:this.state.city,onChange:this.changeCity.bind(this)},this.state.cityList.map((function(e,t){return n.createElement(W.Z,{key:t,value:e.id},e.name)}))))),n.createElement(w.Z,{item:!0,xs:6,style:{display:"flex",alignItems:"center"}},n.createElement(j.ZP,{freeSolo:!0,label:"Промокод",variant:"outlined",size:"small",style:{minWidth:200,marginRight:8},value:this.state.promo_name,onChange:function(t,r){console.log(r,t.target.value),e.setState({promo_name:r})},onBlur:this.checkPromo.bind(this),options:this.state.MyPromos.map((function(e){return e.promo})),renderInput:function(e){return n.createElement(R.Z,(0,h.Z)({},e,{label:"Промокод",margin:"normal",variant:"outlined"}))}}),n.createElement(ye,{placement:"bottom",title:n.createElement(n.Fragment,null,n.createElement(k.Z,{color:"inherit",className:this.state.classes.size1},this.state.orderPromoText))},n.createElement(v.Z,{variant:"contained",color:"primary",style:{padding:"2px 6px",marginTop:8,minWidth:30,marginRight:8,backgroundColor:!1===this.state.promoST&&0==this.state.orderPromoText.length?"gray":!1===this.state.promoST&&this.state.orderPromoText.length>0?"red":"green"}},"?")),n.createElement(v.Z,{variant:"contained",color:"primary",className:"btnClear",style:{padding:"2px 6px",minWidth:30,marginTop:8},onClick:this.clear.bind(this)},n.createElement(G.Z,null))),n.createElement(w.Z,{item:!0,xs:3,style:{paddingTop:14}},n.createElement(R.Z,{label:"Телефон",variant:"outlined",size:"small",placeholder:"8 (999) 999-99-99",value:this.state.number,onChange:function(t){return e.setState({number:t.target.value})},onBlur:this.saveNumber.bind(this),style:{marginRight:4,marginLeft:4,marginBottom:6}}))):null)),n.createElement(de.ZP,{anchor:"left",open:this.state.left,onClose:this.toggleDrawer2.bind(this,"left",!1)},n.createElement("div",{className:(0,ce.Z)(this.state.classes.list),role:"presentation"},n.createElement(i.OL,{to:"/",style:{textDecoration:"none"}},n.createElement(Z.Z,{button:!0,style:{color:"#000"}},n.createElement(k.Z,{variant:"body1"},"Оформить заказ"))),n.createElement(i.OL,{to:"/orders",style:{textDecoration:"none"}},n.createElement(Z.Z,{button:!0,style:{color:"#000"}},n.createElement(k.Z,{variant:"body1"},"Список заказов"))),n.createElement(i.OL,{to:"/ordercook",style:{textDecoration:"none"}},n.createElement(Z.Z,{button:!0,style:{color:"#000"}},n.createElement(k.Z,{variant:"body1"},"Заказы на кухне"))),n.createElement(me.Z,null),n.createElement(_.Z,null,n.createElement(Z.Z,{button:!0,onClick:this.logOut.bind(this)},n.createElement(E.Z,{primary:"Выйти"}))))))}}]),p}(n.Component),ve=["children","value","index"];function _e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,m.Z)(e);if(t){var a=(0,m.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,d.Z)(this,r)}}var Ze=r(7563),Ee=(0,y.Z)((function(e){return{root2:{display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"center","& > svg, form":{borderRight:"0px!important"}},root3:{"& > *":{margin:e.spacing(1),width:50},"& .MuiOutlinedInput-input":{padding:"5px 10px"}},list:{width:250},fullList:{width:"auto"},root:{flexGrow:1},title:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary},paperCat:{padding:e.spacing(1),textAlign:"center",color:"#000",position:"relative",justifyContent:"space-between",height:"calc(100% - 15px)",cursor:"pointer","& svg":{color:e.palette.text.secondary}},paperCatInfo:{position:"absolute",top:0,right:0},size1:{},scrollTable:{maxHeight:250,overflow:"auto",padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}}));function Ie(e){var t=e.children,r=e.value,a=e.index,i=(0,f.Z)(e,ve);return n.createElement("div",(0,h.Z)({role:"tabpanel",hidden:r!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},i),r===a&&n.createElement(A.Z,{p:3},t))}Ie.propTypes={children:D().node,index:D().any.isRequired,value:D().any.isRequired};var Ce=(0,g.Z)((function(e){return{tooltip:{backgroundColor:"#f5f5f9",color:"rgba(0, 0, 0, 0.87)",maxWidth:220,fontSize:e.typography.pxToRem(12),border:"1px solid #dadde9"}}}))(N.ZP),Te=function(e){(0,c.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,l.Z)(n),"changeCat",(function(e,t){n.setState({activeCat:t})})),console.log(n.props.allItems),n.state={classes:n.props.classes,allItems:n.props.allItems,activeCat:0,cats:n.props.cats,thisItem:""},n}return(0,s.Z)(r,[{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentDidMount",value:function(){var e=this;(0,U.EH)((function(){var t=q.getAllItemsCat();q.getCity(),console.log(t),e.setState({cats:t})}))}},{key:"addToCart",value:function(e){q.AddItem(e)}},{key:"addItemCustom",value:function(e,t){var r=this,n=this.state.allItems.find((function(e){return e.name==t}));this.addToCart(n.id),this.setState({thisItem:n.name}),setTimeout((function(){r.setState({thisItem:""})}),100)}},{key:"render",value:function(){var e=this;return n.createElement(n.Fragment,null,n.createElement(j.ZP,{freeSolo:!0,size:"small",style:{width:"30%",marginLeft:16,marginBottom:8},value:this.state.thisItem,onChange:this.addItemCustom.bind(this),options:this.state.allItems.map((function(e){return e.name})),renderInput:function(e){return n.createElement(R.Z,(0,h.Z)({},e,{label:"Все позиции",margin:"normal",variant:"outlined"}))}}),n.createElement(b.Z,{position:"static"},n.createElement(x.Z,{value:this.state.activeCat,onChange:this.changeCat,"aria-label":"simple tabs example"},this.state.cats.map((function(e,t){return n.createElement(S.Z,(0,h.Z)({label:e.name,style:{minWidth:"auto"},key:t},{id:"simple-tab-".concat(r=t),"aria-controls":"simple-tabpanel-".concat(r)}));var r})))),this.state.cats.map((function(t,r){return n.createElement(Ie,{value:e.state.activeCat,index:r,key:r},n.createElement(w.Z,{container:!0,spacing:2,className:"container",style:{paddingTop:0}},t.items.map((function(t,r){return n.createElement(w.Z,{key:r,item:!0,xs:2},n.createElement(P.Z,{className:e.state.classes.paperCat,onClick:e.addToCart.bind(e,t.id)},n.createElement(w.Z,{container:!0,direction:"column",style:{height:"100%",justifyContent:"space-around"}},n.createElement(k.Z,{component:"span",className:e.state.classes.size1},t.name),n.createElement(k.Z,{component:"span",className:e.state.classes.size1},t.price," р."),n.createElement(Ce,{className:e.state.classes.paperCatInfo,placement:"top",title:n.createElement(n.Fragment,null,n.createElement(k.Z,{color:"inherit",className:e.state.classes.size1},t.tmp_desc),n.createElement(k.Z,{color:"inherit",className:e.state.classes.size1},t.info_weight))},n.createElement(M.Z,null)))))}))))})))}}]),r}(n.Component),we=function(e){(0,c.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,l.Z)(n),"_isMounted",!1),n.state={classes:n.props.classes,item:n.props.item,type:n.props.type},n}return(0,s.Z)(r,[{key:"shouldComponentUpdate",value:function(e,t){return!!t.item&&(parseInt(this.state.item.all_price)!==parseInt(t.item.all_price)||parseInt(this.state.item.count)!==parseInt(t.item.count))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,(0,U.EH)((function(){if(!0===e._isMounted){var t=q.getItems().find((function(t){return t.item_id==e.state.item.item_id}));e.setState({item:t})}}))}},{key:"delItem",value:function(e){q.delItem(e)}},{key:"changeCount",value:function(e){var t=e.target.value,r=this.state.item.item_id;t.length>0&&q.AddCountItem(r,t)}},{key:"add",value:function(){q.AddItem(this.state.item.item_id)}},{key:"minus",value:function(){q.MinusItem(this.state.item.item_id)}},{key:"render",value:function(){return n.createElement(ae.Z,{hover:!0,style:0==this.state.item.count?{display:"none"}:{}},n.createElement(te.Z,null,this.state.item.name),n.createElement(te.Z,{style:{textAlign:"center"}},"promo"==this.state.type?n.createElement(k.Z,{component:"span",style:{padding:"11px 0",display:"block"}},this.state.item.count):n.createElement("div",{className:this.state.classes.root2},n.createElement(K.Z,{onClick:this.minus.bind(this),style:{cursor:"pointer"}}),n.createElement("form",{className:this.state.classes.root3,noValidate:!0,autoComplete:"off"},n.createElement(R.Z,{variant:"outlined",onChange:this.changeCount.bind(this),value:this.state.item.count})),n.createElement(V.Z,{onClick:this.add.bind(this),style:{cursor:"pointer"}}))),n.createElement(te.Z,null,this.state.item.all_price),n.createElement(te.Z,null,"promo"!==this.state.type?n.createElement(G.Z,{style:{cursor:"pointer",marginTop:5},onClick:this.delItem.bind(this,this.state.item.item_id)}):null))}}]),r}(n.Component),be=function(e){(0,c.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,l.Z)(n),"_isMounted",!1),n.state={classes:n.props.classes,items:[],main_items:[],dop_items:[],promo_items:[]},n}return(0,s.Z)(r,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0;var t=q.getItems(),r=q.getAllItems(),n=q.getItemsPromo(),a=[];n.map((function(e){var t=r.find((function(t){return t.id==e.item_id}));t&&a.push({id:e.item_id,cat_id:t.cat_id,name:t.name,desc:t.tmp_desc,count:e.count,all_price:e.all_price,img:t.img_new,imgUpdate:t.img_new_update})}));var i=[],o=[];r.length>0&&(t.map((function(e){var t=r.find((function(t){return t.id==e.item_id}));t&&7==parseInt(t.cat_id)?o.push(e):i.push(e)})),this.setState({dop_items:o,main_items:i,promo_items:a})),(0,U.EH)((function(){if(!0===e._isMounted){var t=q.getItems(),r=q.getAllItems(),n=q.getItemsPromo(),a=[];n.map((function(e){var t=r.find((function(t){return t.id==e.item_id}));t&&a.push({id:e.item_id,cat_id:t.cat_id,name:t.name,desc:t.tmp_desc,count:e.count,all_price:e.all_price,img:t.img_new,imgUpdate:t.img_new_update})}));var i=[],o=[];r.length>0&&(t.map((function(e){var t=r.find((function(t){return t.id==e.item_id}));t&&7==parseInt(t.cat_id)?o.push(e):i.push(e)})),e.setState({dop_items:o,main_items:i,promo_items:a}))}}))}},{key:"render",value:function(){var e=this;return n.createElement(P.Z,{style:{widows:"100%"}},n.createElement(re.Z,{style:{maxHeight:350}},n.createElement($.Z,{stickyHeader:!0,"aria-label":"sticky table"},n.createElement(ne.Z,null,n.createElement(ae.Z,null,n.createElement(te.Z,null,"Наимнование"),n.createElement(te.Z,{style:{textAlign:"center"}},"Кол-во"),n.createElement(te.Z,null,"Сумма"),n.createElement(te.Z,null," ",n.createElement(G.Z,{style:{marginTop:5}})," "))),n.createElement(ee.Z,null,this.state.main_items.map((function(t,r){return n.createElement(we,{key:r,item:t,classes:e.state.classes,type:"main"})})),this.state.dop_items.map((function(t,r){return n.createElement(we,{key:r,item:t,classes:e.state.classes,type:"dop"})})),this.state.promo_items.map((function(t,r){return n.createElement(we,{key:r,item:t,classes:e.state.classes,type:"promo"})}))))))}}]),r}(n.Component),ke=function(e){(0,c.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,l.Z)(n),"_isMounted",!1),n.state={classes:n.props.classes,all_addr:n.props.all_addr,defValStreet:"",defValHome:"",newAddrInfo:"",newAddrStreet:"",newAddrHome:"",newAddrPD:"",newAddrET:"",newAddrKV:"",newAddrDom:"",pd:"",et:"",kv:"",comment:"",sdacha:""},n}return(0,s.Z)(r,[{key:"checkNewAddr",value:function(){var e=this,t=document.querySelector("#newAddrStreet").value;t.length>0&&this.state.newAddrHome.length>0&&fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ze.stringify({type:"save_new_addr",city_id:q.getCity(),street:t,home:this.state.newAddrHome,user_id:q.getToken()})}).then((function(e){return e.json()})).then((function(t){if(t.st){e.setState({newAddrInfo:t.res});var r=q.getAllPrice();1==parseInt(t.res?t.res.free_drive:0)?parseInt(r)>0?q.setSumDiv(0):q.setSumDiv(1):q.setSumDiv(parseInt(t.res?t.res.sum_div:0)),e.saveData()}else alert(t.text)}))}},{key:"changeDomTrue",value:function(e){this.setState({newAddrDom:e}),this.changeData("domTrue",{target:{value:e}})}},{key:"changeData",value:function(e,t){var r=t.target.value;this.setState((0,u.Z)({},e,r)),this.saveData()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,(0,U.EH)((function(){if(e._isMounted){var t=q.getCartData();if(q.cart_data,console.log("custom",t),t.orderType||0==t.orderType){e.setState({newAddrStreet:t.orderAddr&&t.orderAddr.street?t.orderAddr.street:"",newAddrHome:t.orderAddr&&t.orderAddr.home?t.orderAddr.home:"",pd:t.orderAddr&&t.orderAddr.pd?t.orderAddr.pd:"",et:t.orderAddr&&t.orderAddr.et?t.orderAddr.et:"",kv:t.orderAddr&&t.orderAddr.kv?t.orderAddr.kv:"",newAddrDom:!t.orderAddr||1!=parseInt(t.orderAddr.dom_true)});var r=q.getAllPrice();1==parseInt(t.orderAddr?t.orderAddr.free_drive:0)?parseInt(r)>0?q.setSumDiv(0):q.setSumDiv(1):q.setSumDiv(parseInt(t.orderAddr?t.orderAddr.sum_div:0))}else e.setState({newAddrStreet:"",newAddrHome:"",pd:"",et:"",kv:"",newAddrDom:!0}),q.setSumDiv(0)}}));var t=q.getCartData();if(t.orderType||0==t.orderType){this.setState({});var r=q.getAllPrice();1==parseInt(t.orderAddr?t.orderAddr.free_drive:0)?parseInt(r)>0?q.setSumDiv(0):q.setSumDiv(1):q.setSumDiv(parseInt(t.orderAddr?t.orderAddr.sum_div:0))}}},{key:"saveData",value:function(){var e=this,t=q.getCartData();console.log("saveCartData BlockAddrCustom",this.state.newAddrInfo);var r=this.state.newAddrInfo?this.state.newAddrInfo:t.orderAddr;setTimeout((function(){var n={orderType:0,orderAddr:{id:-1,street:r.street?r.street:"",home:r.home?r.home:"",kv:e.state.kv,pd:e.state.pd,et:e.state.et,dom_true:e.state.newAddrDom?0:1,free_drive:r.free_drive?r.free_drive:0,sum_div:r.sum_div?r.sum_div:0,point_id:r.point_id?r.point_id:0,xy:r.xy?r.xy:"",pay_active:r.pay_active?r.pay_active:0},orderPic:t&&t.orderPic?t.orderPic:0,orderComment:t&&t.orderComment?t.orderComment:"",orderTimes:t&&t.orderTimes?t.orderTimes:"0",orderPredDay:t&&t.orderPredDay?t.orderPredDay:"",orderPredTime:t&&t.orderPredTime?t.orderPredTime:"",orderPay:t&&t.orderPay?t.orderPay:"0",orderSdacha:t&&t.orderSdacha?t.orderSdacha:""};q.saveCartData(n)}),500)}},{key:"render",value:function(){var e=this;return n.createElement(w.Z,{container:!0,spacing:3},n.createElement("div",{className:"mainAddr"},n.createElement(j.ZP,{freeSolo:!0,id:"newAddrStreet",style:{flex:3},value:this.state.newAddrStreet,onChange:function(t,r){e.setState({newAddrStreet:r})},onBlur:this.checkNewAddr.bind(this),options:this.state.all_addr.map((function(e){return e.value})),renderInput:function(e){return n.createElement(R.Z,(0,h.Z)({},e,{label:"Улица",margin:"normal",variant:"outlined"}))}}),n.createElement(R.Z,{label:"Дом",variant:"outlined",style:{margin:"16px 8px 8px 8px",flex:1},value:this.state.newAddrHome,onChange:function(t){return e.setState({newAddrHome:t.target.value})},onBlur:this.checkNewAddr.bind(this)})),n.createElement("div",{className:"otherAddr"},n.createElement(R.Z,{label:"Подъезд",variant:"outlined",style:{marginRight:4},value:this.state.pd,onChange:this.changeData.bind(this,"pd"),onBlur:this.changeData.bind(this,"pd")}),n.createElement(R.Z,{label:"Этаж",variant:"outlined",style:{marginRight:4,marginLeft:4},value:this.state.et,onBlur:this.changeData.bind(this,"et"),onChange:this.changeData.bind(this,"et")}),n.createElement(R.Z,{label:"Квартира",variant:"outlined",style:{marginRight:8,marginLeft:4},value:this.state.kv,onBlur:this.changeData.bind(this,"kv"),onChange:this.changeData.bind(this,"kv")})),n.createElement("div",{style:{width:"100%",marginRight:8}},n.createElement(B.Z,{disableElevation:!0,variant:"contained",className:"chooseDomTrue"},n.createElement(v.Z,{className:!0===this.state.newAddrDom?"active":"",onClick:this.changeDomTrue.bind(this,!0)},"Домофон работает"),n.createElement(v.Z,{className:!1===this.state.newAddrDom?"active":"",onClick:this.changeDomTrue.bind(this,!1)},"Домофон не работает"))))}}]),r}(n.Component),Pe=function(e){(0,c.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,l.Z)(n),"_isMounted",!1),n.state={classes:n.props.classes,clientAddr:n.props.clientAddr,chooseAddr:-1},n}return(0,s.Z)(r,[{key:"chooseAddr",value:function(e,t,r){var n=q.getAllPrice();if(1==parseInt(t?t.free_drive:0)?parseInt(n)>0?q.setSumDiv(0):q.setSumDiv(1):q.setSumDiv(parseInt(t?t.sum_div:0)),console.log("addr item",t),e!=this.state.chooseAddr){this.setState({chooseAddr:e});var a=q.getCartData();if(a.orderType||0==a.orderType){var i={orderType:0,type:"client",orderAddr:t,orderPic:a.orderPic,orderComment:a.orderComment,orderTimes:a.orderTimes,orderPredDay:a.orderPredDay,orderPredTime:a.orderPredTime,orderPay:a.orderPay,orderSdacha:a.orderSdacha};console.log("saveCartData BlockAddrMy 1"),q.saveCartData(i)}else{var o={orderType:"0",type:"client",orderAddr:t,orderPic:0,orderComment:"",orderTimes:"1",orderPredDay:"",orderPredTime:"",orderPay:"",orderSdacha:""};console.log("saveCartData BlockAddrMy 2"),q.saveCartData(o)}}}},{key:"chooseAddr2",value:function(e,t,r){var n=q.getAllPrice();1==parseInt(t?t.free_drive:0)?parseInt(n)>0?q.setSumDiv(0):q.setSumDiv(1):q.setSumDiv(parseInt(t?t.sum_div:0)),e!=this.state.chooseAddr&&this.setState({chooseAddr:e})}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,(0,U.EH)((function(){if(e._isMounted){var t=q.getCartData();q.cart_data,(t.orderType||0==t.orderType)&&setTimeout((function(){var r=e.state.clientAddr.findIndex((function(e,r){return e.street==t.orderAddr.street&&e.home==t.orderAddr.home}));console.log(t),r!=e.state.chooseAddr&&e.chooseAddr2(r,t.orderAddr)}),500)}}))}},{key:"saveData",value:function(){var e=this;setTimeout((function(){var t={orderType:e.state.orderType,orderAddr:e.state.orderAddr,orderPic:e.state.orderPic,orderComment:e.state.orderComment,orderTimes:e.state.orderTimes,orderPredDay:e.state.orderPredDay,orderPredTime:e.state.orderPredTime,orderPay:e.state.orderPay,orderSdacha:e.state.orderSdacha};console.log("saveCartData BlockAddrMy 3"),q.saveCartData(t)}),500)}},{key:"render",value:function(){var e=this;return n.createElement(_.Z,{component:"nav","aria-label":"main mailbox folders",style:{maxHeight:106,overflow:"auto",marginLeft:-13}},this.state.clientAddr.map((function(t,r){return n.createElement(Z.Z,{button:!0,key:r,selected:e.state.chooseAddr===r,onClick:e.chooseAddr.bind(e,r,t),style:{paddingTop:0,paddingBottom:0}},n.createElement(E.Z,{primary:t.street+" "+t.home+(0==parseInt(t.pd)?"":", Пд. "+t.pd)+(0==parseInt(t.et)?"":", Эт. "+t.et)+(0==parseInt(t.kv)?"":", Кв. "+t.kv)}))})))}}]),r}(n.Component),xe=function(e){(0,c.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,l.Z)(n),"_isMounted",!1),console.log("start data 11"),n.state={classes:n.props.classes,pic_point:n.props.pic_point,orderPic:0,picPointInfo:null},n}return(0,s.Z)(r,[{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,(0,U.EH)((function(){if(e._isMounted){var t=q.getCartData();q.cart_data,t.orderType&&setTimeout((function(){var r=e.state.pic_point.find((function(e){return parseInt(e.id)==parseInt(t.orderPic)}));e.state.orderPic!=r&&(r?(console.log("update PIC"),e.choosePic(r)):e.setState({orderPic:0,picPointInfo:null}))}),500)}}));var t=q.getCartData();t.orderType&&1==t.orderType&&setTimeout((function(){var r=e.state.pic_point.find((function(e){return parseInt(e.id)==parseInt(t.orderPic)}));r&&e.choosePic(r)}),500)}},{key:"choosePic",value:function(e){this.setState({orderPic:e.id,picPointInfo:e}),q.setSumDiv(0),this.saveData()}},{key:"saveData",value:function(){var e=this,t=q.getCartData();setTimeout((function(){var r={orderType:1,orderAddr:t&&t.orderAddr?t.orderAddr:"",orderPic:e.state.orderPic,orderComment:t&&t.orderComment?t.orderComment:"",orderTimes:t&&t.orderTimes?t.orderTimes:"0",orderPredDay:t&&t.orderPredDay?t.orderPredDay:"",orderPredTime:t&&t.orderPredTime?t.orderPredTime:"",orderPay:t&&t.orderPay?t.orderPay:"0",orderSdacha:t&&t.orderSdacha?t.orderSdacha:""};console.log("saveCartData BlockPic"),q.saveCartData(r)}),500)}},{key:"render",value:function(){var e=this;return n.createElement(w.Z,{container:!0,direction:"column",justify:"space-between",alignItems:"stretch",spacing:3,className:"container",style:{paddingRight:8}},this.state.pic_point.map((function(t,r){return n.createElement(v.Z,{key:r,onClick:e.choosePic.bind(e,t),style:{backgroundColor:e.state.orderPic==t.id?"#6ab04c":"#e5e5e5",color:e.state.orderPic==t.id?"#fff":"#000"},className:"boxPic"},t.addr)})))}}]),r}(n.Component),Se=function(e){(0,c.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,l.Z)(n),"_isMounted",!1),(0,u.Z)((0,l.Z)(n),"_thisEdit",!1),(0,u.Z)((0,l.Z)(n),"changeTypeTime",(function(e,t){n._thisEdit=!0,n.changeData("typeTime",{target:{value:t}}),n.loadTimeWait()})),n.state={classes:n.props.classes,point_id:0,textAvgTime:"Среднее время: ~",date:"",time:"",typeTime:0,timePred:[],date_pred:n.props.date_pred},n}return(0,s.Z)(r,[{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,(0,U.EH)((function(){var t=q.getCartData();q.cart_data,e._isMounted&&(console.log("test",t,!t.orderAddr.point_id),t.orderAddr.point_id||0!=t.orderPic||(e.setState({time:"",date:""}),console.log("clear222",t)),0==t.orderType&&t.orderAddr.point_id&&parseInt(t.orderAddr.point_id)!=parseInt(e.state.point_id)&&(console.log("1"),e.loadTimeWait(),e.setState({point_id:e.state.point_id})),1==t.orderType&&t.orderPic&&parseInt(t.orderPic)!=parseInt(e.state.point_id)&&(console.log("3"),e.loadTimeWait(),e.setState({point_id:t.orderPic})),e._thisEdit||(console.log("2"),e.startData()))})),console.log("start data"),this.startData()}},{key:"loadTimePred",value:function(){var e,t,r=this,n=[],a=q.getItems(),i=q.getCartData();(i.orderType+1!=1||i.orderAddr&&i.orderAddr.point_id)&&(a.forEach((function(e){n.push({item_id:e.item_id,count:e.count})})),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ze.stringify({type:"get_times_pred_web",point_id:i.orderType+1==1?null!==(e=i.orderAddr.point_id)&&void 0!==e?e:0:null!==(t=i.orderPic)&&void 0!==t?t:0,type_order:i.orderType+1,date:this.state.date,cart:JSON.stringify(n)})}).then((function(e){return e.json()})).then((function(e){console.log(e),e.st&&r.setState({timePred:e.data})})))}},{key:"loadTimeWait",value:function(){var e,t,r=this,n=q.getCartData();fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ze.stringify({type:"load_time_wait",point_id:n.orderType+1==1?null!==(e=n.orderAddr.point_id)&&void 0!==e?e:0:null!==(t=n.orderPic)&&void 0!==t?t:0,type_order:n.orderType,city_id:q.getCity()})}).then((function(e){return e.json()})).then((function(e){r.setState({textAvgTime:e})}))}},{key:"changeData",value:function(e,t){var r=this;this._thisEdit=!0;var n=t.target.value;this.setState((0,u.Z)({},e,n)),"date"==e&&setTimeout((function(){r.loadTimePred()}),300),this.saveData()}},{key:"saveData",value:function(){var e=this,t=q.getCartData();setTimeout((function(){var r={orderType:t&&t.orderType?t.orderType:"0",orderAddr:t&&t.orderAddr?t.orderAddr:"",orderPic:t&&t.orderPic?t.orderPic:"0",orderComment:t&&t.orderComment?t.orderComment:"",orderTimes:e.state.typeTime,orderPredDay:e.state.date,orderPredTime:e.state.time,orderPay:t&&t.orderPay?t.orderPay:"0",orderSdacha:t&&t.orderSdacha?t.orderSdacha:""};console.log("saveCartData BlockPred"),q.saveCartData(r)}),500)}},{key:"startData",value:function(){var e=this;this._thisEdit=!0;var t=q.getCartData();if(t){var r=t.orderPredDay;if(0==this.state.date_pred.filter((function(e){return e.date<r})).length)return this.changeTypeTime(null,0),void this.setState({time:"",date:""});this.setState({date:r}),setTimeout((function(){e.loadTimePred(),setTimeout((function(){t.orderPredTime&&(0==e.state.timePred.filter((function(e){return e.value==t.orderPredTime})).length?e.changeTypeTime(null,0):e.setState({time:t.orderPredTime}))}),1e3)}),500)}t.orderTimes&&this.setState({typeTime:t.orderTimes}),this._thisEdit=!1}},{key:"render",value:function(){return n.createElement(n.Fragment,null,n.createElement(w.Z,{container:!0,spacing:3,className:"container"},n.createElement(x.Z,{value:this.state.typeTime,onChange:this.changeTypeTime,style:{marginTop:15,width:"100%",marginBottom:10},indicatorColor:"primary",textColor:"primary",centered:!0},n.createElement(S.Z,{label:"По текущему"}),n.createElement(S.Z,{label:"Ко времени"}))),0==this.state.typeTime?n.createElement(w.Z,{container:!0,spacing:3,className:"container"},n.createElement(k.Z,{component:"span",style:{padding:"8px 0px",fontSize:"1rem"}},this.state.textAvgTime)):n.createElement(w.Z,{container:!0,spacing:3,className:"container"},n.createElement("div",{className:"formPred"},n.createElement(J.Z,{variant:"outlined",className:"formControl"},n.createElement(L.Z,null,"Дата"),n.createElement(z.Z,{value:this.state.date,onChange:this.changeData.bind(this,"date"),label:"Дата"},this.state.date_pred.map((function(e,t){return n.createElement(W.Z,{key:t,value:e.date},e.text)})))),n.createElement(J.Z,{variant:"outlined",className:"formControl"},n.createElement(L.Z,null,"Время"),n.createElement(z.Z,{value:this.state.time,onChange:this.changeData.bind(this,"time"),label:"Время"},this.state.timePred.map((function(e,t){return n.createElement(W.Z,{key:t,value:e.value},e.text)})))))))}}]),r}(n.Component),Oe=function(e){(0,c.Z)(r,e);var t=_e(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,l.Z)(n),"_isMounted",!1),(0,u.Z)((0,l.Z)(n),"clickOrderStart",!1),(0,u.Z)((0,l.Z)(n),"startOrderInterval",90),(0,u.Z)((0,l.Z)(n),"startOrderIntervalTimer",null),(0,u.Z)((0,l.Z)(n),"interval",null),(0,u.Z)((0,l.Z)(n),"componentDidMount",(function(){n._isMounted=!0,n.interval=setInterval((function(){return n.checkLogin()}),36e5),n.checkLogin();var e=q.getCartData(),t=localStorage.getItem("cityID");t?(q.setCity(t),n.setState({cityID:t})):(q.setCity(1),n.setState({cityID:1})),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ze.stringify({type:"get_cat_center",city_id:q.getCity()})}).then((function(e){return e.json()})).then((function(e){n.setState({cats:e.arr,cityList:e.city_list,allItems:e.all_items}),q.setAllItemsCat(e.arr),q.setAllItems(e.all_items)})).catch((function(e){})),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ze.stringify({type:"get_by_mi",city_id:q.getCity(),user_id:q.getToken()})}).then((function(e){return e.json()})).then((function(e){n.setState({pic_point:e.get_addr_pic.points,all_addr:e.get_addr,date_pred:e.date_pred})})),(0,U.EH)((function(){if(n._isMounted){var e=q.getCity(),t=q.getCartData();q.cart_data,parseInt(e)!=parseInt(n.state.cityID)&&(n.setState({cityID:e,pic_point:[],all_addr:[],date_pred:[]}),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ze.stringify({type:"get_cat_center",city_id:e})}).then((function(e){return e.json()})).then((function(e){n.setState({cats:e.arr,cityList:e.city_list}),console.log("update",e.arr),q.setAllItemsCat(e.arr),q.setAllItems(e.all_items)})).catch((function(e){})),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ze.stringify({type:"get_by_mi",city_id:e,user_id:q.getToken()})}).then((function(e){return e.json()})).then((function(e){console.log("load new pics"),n.setState({pic_point:e.get_addr_pic.points,all_addr:e.get_addr,date_pred:e.date_pred})}))),parseInt(t.orderType)!=parseInt(n.state.typeOrder)&&n.setState({typeOrder:t.orderType}),t.orderComment!=n.state.comment&&n.setState({comment:t.orderComment}),parseInt(t.orderSdacha)!=parseInt(n.state.sdacha)&&n.setState({sdacha:t.orderSdacha}),q.clientNumber!=n.state.clientNumber&&(n.setState({clientNumber:q.clientNumber}),setTimeout((function(){n.getAddr()}),300));var r=q.getAllPrice(),a=q.getSumDiv();parseInt(r)!=parseInt(n.state.AllPrice)&&n.setState({AllPrice:r}),parseInt(a)!=parseInt(n.state.sumDiv)&&n.setState({sumDiv:a})}})),e&&e.orderType&&n.setState({activeTab:1==parseInt(e.orderType)?1:0,typeOrder:parseInt(e.orderType),comment:e.comment?e.comment:"",sdacha:e.sdacha?e.sdacha:""})})),(0,u.Z)((0,l.Z)(n),"changeTab",(function(e,t){(0==parseInt(t)||1==parseInt(t))&&parseInt(t),console.log("new state",{activeTab:t,typeOrder:0==parseInt(t)||1==parseInt(t)?parseInt(t):0}),n.setState({activeTab:t}),setTimeout((function(){console.log("new type order11",n.state.typeOrder,n.state.activeTab),n.saveData()}),500)})),n.state={classes:n.props.classes,allItems:[],newOrder:null,errorOpen:!1,error:{title:"",text:""},orderCheck:!1,spiner:!1,cityID:0,AllPrice:0,sumDiv:0,activeTab:0,clientNumber:"",cityList:[],cats:[],all_addr:[],pic_point:[],timePred:[],date_pred:[],clientAddr:[],comment:"",sdacha:"",orderDate:"",orderTime:"",typeOrder:0},n}return(0,s.Z)(r,[{key:"componentWillUnmount",value:function(){this._isMounted=!1,clearInterval(this.interval)}},{key:"checkLogin",value:function(){var e=this;fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ze.stringify({type:"check_login_center",token:q.getToken()})}).then((function(e){return e.json()})).then((function(t){!0===t||(localStorage.removeItem("token"),clearInterval(e.interval),setTimeout((function(){window.location.href="/auth"}),500))})).catch((function(e){}))}},{key:"getAddr",value:function(){var e=this;fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ze.stringify({type:"get_user_addrs",city_id:q.getCity(),login:this.state.clientNumber})}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({clientAddr:t})}))}},{key:"changeData",value:function(e,t){var r=t.target.value;this.setState((0,u.Z)({},e,r)),this.saveData()}},{key:"saveData",value:function(){var e=this,t=q.getCartData();setTimeout((function(){var r={orderType:0==parseInt(e.state.activeTab)||1==parseInt(e.state.activeTab)?parseInt(e.state.activeTab):0,orderAddr:t&&t.orderAddr?t.orderAddr:"",orderPic:t&&t.orderPic?t.orderPic:"0",orderComment:e.state.comment,orderTimes:t&&t.orderTimes?t.orderTimes:"0",orderPredDay:t&&t.orderPredDay?t.orderPredDay:"",orderPredTime:t&&t.orderPredTime?t.orderPredTime:"",orderPay:t&&t.orderPay?t.orderPay:"0",orderSdacha:e.state.sdacha};console.log("new type order",r),console.log("saveCartData CreateOrder"),q.saveCartData(r)}),100)}},{key:"startOrderNext",value:function(){var e=this;if(0==this.clickOrderStart){this.clickOrderStart=!0,clearTimeout(this.startOrderIntervalTimer);var t=q.getCartData();console.log("startOrder",t),this.setState({spiner:!0});var r=[];q.getItems().forEach((function(e){e.count>0&&r.push({name:e.name,count:e.count,price:e.all_price,id:e.item_id})})),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ze.stringify({type:"createOrder",typeCreate:"center",city_id:q.getCity(),user_id:q.getToken(),timePred:JSON.stringify({value:0==parseInt(t.orderTimes)?0:t.orderPredDay+" "+t.orderPredTime}),typeOrder:t.orderType,addrPic:t.orderPic,comment:t.orderComment,sdacha:t.orderSdacha,addrDev:t.orderAddr?JSON.stringify(t.orderAddr):"",payFull:JSON.stringify({type:"cash"}),cart:JSON.stringify(r),promo_name:localStorage.getItem("promo_name"),number:q.clientNumber})}).then((function(e){return e.json()})).then((function(r){if(console.log("start",r),setTimeout((function(){e.setState({spiner:!1}),e.clickOrderStart=!1}),500),r.st){if(localStorage.getItem("promo_name")&&localStorage.getItem("promo_name").length>0){var n=localStorage.getItem("promo_name"),a=q.getMyPromos();a.push({date:C()(new Date).format("YYYY-MM-DD"),promo:n}),q.setMyPromos(a)}e.setState({newOrder:{cart:r.my_cart,order_id:r.order_id,point_id:r.point_id,point_name:r.point_name,time_wait:r.time_wait_order,typeOrder:0==parseInt(t.orderType)?"Доставка":"Самовывоз",number:q.clientNumber,comment:0==parseInt(t.orderType)?t.orderComment:"",sdacha:0==parseInt(t.orderType)?t.orderSdacha:"",timePred:0==parseInt(t.orderTimes)?"":t.orderPredDay+" "+t.orderPredTime,addr:0==parseInt(t.orderType)?t.orderAddr:{},promoName:localStorage.getItem("promo_name")}}),setTimeout((function(){e.setState({orderCheck:!0})}),500),e.startOrderIntervalTimer=setTimeout((function(){e.setState({orderCheck:!1,newOrderData:null})}),1e3*e.startOrderInterval)}else e.setState({error:{title:"Предупреждение",text:r.text_err},errorOpen:!0})}))}}},{key:"trueOrder",value:function(){var e=this;fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ze.stringify({type:"trueOrder",city_id:q.getCity(),order_id:this.state.newOrder.order_id,point_id:this.state.newOrder.point_id})}).then((function(e){return e.json()})).then((function(t){0==t.st?e.setState({error:{title:"При подтверждении оплаты произошла ошибка",text:t.text_err},errorOpen:!0}):(e.setState({error:{title:"Подтверждение заказа",text:"Заказ успешно оформлен"},errorOpen:!0,orderCheck:!1,newOrderData:null}),q.clear=!0,clearTimeout(e.startOrderIntervalTimer))}))}},{key:"render",value:function(){var e,t=this;return n.createElement(w.Z,{container:!0,spacing:0,style:{width:"100vw",height:"100vh"}},n.createElement(T.q,null,n.createElement("title",null,"Оформление заказа")),n.createElement(Q.Z,{open:this.state.spiner,style:{zIndex:99,color:"#fff"}},n.createElement(X.Z,{color:"inherit"})),n.createElement(w.Z,{item:!0,xs:8,style:{paddingRight:16}},this.state.cityList.length>0?n.createElement(ge,{classes:this.state.classes,cityList:this.state.cityList,page:"createOrder"}):null),n.createElement(w.Z,{item:!0,xs:8,style:{padding:"24px 8px 0px 16px"}},n.createElement(be,{classes:this.state.classes})),n.createElement(w.Z,{item:!0,xs:4,style:{padding:"16px",marginTop:-50},className:"container"},n.createElement(x.Z,{value:this.state.activeTab,onChange:this.changeTab.bind(this),indicatorColor:"primary",textColor:"primary",centered:!0,style:{width:"100%",marginBottom:10}},n.createElement(S.Z,{label:"Доставка"}),n.createElement(S.Z,{label:"Самовывоз"}),n.createElement(S.Z,{label:"Адрес клиента"})),0==this.state.activeTab?this.state.all_addr.length>0?n.createElement(ke,{classes:this.state.classes,all_addr:this.state.all_addr}):null:1==this.state.activeTab?this.state.pic_point.length>0?n.createElement(xe,{classes:this.state.classes,pic_point:this.state.pic_point}):null:this.state.clientAddr.length>0?n.createElement(Pe,{classes:this.state.classes,clientAddr:this.state.clientAddr}):null,(0==this.state.activeTab||2==this.state.activeTab)&&this.state.all_addr.length>0?n.createElement(w.Z,{container:!0,spacing:3,style:{marginTop:12}},n.createElement("div",{className:"addrComment"},n.createElement(R.Z,(e={label:"Комментарий курьеру",variant:"outlined",multiline:!0,rowsMax:2},(0,u.Z)(e,"variant","outlined"),(0,u.Z)(e,"value",this.state.comment),(0,u.Z)(e,"onChange",this.changeData.bind(this,"comment")),e)),n.createElement(R.Z,{label:"Сдача",variant:"outlined",value:this.state.sdacha,onChange:this.changeData.bind(this,"sdacha")}))):null,this.state.date_pred.length>0?n.createElement(Se,{classes:this.state.classes,date_pred:this.state.date_pred}):null,n.createElement(w.Z,{container:!0,spacing:3,className:"container"},n.createElement("form",{className:"blockTotalOrder",noValidate:!0,autoComplete:"off",style:{width:"100%",marginRight:8,marginTop:3}},n.createElement("div",{style:{display:"flex",flexDirection:"column"}},n.createElement(k.Z,{variant:"h6",component:"span",style:{fontSize:"0.8rem",color:"#bababa"}},"Доставка: ",this.state.sumDiv," р"),n.createElement(k.Z,{variant:"h6",component:"span"},"К оплате: ",parseInt(this.state.AllPrice)+parseInt(this.state.sumDiv)," р")),n.createElement(v.Z,{variant:"contained",color:"primary",onClick:this.startOrderNext.bind(this)},"Оформить заказ")))),n.createElement(w.Z,{item:!0,xs:12,style:{padding:"16px 0px 0px 0px"}},this.state.cats.length>0&&this.state.allItems.length>0?n.createElement(Te,{classes:this.state.classes,cats:this.state.cats,allItems:this.state.allItems}):null),n.createElement(ie.Z,{open:this.state.errorOpen,onClose:function(){return t.setState({errorOpen:!1})},className:"DialogErr"},n.createElement(k.Z,{variant:"h5",component:"span",className:"orderCheckTitle"},this.state.error.title),n.createElement(G.Z,{className:"closeDialog",color:"inherit",onClick:function(){return t.setState({errorOpen:!1})}}),n.createElement(se.Z,null,n.createElement(le.Z,{className:"DialogErrText"},this.state.error.text)),n.createElement(oe.Z,null,n.createElement(B.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorder",onClick:function(){return t.setState({errorOpen:!1})}},n.createElement(v.Z,{variant:"contained",className:"BtnCardMain CardInCardItem"},"Хорошо")))),!0===this.state.orderCheck?n.createElement(ie.Z,{open:this.state.orderCheck,fullWidth:!0,onClose:function(){return t.setState({orderCheck:!1})},className:"DialogOrderCheckDialog"},n.createElement(k.Z,{variant:"h5",component:"span",className:"orderCheckTitle"}," ",this.state.newOrder.typeOrder," #",this.state.newOrder.order_id," на ",this.state.newOrder.point_name),n.createElement(G.Z,{className:"closeDialog",color:"inherit",onClick:function(){return t.setState({orderCheck:!1})}}),n.createElement(se.Z,{style:{display:"flex",flexDirection:"column"}},""!==this.state.newOrder.timePred?n.createElement(k.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Время предзаказа: ",this.state.newOrder.timePred):n.createElement(k.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Время ожидания: ",this.state.newOrder.time_wait),"Доставка"==this.state.newOrder.typeOrder?n.createElement(k.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Доставка: ",this.state.newOrder.addr?this.state.newOrder.addr.street+" "+this.state.newOrder.addr.home+(0==parseInt(this.state.newOrder.addr.pd)?"":", Пд. "+this.state.newOrder.addr.pd)+(0==parseInt(this.state.newOrder.addr.et)?"":", Эт. "+this.state.newOrder.addr.et)+(0==parseInt(this.state.newOrder.addr.kv)?"":", Кв. "+this.state.newOrder.addr.kv):null):n.createElement(k.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Самовывоз: ",this.state.newOrder.point_name),"Доставка"==this.state.newOrder.typeOrder&&this.state.newOrder.addr&&1==parseInt(this.state.newOrder.addr.dom_true)?n.createElement(k.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Домофон не работает"):null,n.createElement(k.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Номер телефона: ",this.state.newOrder.number),this.state.newOrder.promoName?n.createElement(k.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Промокод: ",this.state.newOrder.promoName):null,"Доставка"==this.state.newOrder.typeOrder&&this.state.newOrder.comment.length>0?n.createElement(k.Z,{variant:"h5",component:"span",className:"nameSdacha orderCheckText"},"Комментарий: ",this.state.newOrder.comment):null,"Доставка"==this.state.newOrder.typeOrder&&this.state.newOrder.sdacha.length>0?n.createElement(k.Z,{variant:"h5",component:"span",className:"nameSdacha orderCheckText"},"Сдача с: ",this.state.newOrder.sdacha,"р"):null,n.createElement("table",{className:"tableOrderCheck"},n.createElement("tbody",null,this.state.newOrder.cart.map((function(e,t){return parseInt(e.count)>0?n.createElement("tr",{key:t},n.createElement("td",{style:{width:"60%"}},n.createElement(k.Z,{variant:"h5",component:"span",className:"orderCheckText"},e.name)),n.createElement("td",null,n.createElement(k.Z,{variant:"h5",component:"span",className:"orderCheckText"},e.count)),n.createElement("td",null,n.createElement(k.Z,{variant:"h5",component:"span",className:"namePrice orderCheckText"},e.new_full_price?e.new_full_price:e.full_price," р"))):null})),"Доставка"==this.state.newOrder.typeOrder?n.createElement("tr",null,n.createElement("td",{style:{width:"60%"}},n.createElement(k.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Доставка")),n.createElement("td",null,n.createElement(k.Z,{variant:"h5",component:"span",className:"orderCheckText"},"1")),n.createElement("td",null,n.createElement(k.Z,{variant:"h5",component:"span",className:"namePrice orderCheckText"},q.getSumDiv()," р"))):null),n.createElement("tfoot",null,n.createElement("tr",null,n.createElement("td",{colSpan:"2"},n.createElement(k.Z,{variant:"h5",component:"span",className:"orderCheckText bold"},"Сумма заказа")),n.createElement("td",null,n.createElement(k.Z,{variant:"h5",component:"span",className:"namePrice orderCheckText"},parseInt(q.getAllPrice())+parseInt(q.getSumDiv())," р")))))),n.createElement(oe.Z,{style:{padding:"12px 24px",paddingBottom:24}},n.createElement(B.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorder",style:{width:"100%"},onClick:this.trueOrder.bind(this)},n.createElement(v.Z,{variant:"contained",style:{width:"100%"},className:"BtnCardMain CardInCardItem"},"Подтвердить заказ")))):null)}}]),r}(n.Component);function De(){var e=Ee();return n.createElement("div",{className:e.root},n.createElement(Oe,{classes:e}))}var Ae=r(6083),Ne=r(553),Me=r(1846),je=r(7162),Re=r(8523),Be=r(9300),Le=r(7827),We=r(8736),Je=["children","value","index"];var ze=r(7563),He=(0,y.Z)((function(e){return{root2:{display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"center","& > svg, form":{borderRight:"0px!important"}},root3:{"& > *":{margin:e.spacing(1),width:50},"& .MuiOutlinedInput-input":{padding:"5px 10px"}},list:{width:250},fullList:{width:"auto"},root:{flexGrow:1},title:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary},paperCat:{padding:e.spacing(1),textAlign:"center",color:e.palette.text.secondary,position:"relative",justifyContent:"space-between",height:"calc(100% - 15px)",cursor:"pointer"},paperCatInfo:{position:"absolute",top:0,right:0},size1:{fontSize:"0.8rem"},scrollTable:{maxHeight:250,overflow:"auto",padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}}));function Ue(e){var t=e.children,r=e.value,a=e.index,i=(0,f.Z)(e,Je);return n.createElement("div",(0,h.Z)({role:"tabpanel",hidden:r!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},i),r===a&&n.createElement(A.Z,{p:3},t))}function Ye(e){var t=new Date(e),r=""+(t.getMonth()+1),n=""+t.getDate(),a=t.getFullYear();return r.length<2&&(r="0"+r),n.length<2&&(n="0"+n),[a,r,n].join("-")}Ue.propTypes={children:D().node,index:D().any.isRequired,value:D().any.isRequired};var Fe=function(e){(0,c.Z)(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,m.Z)(t);if(r){var a=(0,m.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,o.Z)(this,i),t=a.call(this,e),(0,u.Z)((0,l.Z)(t),"interval",null),(0,u.Z)((0,l.Z)(t),"componentDidMount",(function(){t.interval=setInterval((function(){return t.checkLogin()}),36e5),t.checkLogin(),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:ze.stringify({type:"get_cat_center",city_id:1})}).then((function(e){return e.json()})).then((function(e){t.setState({cityList:e.city_list}),q.setAllItems(e.all_items),t.getPoints()})).catch((function(e){}))})),(0,u.Z)((0,l.Z)(t),"changeCat",(function(e,r){var n=t.state.points.find((function(e,t){return t==r}));t.setState({activeCat:r,point:n}),t.getOrders()})),(0,u.Z)((0,l.Z)(t),"changeAddr",(function(e){t.setState({typeDel:e.target.value})})),t.state={classes:t.props.classes,cityList:[],spiner:!1,selectedCity:1,selectedDate:Ye(new Date),points:[],point:null,activeCat:0,orders:[],orderCheck:!1,showOrder:null,openDialog:!1,delOrder:!1,radiogroup_options:[{id:"0",label:"Решили отредактировать заказ",value:0},{id:"1",label:"Не устраивает время ожидания",value:0},{id:"2",label:"Изминились планы",value:0},{id:"3",label:"Недостаточно средств",value:0},{id:"4",label:"Другое",value:0}],textDel:"",typeDel:-1,number:""},t}return(0,s.Z)(i,[{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"checkLogin",value:function(){var e=this;fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:ze.stringify({type:"check_login_center",token:q.getToken()})}).then((function(e){return e.json()})).then((function(t){!0===t||(localStorage.removeItem("token"),clearInterval(e.interval),setTimeout((function(){window.location.href="/auth"}),500))})).catch((function(e){}))}},{key:"handleDateChange",value:function(e){var t=this;this.setState({selectedDate:Ye(e)}),setTimeout((function(){t.getOrders()}),500)}},{key:"changeCity",value:function(e){var t=this,r=e.target.value;this.setState({selectedCity:r}),setTimeout((function(){t.getPoints()}),500)}},{key:"getPoints",value:function(){var e=this;fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:ze.stringify({type:"get_points",city_id:this.state.selectedCity})}).then((function(e){return e.json()})).then((function(t){e.setState({points:t,point:t[0]}),setTimeout((function(){e.getOrders()}),500)})).catch((function(e){}))}},{key:"getOrders",value:function(){var e=this;setTimeout((function(){fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:ze.stringify({type:"get_orders",city_id:e.state.selectedCity,point_id:e.state.point.id,date:e.state.selectedDate})}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({orders:t.orders}),setTimeout((function(){e.changeNumber()}),100)})).catch((function(e){}))}),500)}},{key:"getOrder",value:function(e){var t=this;fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:ze.stringify({type:"get_order",point_id:this.state.point.id,order_id:e})}).then((function(e){return e.json()})).then((function(e){console.log(e),t.setState({showOrder:e,openDialog:!0})})).catch((function(e){}))}},{key:"closeDialog",value:function(){this.setState({openDialog:!1})}},{key:"closeOrder",value:function(e,t){this.setState({delOrder:!0})}},{key:"closeOrderTrue",value:function(){var e=this,t=this.state.radiogroup_options.find((function(t){return t.id==e.state.typeDel}));"4"==t.id&&(t.label=this.state.textDel),confirm("Отменить заказ #"+this.state.showOrder.order.order_id)&&fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:ze.stringify({type:"close_order_center",typeCreate:"center",user_id:q.getToken(),order_id:this.state.showOrder.order.order_id,point_id:this.state.showOrder.order.point_id,ans:t.label})}).then((function(e){return e.json()})).then((function(t){console.log(t),setTimeout((function(){t.st?(e.setState({delOrder:!1,openDialog:!1}),e.getOrders()):alert(t.text)}),300)}))}},{key:"repeatOrder",value:function(){var e=[],t=q.getAllItems(),r=null;localStorage.setItem("cityID",this.state.selectedCity),this.state.showOrder.order_items.map((function(n){if(r=t.find((function(e){return e.id==n.item_id}))){var a=parseInt(r.price),i=parseInt(n.count)*parseInt(r.price);e.push({name:n.name,item_id:n.item_id,count:n.count,one_price:a,all_price:i})}}));var n={orderType:parseInt(this.state.showOrder.order.type_order_)-1,orderAddr:this.state.showOrder.street.name,orderPic:parseInt(this.state.showOrder.order.point_id),orderComment:"",orderTimes:"1",orderPredDay:"",orderPredTime:"",orderPay:1==parseInt(this.state.showOrder.order.type_order_)?"cash":"in",orderSdacha:""};q.saveCartData(n),this.state.showOrder.order.promo_name&&""!=this.state.showOrder.order.promo_name&&q.setPromo(this.state.showOrder.promo_info,this.state.showOrder.order.promo_name),q.setItems(e),setTimeout((function(){window.location.pathname="/"}),500)}},{key:"changeText",value:function(e){this.setState({textDel:e.target.value})}},{key:"changeNumber",value:function(){var e=document.querySelectorAll(".order"),t=this.state.number;0==t.length?e.forEach((function(e){e.classList.remove("dis_none")})):e.forEach((function(e){e.getAttribute("datanumber").indexOf(t)>=0?e.classList.remove("dis_none"):e.classList.add("dis_none")}))}},{key:"render",value:function(){var e=this;return n.createElement(w.Z,{container:!0,spacing:0},n.createElement(T.q,null,n.createElement("title",null,"Оформленные заказы")),n.createElement(Q.Z,{open:this.state.spiner,style:{zIndex:99,color:"#fff"}},n.createElement(X.Z,{color:"inherit"})),n.createElement(w.Z,{item:!0,xs:12},this.state.cityList.length>0?n.createElement(ge,{classes:this.state.classes,cityList:this.state.cityList,page:"statOrder"}):null),n.createElement(w.Z,{item:!0,xs:4},n.createElement(Le.M,{utils:Be.Z,locale:Re.Z},n.createElement(w.Z,{container:!0,justify:"space-around",style:{alignItems:"baseline"}},n.createElement(J.Z,{className:this.state.classes.formControl},n.createElement(L.Z,null,"Город"),n.createElement(z.Z,{value:this.state.selectedCity,onChange:this.changeCity.bind(this)},this.state.cityList.map((function(e,t){return n.createElement(W.Z,{key:t,value:e.id},e.name)})))),n.createElement(We.e,{disableToolbar:!0,variant:"inline",format:"yyyy-MM-dd",margin:"normal",id:"date-picker-inline",label:"Дата",value:this.state.selectedDate,onChange:this.handleDateChange.bind(this),KeyboardButtonProps:{"aria-label":"change date"}})))),n.createElement(w.Z,{item:!0,xs:3},n.createElement(R.Z,{label:"Номер телефона",style:{margin:"16px 8px 8px 8px",flex:1},value:this.state.number,onChange:function(t){return e.setState({number:t.target.value})},onBlur:this.changeNumber.bind(this)})),n.createElement(w.Z,{item:!0,xs:12},n.createElement(b.Z,{position:"static"},n.createElement(x.Z,{value:this.state.activeCat,onChange:this.changeCat,"aria-label":"simple tabs example"},this.state.points.map((function(e,t){return n.createElement(S.Z,(0,h.Z)({label:e.addr,style:{minWidth:"auto"},key:t},{id:"simple-tab-".concat(r=t),"aria-controls":"simple-tabpanel-".concat(r)}));var r})))),this.state.points.map((function(t,r){return n.createElement(Ue,{value:e.state.activeCat,index:r,key:r},n.createElement(re.Z,null,n.createElement($.Z,null,n.createElement(ne.Z,null,n.createElement(ae.Z,null,n.createElement(te.Z,null,"#"),n.createElement(te.Z,null,"Оформил"),n.createElement(te.Z,null,"Телефон"),n.createElement(te.Z,null,"Адрес"),n.createElement(te.Z,null,"Оформлен"),n.createElement(te.Z,null,"Ко времени"),n.createElement(te.Z,null,"Закрыт на кухне"),n.createElement(te.Z,null,"Получен клиентом"),n.createElement(te.Z,null,"Тип"),n.createElement(te.Z,null,"Статус"),n.createElement(te.Z,null,"Сумма"),n.createElement(te.Z,null,"Оплата"),n.createElement(te.Z,null,"Курьер"))),n.createElement(ee.Z,null,e.state.orders.map((function(t,r){return n.createElement(ae.Z,{key:r,className:"order",id:t.id,datanumber:t.number,style:1==t.is_delete?{backgroundColor:"red",color:"#fff"}:{}},n.createElement(te.Z,{style:{color:"inherit",cursor:"pointer"},onClick:e.getOrder.bind(e,t.id)},t.id),n.createElement(te.Z,{style:{color:"inherit"}},t.type_user),n.createElement(te.Z,{style:{color:"inherit"}},t.number),n.createElement(te.Z,{style:{color:"inherit"}},t.street," ",t.home),n.createElement(te.Z,{style:{color:"inherit"}},t.date_time_order),n.createElement(te.Z,{style:{color:"inherit"}},"00:00:00"==t.date_time_preorder?"":t.date_time_preorder),n.createElement(te.Z,{style:{color:"inherit"}},"00:00:00"==t.give_data_time?"":t.give_data_time),n.createElement(te.Z,{style:{color:"inherit"}},t.close_order),n.createElement(te.Z,{style:{color:"inherit"}},t.type_order),n.createElement(te.Z,{style:{color:"inherit"}},t.status),n.createElement(te.Z,{style:{color:"inherit"}},t.order_price),n.createElement(te.Z,{style:{color:"inherit"}},t.type_pay),n.createElement(te.Z,{style:{color:"inherit"}},t.driver))}))))))}))),this.state.showOrder?n.createElement(ie.Z,{onClose:this.closeDialog.bind(this),"aria-labelledby":"customized-dialog-title",className:"showOrderDialog",open:this.state.openDialog,fullWidth:!0},n.createElement(Ae.Z,{disableTypography:!0,style:{margin:0,padding:8}},n.createElement(k.Z,{variant:"h6"},"Заказ ",this.state.showOrder.order.order_id),n.createElement(pe.Z,{"aria-label":"close",style:{position:"absolute",top:0,right:0,color:"#000"},onClick:this.closeDialog.bind(this)},n.createElement(G.Z,null))),n.createElement(se.Z,{className:"showOrderDialogContent"},n.createElement(k.Z,{variant:"h6",component:"span"},this.state.showOrder.order.type_order,": ",this.state.showOrder.order.type_order_addr_new),n.createElement(k.Z,{variant:"h6",component:"span"},this.state.showOrder.order.time_order_name,": ",this.state.showOrder.order.time_order),this.state.showOrder.order.number.length>1?n.createElement(k.Z,{variant:"h6",component:"span"},"Телефон: ",this.state.showOrder.order.number):null,this.state.showOrder.order.delete_reason.length>0?n.createElement(k.Z,{variant:"h6",component:"span",style:{color:"red"}},"Удален: ",this.state.showOrder.order.date_time_delete):null,this.state.showOrder.order.delete_reason.length>0?n.createElement(k.Z,{variant:"h6",component:"span",style:{color:"red"}},this.state.showOrder.order.delete_reason):null,1==parseInt(this.state.showOrder.order.is_preorder)?null:n.createElement(k.Z,{variant:"h6",component:"span"},this.state.showOrder.order.text_time,this.state.showOrder.order.time_to_client),null==this.state.showOrder.order.promo_name||0==this.state.showOrder.order.promo_name.length?null:n.createElement(k.Z,{variant:"h6",component:"span"},"Промокод: ",this.state.showOrder.order.promo_name),null==this.state.showOrder.order.comment||0==this.state.showOrder.order.comment.length?null:n.createElement(k.Z,{variant:"h6",component:"span"},"Комментарий: ",this.state.showOrder.order.comment),null==this.state.showOrder.order.promo_name||0==this.state.showOrder.order.promo_name.length?null:n.createElement(k.Z,{variant:"h6",component:"span",className:"noSpace"},this.state.showOrder.order.promo_text),n.createElement(k.Z,{variant:"h5",component:"span",className:"CardPriceItem"},"Сумма закза: ",this.state.showOrder.order.sum_order," р"),n.createElement("table",{className:"tableOrderCheck"},n.createElement("tbody",null,this.state.showOrder.order_items.map((function(e,t){return n.createElement("tr",{key:t},n.createElement("td",null,n.createElement(k.Z,{variant:"h5",component:"span"},e.name)),n.createElement("td",null,n.createElement(k.Z,{variant:"h5",component:"span"},e.count)))}))))),0==parseInt(this.state.showOrder.order.is_delete)&&6!==parseInt(this.state.showOrder.order.status_order)?n.createElement(oe.Z,{style:{justifyContent:"flex-end",padding:"15px 0px"}},n.createElement(B.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorderOther",style:{marginRight:24}},n.createElement(v.Z,{variant:"contained",className:"BtnCardMain CardInCardItem",onClick:this.closeOrder.bind(this,this.state.showOrder.order.order_id,this.state.showOrder.order.point_id)},"Отменить заказ"))):null,1==parseInt(this.state.showOrder.order.is_delete)||6==parseInt(this.state.showOrder.order.status_order)?n.createElement(oe.Z,{style:{justifyContent:"flex-end",padding:"15px 0px"}},n.createElement(B.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorderOther",style:{marginRight:24}},n.createElement(v.Z,{variant:"contained",className:"BtnCardMain CardInCardItem",onClick:this.repeatOrder.bind(this,this.state.showOrder.order.order_id,this.state.showOrder.order.point_id)},"Повторить заказ"))):null):null,this.state.showOrder?n.createElement(ie.Z,{open:this.state.delOrder,onClose:function(){e.setState({delOrder:!1})},"aria-labelledby":"form-dialog-title"},n.createElement(Ae.Z,{disableTypography:!0,style:{margin:0,padding:8}},n.createElement(k.Z,{variant:"h6"},"Отмена заказа ",this.state.showOrder.order.order_id),n.createElement(pe.Z,{"aria-label":"close",style:{position:"absolute",top:0,right:0,color:"#000"},onClick:this.closeDialog.bind(this)},n.createElement(G.Z,null))),n.createElement(se.Z,null,n.createElement(J.Z,{component:"fieldset"},n.createElement(je.Z,{name:"typeDel",value:this.state.typeDel,onChange:this.changeAddr},this.state.radiogroup_options.map((function(e,t){return n.createElement(Ne.Z,{key:t,value:e.id,control:n.createElement(Me.Z,null),label:e.label})})))),n.createElement(R.Z,{onFocus:function(){e.setState({typeDel:"4"})},value:this.state.textDel,onChange:this.changeText.bind(this),margin:"dense",id:"name",label:"Причина отмены",type:"text",fullWidth:!0})),n.createElement(oe.Z,{style:{paddingBottom:24}},n.createElement(B.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorderOther",style:{marginRight:24}},n.createElement(v.Z,{variant:"contained",className:"BtnCardMain CardInCardItem",onClick:function(){e.setState({delOrder:!1})}},"К заказу")),n.createElement(B.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorderOther",style:{marginRight:24}},n.createElement(v.Z,{variant:"contained",className:"BtnCardMain CardInCardItem",onClick:this.closeOrderTrue.bind(this)},"Отменить заказ")))):null)}}]),i}(n.Component);function qe(){var e=He();return n.createElement("div",{className:e.root},n.createElement(Fe,{classes:e}))}var Ke=r(5685);var Ge=r(7563),Ve=(0,y.Z)((function(e){return{root2:{display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"center","& > svg, form":{borderRight:"0px!important"}},root3:{"& > *":{margin:e.spacing(1),width:50},"& .MuiOutlinedInput-input":{padding:"5px 10px"}},list:{width:250},fullList:{width:"auto"},root:{flexGrow:1},title:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary},paperCat:{padding:e.spacing(1),textAlign:"center",color:e.palette.text.secondary,position:"relative",justifyContent:"space-between",height:"calc(100% - 15px)",cursor:"pointer"},paperCatInfo:{position:"absolute",top:0,right:0},size1:{fontSize:"0.8rem"},scrollTable:{maxHeight:250,overflow:"auto",padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}}));D().node,D().any.isRequired,D().any.isRequired;var Qe=function(e){(0,c.Z)(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,m.Z)(t);if(r){var a=(0,m.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t,r,n,s,c,d;return(0,o.Z)(this,i),t=a.call(this,e),(0,u.Z)((0,l.Z)(t),"interval",null),(0,u.Z)((0,l.Z)(t),"componentDidMount",(function(){t.setState({spiner:!0}),t.interval=setInterval((function(){return t.checkLogin()}),36e5),t.checkLogin(),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ge.stringify({type:"get_cat_center",city_id:1})}).then((function(e){return e.json()})).then((function(e){t.setState({cityList:e.city_list})})).catch((function(e){})),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ge.stringify({type:"get_points",city_id:1})}).then((function(e){return e.json()})).then((function(e){console.log(e),t.setState({points:e,point:e[0]}),setTimeout((function(){t.getCookOrders()}),500)})).catch((function(e){}))})),t.state={classes:t.props.classes,cityList:[],spiner:!1,data:[],selectedPoint:1,selectedDate:(r=new Date,n=new Date(r),s=""+(n.getMonth()+1),c=""+n.getDate(),d=n.getFullYear(),s.length<2&&(s="0"+s),c.length<2&&(c="0"+c),[d,s,c].join("-")),points:[],point:null,activeCat:0,orders:[],orderCheck:!1,showOrder:null,openDialog:!1,delOrder:!1,radiogroup_options:[{id:"0",label:"Решили отредактировать заказ",value:0},{id:"1",label:"Не устраивает время ожидания",value:0},{id:"2",label:"Изминились планы",value:0},{id:"3",label:"Недостаточно средств",value:0},{id:"4",label:"Другое",value:0}],textDel:"",typeDel:-1},t}return(0,s.Z)(i,[{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"checkLogin",value:function(){var e=this;fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ge.stringify({type:"check_login_center",token:q.getToken()})}).then((function(e){return e.json()})).then((function(t){!0===t||(localStorage.removeItem("token"),clearInterval(e.interval),setTimeout((function(){window.location.href="/auth"}),500))})).catch((function(e){}))}},{key:"changePoint",value:function(e){var t=this,r=e.target.value;this.setState({selectedPoint:r}),setTimeout((function(){t.getCookOrders()}),500)}},{key:"getCookOrders",value:function(){var e=this;this.setState({spiner:!0}),fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ge.stringify({type:"getCookOrders",point_id:this.state.selectedPoint})}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({data:t}),setTimeout((function(){e.setState({spiner:!1})}),500)})).catch((function(e){}))}},{key:"render",value:function(){return n.createElement(w.Z,{container:!0,spacing:0},n.createElement(T.q,null,n.createElement("title",null,"Заказы на кухне")),n.createElement(Q.Z,{open:this.state.spiner,style:{zIndex:99,color:"#fff"}},n.createElement(X.Z,{color:"inherit"})),n.createElement(w.Z,{item:!0,xs:12},this.state.cityList.length>0?n.createElement(ge,{classes:this.state.classes,cityList:this.state.cityList,page:"OrderCook"}):null),n.createElement(w.Z,{item:!0,xs:12,style:{display:"flex",alignItems:"center",justifyContent:"center"}},n.createElement(J.Z,{className:this.state.classes.formControl},n.createElement(L.Z,null,"Точка"),n.createElement(z.Z,{value:this.state.selectedPoint,onChange:this.changePoint.bind(this)},this.state.points.map((function(e,t){return n.createElement(W.Z,{key:t,value:e.id},e.addr)})))),n.createElement(v.Z,{variant:"contained",color:"primary",className:"btnClear",style:{padding:"2px 6px",minWidth:30},onClick:this.getCookOrders.bind(this)},n.createElement(Ke.Z,null))),n.createElement(w.Z,{item:!0,xs:12},n.createElement(re.Z,null,n.createElement($.Z,null,n.createElement(ne.Z,null,n.createElement(ae.Z,null,n.createElement(te.Z,null,"#"),n.createElement(te.Z,null,"Тип"),n.createElement(te.Z,null,"Статус"),n.createElement(te.Z,null,"Время заказа / предзаказа"),n.createElement(te.Z,null,"Время выхода на стол"),n.createElement(te.Z,null,"Во сколько собрали"),n.createElement(te.Z,null,"Закрыли"),n.createElement(te.Z,null,"Приготовили"),n.createElement(te.Z,null,"Отдали"),n.createElement(te.Z,null,"Обещали"))),n.createElement(ee.Z,null,this.state.data.ready?this.state.data.ready.map((function(e,t){return n.createElement(ae.Z,{key:t,style:{backgroundColor:"green"}},n.createElement(te.Z,{style:{color:"inherit"}},e.id),n.createElement(te.Z,{style:{color:"inherit"}},e.type_order),n.createElement(te.Z,{style:{color:"inherit"}},e.status),n.createElement(te.Z,{style:{color:"inherit"}},1==parseInt(e.preorder)?e.date_time_preorder_:e.date_time_order),n.createElement(te.Z,{style:{color:"inherit"}},e.unix_start_stol_or),n.createElement(te.Z,{style:{color:"inherit"}},e.give_data_time_),n.createElement(te.Z,{style:{color:"inherit"}},e.close_date_time_order),n.createElement(te.Z,{style:{color:"inherit"}},e.time_),n.createElement(te.Z,{style:{color:"inherit"}},e.test_time),n.createElement(te.Z,{style:{color:"inherit"}},0==parseInt(e.preorder)?e.unix_time_to_client:""))})):null,this.state.data.onstol?this.state.data.onstol.map((function(e,t){return n.createElement(ae.Z,{key:t,style:{backgroundColor:"yellow"}},n.createElement(te.Z,{style:{color:"inherit"}},e.id),n.createElement(te.Z,{style:{color:"inherit"}},e.type_order),n.createElement(te.Z,{style:{color:"inherit"}},e.status),n.createElement(te.Z,{style:{color:"inherit"}},1==parseInt(e.preorder)?e.date_time_preorder_:e.date_time_order),n.createElement(te.Z,{style:{color:"inherit"}},e.unix_start_stol_or),n.createElement(te.Z,{style:{color:"inherit"}},e.give_data_time_),n.createElement(te.Z,{style:{color:"inherit"}},e.close_date_time_order),n.createElement(te.Z,{style:{color:"inherit"}},e.time_),n.createElement(te.Z,{style:{color:"inherit"}},e.test_time),n.createElement(te.Z,{style:{color:"inherit"}},0==parseInt(e.preorder)?e.unix_time_to_client:""))})):null,this.state.data.prestol_new?this.state.data.prestol_new.map((function(e,t){return n.createElement(ae.Z,{key:t},n.createElement(te.Z,{style:{color:"inherit"}},e.id),n.createElement(te.Z,{style:{color:"inherit"}},e.type_order),n.createElement(te.Z,{style:{color:"inherit"}},e.status),n.createElement(te.Z,{style:{color:"inherit"}},1==parseInt(e.preorder)?e.date_time_preorder:e.date_time_order),n.createElement(te.Z,{style:{color:"inherit"}},e.time_start_order),n.createElement(te.Z,{style:{color:"inherit"}},e.give_data_time_),n.createElement(te.Z,{style:{color:"inherit"}},e.close_date_time_order),n.createElement(te.Z,{style:{color:"inherit"}},e.time_),n.createElement(te.Z,{style:{color:"inherit"}},e.test_time),n.createElement(te.Z,{style:{color:"inherit"}},0==parseInt(e.preorder)?e.unix_time_to_client:""))})):null)))))}}]),i}(n.Component);function Xe(){var e=Ve();return n.createElement("div",{className:e.root},n.createElement(Qe,{classes:e}))}var $e=r(8799);var et=r(7563),tt=function(e){(0,c.Z)(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,m.Z)(t);if(r){var a=(0,m.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,o.Z)(this,i),t=a.call(this,e),(0,u.Z)((0,l.Z)(t),"componentDidMount",(function(){})),t.state={number:"",pass:""},t}return(0,s.Z)(i,[{key:"login",value:function(){fetch("https://jacofood.ru/src/php/test_app.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:et.stringify({type:"login_center",number:this.state.number,pass:this.state.pass})}).then((function(e){return e.json()})).then((function(e){e.st?(q.setToken(e.token,e.name),setTimeout((function(){window.location.href="/"}),500)):alert(e.text)}))}},{key:"handleKeyPress",value:function(e){13==e.charCode&&this.state.number.length>0&&this.state.pass.length>0&&this.login()}},{key:"render",value:function(){var e=this;return n.createElement(w.Z,{container:!0,direction:"column",justify:"center",alignItems:"center",style:{height:"100vh"}},n.createElement(w.Z,{container:!0,item:!0,xs:3},n.createElement("img",{alt:"Жако доставка роллов и пиццы",src:"../assets/logo.png",style:{height:"auto",width:"inherit"}})),n.createElement(w.Z,{container:!0,item:!0,xs:3,direction:"column"},n.createElement(J.Z,null,n.createElement(L.Z,{htmlFor:"my-input"},"Номер телефона"),n.createElement($e.Z,{id:"my-input",type:"login","aria-describedby":"my-helper-text",value:this.state.number,onChange:function(t){e.setState({number:t.target.value})},onKeyPress:this.handleKeyPress})),n.createElement(J.Z,null,n.createElement(L.Z,{htmlFor:"my-input2"},"Пароль"),n.createElement($e.Z,{id:"my-input2",type:"password","aria-describedby":"my-helper-text",value:this.state.pass,onChange:function(t){e.setState({pass:t.target.value})},onKeyPress:this.handleKeyPress})),n.createElement(J.Z,{style:{paddingTop:8}},n.createElement(v.Z,{variant:"contained",style:{backgroundColor:"#CC0033",color:"#fff"},onClick:this.login.bind(this)},"Войти"))))}}]),i}(n.Component),rt=r(150);var nt={itemsStore:q};function at(e){var t=e.code,r=e.children;return n.createElement(p.AW,{render:function(e){var n=e.staticContext;return n&&(n.status=t),r}})}function it(){return n.createElement(at,{code:404},n.createElement(w.Z,{container:!0,className:"Contact mainContainer MuiGrid-spacing-xs-3",style:{marginTop:64}},n.createElement(w.Z,{item:!0,xs:12},n.createElement(k.Z,{variant:"h5",component:"h1"},"404 Страница не найдена"))))}var ot=function(e){(0,c.Z)(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,m.Z)(t);if(r){var a=(0,m.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,o.Z)(this,i),t=a.call(this,e),(0,u.Z)((0,l.Z)(t),"componentDidMount",(function(){})),t.state={},t}return(0,s.Z)(i,[{key:"render",value:function(){return n.createElement(rt.zt,nt,n.createElement(p.rs,null,n.createElement(p.AW,{path:"/",exact:!0,component:De}),n.createElement(p.AW,{path:"/orders",exact:!0,component:qe}),n.createElement(p.AW,{path:"/ordercook",exact:!0,component:Xe}),n.createElement(p.AW,{path:"/auth",exact:!0,component:tt}),n.createElement(p.AW,{component:it})))}}]),i}(n.Component);a.hydrate(n.createElement(i.VK,null,n.createElement(ot,null)),document.getElementById("app"))},8293:(e,t,r)=>{var n={"./ru":1793,"./ru.js":1793};function a(e){var t=i(e);return r(t)}function i(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=i,e.exports=a,a.id=8293}},r={};function n(e){var a=r[e];if(void 0!==a)return a.exports;var i=r[e]={id:e,loaded:!1,exports:{}};return t[e].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=t,e=[],n.O=(t,r,a,i)=>{if(!r){var o=1/0;for(c=0;c<e.length;c++){for(var[r,a,i]=e[c],s=!0,l=0;l<r.length;l++)(!1&i||o>=i)&&Object.keys(n.O).every((e=>n.O[e](r[l])))?r.splice(l--,1):(s=!1,i<o&&(o=i));s&&(e.splice(c--,1),t=a())}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[r,a,i]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={179:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var a,i,[o,s,l]=r,c=0;for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(l)var d=l(n);for(t&&t(r);c<o.length;c++)i=o[c],n.o(e,i)&&e[i]&&e[i][0](),e[o[c]]=0;return n.O(d)},r=self.webpackChunkreact_ssr=self.webpackChunkreact_ssr||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var a=n.O(void 0,[736],(()=>n(5858)));a=n.O(a)})();
//# sourceMappingURL=main.js.map