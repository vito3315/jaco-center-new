(self.webpackChunkreact_ssr=self.webpackChunkreact_ssr||[]).push([[179],{5858:(e,t,r)=>{"use strict";var n=r(7294),a=r(3935),i=r(3727),o=r(6610),s=r(5991),l=r(3349),c=r(379),m=r(6070),d=r(7608),u=r(6156),p=r(5977),h=r(2122),f=r(1253),y=r(6010),g=r(1120),v=r(4670),_=r(282),Z=r(2822),E=r(998),I=r(5757),T=r(381),b=r.n(T),w=r(4593),x=r(1749),C=r(5258),S=r(2318),k=r(9895),P=r(65),O=r(1423),D=r(5697),A=r.n(D),N=r(7748),M=r(868),R=r(8362),j=r(5431),B=r(8286),L=r(4837),z=r(3700),J=r(5639),W=r(4436),H=r(3200),Y=r(7329),F=r(8949),U=r(8),q=r.n(U),K=r(8811),G=r.n(K),V=r(7563);(0,F.jQ)({enforceActions:"never",useProxies:"ifavailable"});var Q=new(function(){function e(){var t=this;if((0,o.Z)(this,e),(0,u.Z)(this,"items",""),(0,u.Z)(this,"itemsPromo",""),(0,u.Z)(this,"promoName",""),(0,u.Z)(this,"allItems",""),(0,u.Z)(this,"allItemsCat",""),(0,u.Z)(this,"banners",""),(0,u.Z)(this,"AllPrice",0),(0,u.Z)(this,"sum_div",0),(0,u.Z)(this,"cityName",0),(0,u.Z)(this,"cityNameRU",""),(0,u.Z)(this,"promo",null),(0,u.Z)(this,"userToken",null),(0,u.Z)(this,"userName",""),(0,u.Z)(this,"activePage",""),(0,u.Z)(this,"need_dops",""),(0,u.Z)(this,"free_items",""),(0,u.Z)(this,"cart_data",""),(0,u.Z)(this,"typeOrder",0),(0,u.Z)(this,"clientNumber",""),(0,u.Z)(this,"clear",!1),(0,u.Z)(this,"MyPromos",""),(0,u.Z)(this,"updateMyPromos",""),(0,u.Z)(this,"dateTimeDel",null),(0,u.Z)(this,"free_drive",0),(0,u.Z)(this,"setMyPromos",(function(e){t.MyPromos=JSON.stringify(e),t.updateMyPromos=new Date,localStorage.setItem("MyPromos",JSON.stringify(e))})),(0,u.Z)(this,"setSumDiv",(function(e){t.sum_div=parseInt(e)})),(0,u.Z)(this,"setDops",(function(e){t.need_dops=JSON.stringify(e)})),(0,u.Z)(this,"setFreeItems",(function(e){t.free_items=JSON.stringify(e)})),(0,u.Z)(this,"setCityRU",(function(e){t.cityNameRU=e})),(0,u.Z)(this,"setCity",(function(e){t.cityName=e})),(0,u.Z)(this,"setAllPrice",(function(e){t.AllPrice=e})),(0,u.Z)(this,"setPage",(function(e){t.activePage=e})),(0,u.Z)(this,"setToken",(function(e,r){t.userToken=e,t.setUserName(r),"undefined"!=typeof window&&localStorage.setItem("token",e)})),(0,u.Z)(this,"setPromo",(function(e,r){t.promo=e,localStorage.setItem("promo_name",r)})),(0,u.Z)(this,"setItemsPromo",(function(e){t.itemsPromo=JSON.stringify(e)})),(0,u.Z)(this,"setAllItemsCat",(function(e){t.allItemsCat=JSON.stringify(e)})),(0,u.Z)(this,"setItems",(function(e){var r=0,n=0,a=t.getItemsPromo();if(n=e.reduce((function(e,t){return e+parseInt(t.all_price)}),r),r=0,n+=a.reduce((function(e,t){return e+parseInt(t.all_price)}),r),t.setAllPrice(n),t.items=JSON.stringify(e),"undefined"!=typeof window){var i=e.filter((function(e){return e.count>0}));i=JSON.stringify(i),localStorage.setItem("my_cart",i)}})),(0,u.Z)(this,"saveCartData",(function(e){var r=JSON.stringify(e);t.cart_data=r,"undefined"!=typeof window&&localStorage.setItem("cartData",r)})),(0,u.Z)(this,"setAllItems",(function(e){t.allItems=JSON.stringify(e),t.checkCart()})),"undefined"!=typeof window){if(localStorage.getItem("my_cart")){var r=JSON.parse(localStorage.getItem("my_cart")),n=(this.getAllItems(),[]);r.forEach((function(e){n.push({name:e.name,item_id:e.item_id,count:e.count,one_price:parseInt(e.one_price),all_price:parseInt(e.one_price)*parseInt(e.count)})})),this.setItems(n)}localStorage.getItem("token")&&this.setToken(localStorage.getItem("token")),localStorage.getItem("cartData")&&(this.cartData=localStorage.getItem("cartData")),localStorage.getItem("promo_name")&&setTimeout((function(){t.getInfoPromo(localStorage.getItem("promo_name"))}),300),localStorage.getItem("MyPromos")&&localStorage.getItem("MyPromos").length>0&&this.setMyPromos(JSON.parse(localStorage.getItem("MyPromos"),!0))}(0,F.ky)(this)}return(0,s.Z)(e,[{key:"getMyPromos",value:function(){return 0==this.MyPromos.length?[]:JSON.parse(this.MyPromos,!0)}},{key:"getSumDiv",value:function(){return this.sum_div}},{key:"getDops",value:function(){return 0==this.need_dops.length?[]:JSON.parse(this.need_dops,!0)}},{key:"getFreeItems",value:function(){return 0==this.free_items.length?[]:JSON.parse(this.free_items,!0)}},{key:"getCityRU",value:function(){return this.cityNameRU&&this.cityNameRU.length>0?this.cityNameRU:"Город"}},{key:"getCity",value:function(){return this.cityName}},{key:"getAllPrice",value:function(){return this.AllPrice}},{key:"getPage",value:function(){return this.activePage}},{key:"getUserName",value:function(){return this.userName&&this.userName.length>0?this.userName:""}},{key:"setUserName",value:function(e){this.userName=e}},{key:"getToken",value:function(){return this.userToken}},{key:"getInfoPromo",value:function(e){fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:V.stringify({type:"get_promo",city_id:Q.getCity(),promo_name:e})}).then((function(e){return e.json()})).then((function(t){console.log(t),Q.setPromo(JSON.stringify(t),e),!1===Q.checkPromo().st&&localStorage.removeItem("promo_name")}))}},{key:"getPromo",value:function(){return JSON.parse(this.promo,!0)}},{key:"checkPromo",value:function(){var e=Q.getCartData();Q.setItemsPromo([]);var t=0,r=0,n=e.orderTimes&&1!=parseInt(e.orderTimes)?e.orderPredDay+" "+e.orderPredTime:0,a=this.getPromo(),i=this.getItems(),o=this.getAllItems(),s=[];i.forEach((function(e,t){s.push({name:e.name,item_id:e.item_id,count:e.count,one_price:e.one_price,all_price:parseInt(e.one_price)*parseInt(e.count)})})),i=s,this.setItems(i);var l=[];r=i.reduce((function(e,t){return e+parseInt(t.all_price)}),t);var c,m,d=0,u=0,p=0;(e.orderType||0==e.orderType)&&(d=null!==(c=parseInt(e.orderType))&&void 0!==c?c:0,u=e.orderAddr?parseInt(e.orderAddr.point_id):0,p=null!==(m=parseInt(e.orderPic))&&void 0!==m?m:0);var h="",f="",y="";if(0==n?(h=q()(new Date).tz("Europe/Samara").format("YYYY-MM-DD"),f=q()(new Date).tz("Europe/Samara").format("H:mm"),y=parseInt(q()(new Date).tz("Europe/Samara").format("E"))):(h=q()(n).tz("Europe/Samara").format("YYYY-MM-DD"),f=q()(n).tz("Europe/Samara").format("H:mm"),y=parseInt(q()(n).tz("Europe/Samara").format("E"))),a){if(!a.status_promo)return{st:!1,text:"Промокод не найден или уже активирован"};if(a.limits.date.min&&a.limits.date.max&&!(h>=a.limits.date.min&&h<=a.limits.date.max))return{st:!1,text:"Действует с "+a.limits.date.min+" по "+a.limits.date.max+" "+a.promo_text.false};if(0!=a.limits.time.min&&0!=a.limits.time.max&&!(f>=a.limits.time.min&&f<=a.limits.time.max))return{st:!1,text:f+" Действует с "+a.limits.time.min+" по "+a.limits.time.max+" "+a.promo_text.false};if(0!=a.limits.point_id&&!(0==d&&u==a.limits.point_id||1==d&&p==a.limits.point_id))return{st:!1,text:"Адрес для доставки или самовывоза указан некорректно. Проверьте правильность введённых данных."};if(!(0==a.limits.summ.min&&0==a.limits.summ.max||r>=a.limits.summ.min&&(a.limits.summ.max>=r||0==a.limits.summ.max)))return{st:!1,text:"Сумма от "+a.limits.summ.min+" до "+a.limits.summ.max+"  Общая сумма вашего заказа превышает допустимую стоимость для применения промокода."};if(a.limits.dows&&0==parseInt(a.limits.dows[y]))return{st:!1,text:"Указанный вами день недели недоступен для применения промокода. Пожалуйста, выберите другую дату."};if(a.limits.type_order&&!(1==parseInt(a.limits.type_order)||3==parseInt(a.limits.type_order)&&0==d||2==parseInt(a.limits.type_order)&&1==d))return{st:!1,text:"Действует "+(1==parseInt(a.limits.type_order)?"Все типы заказов":2==parseInt(a.limits.type_order)?"Только самовывоз":4==parseInt(a.limits.type_order)?"Только доставка":"Только в зале")};if(a.limits.only_kassa&&1==parseInt(a.limits.only_kassa))return{st:!1,text:"Указанный вами промокод действителен только при оплате на кассе."};if(a.limits.items.length>0){var g=null,v=null;if(a.limits.items.map((function(e){g=s.find((function(t){return t.item_id==e}));var t=o.find((function(t){return t.id==e}));t&&t.name&&(v+=t.name+", ",g&&t++)})),0!=a.limits.items.length)return{st:!1,text:"Позиции, которые должны быть в корзине: "+v}}Q.free_drive=parseInt(a.limits.free_drive);var _=0,Z=0,E=null;return 1==parseInt(a.promo_action)?(1==parseInt(a.sale.cat_sale)&&(Z=parseInt(a.sale.count_sale),i.forEach((function(e,t){E=o.find((function(t){return t.id==e.item_id})),3!=parseInt(E.type)&&4!=parseInt(E.type)&&a.sale.sale_action.forEach((function(r){parseInt(e.item_id)==parseInt(r)&&(1==parseInt(a.sale.type_price)?Z>0&&((_=parseInt(e.one_price)*parseInt(e.count)-parseInt(Z))<=0&&(_=1),Z-=parseInt(e.one_price)*parseInt(e.count),i[t].all_price=_):(_=parseInt(e.all_price)-parseInt(e.all_price)/100*parseInt(Z),i[t].all_price=parseInt(_)))}))}))),2==parseInt(a.sale.cat_sale)&&(Z=parseInt(a.sale.count_sale),i.forEach((function(e,t){E=o.find((function(t){return t.id==e.item_id})),3!=parseInt(E.type)&&4!=parseInt(E.type)&&a.sale.sale_action.forEach((function(r){parseInt(E.cat_id)==parseInt(r)&&(1==parseInt(a.sale.type_price)?Z>0&&((_=parseInt(e.one_price)*parseInt(e.count)-parseInt(Z))<=0&&(_=1),Z-=parseInt(e.one_price)*parseInt(e.count),i[t].all_price=_):(_=parseInt(e.all_price)-parseInt(e.all_price)/100*parseInt(Z),i[t].all_price=parseInt(_)))}))}))),3==parseInt(a.sale.cat_sale)&&(Z=parseInt(a.sale.count_sale),i.forEach((function(e,t){E=o.find((function(t){return t.id==e.item_id})),3!=parseInt(E.type)&&4!=parseInt(E.type)&&(1==parseInt(a.sale.type_price)?Z>0&&((_=parseInt(e.one_price)*parseInt(e.count)-parseInt(Z))<=0&&(_=1),Z-=parseInt(e.one_price)*parseInt(e.count),i[t].all_price=_):(_=parseInt(e.all_price)-parseInt(e.all_price)/100*parseInt(Z),i[t].all_price=parseInt(_)))}))),t=0,r=0,r=i.reduce((function(e,t){return e+t.all_price}),t),Q.setAllPrice(r),{st:!0,text:a.promo_text.true}):(2==parseInt(a.promo_action)&&(a.items_add.forEach((function(e){E=o.find((function(t){return t.id==e.item_id})),l.push({item_id:e.item_id,count:e.count,one_price:E.price,all_price:e.price})})),t=0,r=0,r=i.reduce((function(e,t){return e+parseInt(t.all_price)}),t),t=0,r+=l.reduce((function(e,t){return e+parseInt(t.all_price)}),t),Q.setItemsPromo(l),Q.setAllPrice(r)),3==parseInt(a.promo_action)&&a.items_on_price.length>0&&(i.forEach((function(e,t){a.items_on_price.forEach((function(r){parseInt(e.item_id)==parseInt(r.id)&&(i[t].new_one_price=parseInt(r.price),i[t].all_price=parseInt(r.price)*parseInt(e.count))}))})),t=0,r=0,r=i.reduce((function(e,t){return e+parseInt(t.all_price)}),t),Q.setAllPrice(r)),this.setItems(i),{st:!0,text:a.promo_text.true})}return{st:!1,text:"Промокод не найден",test:a}}},{key:"getItemsPromo",value:function(){return 0==this.itemsPromo.length?[]:JSON.parse(this.itemsPromo,!0)}},{key:"getAllItemsCat",value:function(){return 0==this.allItemsCat.length?[]:JSON.parse(this.allItemsCat,!0)}},{key:"getCartData",value:function(){if("undefined"!=typeof window)return localStorage.getItem("cartData")?JSON.parse(localStorage.getItem("cartData")):[]}},{key:"checkCart",value:function(){var e=this.getItems(),t=this.getAllItems(),r=[];e.forEach((function(e){var n=t.find((function(t){return parseInt(t.id)==parseInt(e.item_id)}));r.push({name:e.name,item_id:e.item_id,count:e.count,one_price:parseInt(n.price),all_price:parseInt(n.price)*parseInt(e.count)})})),this.setItems(r)}},{key:"getItems",value:function(){return 0==this.items.length?[]:JSON.parse(this.items,!0)}},{key:"getAllItems",value:function(){return 0==this.allItems.length?[]:JSON.parse(this.allItems,!0)}},{key:"AddItem",value:function(e){var t=Q.getItems(),r=Q.getAllItems(),n=Q.getPromo();if(!(r.length>0))return 0;var a=t.find((function(t){return t.item_id==e})),i=0;a&&(i=parseInt(a.count));var o=r.find((function(t){return t.id==e}));if(o){var s=i+1,l=parseInt(o.price),c=Q.check_max_count(parseInt(e));return console.log("max_count ",c," count ",s),parseInt(c)>=s?(t.some((function(t){return t.item_id==e}))?t.forEach((function(r,n){r.item_id==e&&(t[n].count=s,t[n].all_price=s*l)})):t.push({name:o.name,item_id:e,count:s,one_price:l,all_price:s*l}),Q.setItems(t),n&&Q.checkPromo(),s):s-1}}},{key:"AddCountItem",value:function(e,t){var r=Q.getItems(),n=Q.getAllItems(),a=Q.getPromo();if(!(n.length>0))return 0;var i=r.find((function(t){return t.item_id==e}));i&&parseInt(i.count);var o=n.find((function(t){return t.id==e}));if(o){var s=parseInt(t),l=parseInt(o.price),c=Q.check_max_count(parseInt(e));return parseInt(c)>=s?(r.some((function(t){return t.item_id==e}))?r.forEach((function(t,n){t.item_id==e&&(r[n].count=s,r[n].all_price=s*l)})):r.push({name:o.name,item_id:e,count:s,one_price:l,all_price:s*l}),Q.setItems(r),a&&Q.checkPromo(),s):s-1}}},{key:"MinusItem",value:function(e){var t=Q.getItems(),r=Q.getAllItems(),n=Q.getPromo();if(r.length>0){var a=t.find((function(t){return t.item_id==e}));if(!a)return 0;var i=r.find((function(t){return t.id==e})),o=parseInt(a.count)-1,s=i.price;o<=0&&(o=0);var l=0;return Q.getFreeItems(),o>=0&&(t.map((function(r,n){r.item_id==e&&(t[n].count=o,t[n].all_price=o*s)})),Q.setItems(t),setTimeout((function(){t.map((function(e,r){l=Q.check_max_count(e.item_id),parseInt(l)<0&&(t[r].count=parseInt(e.count)+parseInt(l),t[r].all_price=(parseInt(e.count)+parseInt(l))*parseInt(e.one_price))})),Q.setItems(t)}),300)),n&&Q.checkPromo(),o}return 0}},{key:"delItem",value:function(e){var t=Q.getItems(),r=Q.getAllItems(),n=Q.getPromo();if(r.length>0){if(!t.find((function(t){return t.item_id==e})))return 0;var a=r.find((function(t){return t.id==e})),i=0,o=a.price;if(i<=0&&(i=0),i>=0){t.map((function(r,n){r.item_id==e&&(t[n].count=i,t[n].all_price=i*o)})),Q.setItems(t);var s=0;setTimeout((function(){t.map((function(e,r){s=Q.check_max_count(e.item_id),parseInt(s)<0&&(t[r].count=parseInt(e.count)+parseInt(s),t[r].all_price=(parseInt(e.count)+parseInt(s))*parseInt(e.one_price))})),Q.setItems(t)}),300)}return n&&Q.checkPromo(),i}return 0}},{key:"check_need_dops",value:function(){var e=Q.getItems(),t=Q.getAllItems();if(!t||0==t.length)return[];var r=0,n=0,a=Q.getDops();if(0==a.length)return[];e.forEach((function(e){var a=t.find((function(t){return t.id==e.item_id}));if(!a)return[];14==parseInt(a.cat_id)?r+=parseInt(e.count):14!==parseInt(a.cat_id)&&5!==parseInt(a.cat_id)&&6!==parseInt(a.cat_id)&&7!==parseInt(a.cat_id)&&(n+=parseInt(e.count))}));var i=[];n>0&&0==r&&(i=a.rolls),0==n&&r>0&&(i=a.pizza),n>0&&r>0&&(i=[].concat((0,Y.Z)(a.rolls),(0,Y.Z)(a.pizza))),0==n&&0==r&&(i=[].concat((0,Y.Z)(a.rolls),(0,Y.Z)(a.pizza)));var o=[],s=[];return e.forEach((function(e){var r=t.find((function(t){return t.id==e.item_id}));if(!r)return[];7==parseInt(r.cat_id)&&o.push(r)})),o.forEach((function(e){var t=!1;i.forEach((function(r){parseInt(r.id)==parseInt(e.id)&&(t=!0)})),t||s.push(e)})),i=[].concat((0,Y.Z)(i),s)}},{key:"check_max_count",value:function(e){var t=[],r=[],n=Q.getItems(),a=Q.getItemsPromo(),i=Q.getFreeItems(),o=Q.getAllItems(),s=o.find((function(t){return parseInt(t.id)==parseInt(e)}));if(3!=parseInt(s.type)||17!==parseInt(s.id)&&237!==parseInt(s.id))return 99;if(!i)return 99;var l=0;n.forEach((function(e,n){var a=o.find((function(t){return parseInt(t.id)==parseInt(e.item_id)})),s=i.find((function(t){return parseInt(t.this_item_id)==parseInt(e.item_id)}));s&&s.max_count&&3!=parseInt(a.type)&&parseInt(s.max_count),17!=parseInt(a.id)&&237!=parseInt(a.id)||(l+=parseInt(e.count)),i.forEach((function(n){parseInt(e.item_id)==parseInt(n.this_item_id)&&(n.count_in_cart=parseInt(e.count),t.push(n),r.push(parseInt(n.item_id)))}))})),a.forEach((function(e,n){var a=o.find((function(t){return parseInt(t.id)==parseInt(e.item_id)})),s=i.find((function(t){return parseInt(t.this_item_id)==parseInt(e.item_id)}));s&&s.max_count&&3!=parseInt(a.type)&&parseInt(s.max_count),17!=parseInt(a.id)&&237!=parseInt(a.id)||(l+=parseInt(e.count)),i.forEach((function(n){parseInt(e.item_id)==parseInt(n.this_item_id)&&(n.count_in_cart=parseInt(e.count),t.push(n),r.push(parseInt(n.item_id)))}))})),r=(0,Y.Z)(new Set(r));var c=[];r.forEach((function(e,r){t.forEach((function(t){if(parseInt(e)==parseInt(t.item_id)){var r=!1;c.forEach((function(n,a){parseInt(n.item_id)==parseInt(e)&&(r=!0,c[a].count+=t.count_in_cart*t.max_count)})),r||c.push({item_id:parseInt(e),count_in_cart:t.count_in_cart,count:t.count_in_cart*t.max_count})}}))}));var m=99;return c.length>0&&(m=c.find((function(e){return 17==parseInt(e.item_id)})))&&(m=parseInt(m.count),l>=m)?m-l:m}},{key:"check_max_count_old",value:function(e){var t=[],r=[],n=Q.getItems(),a=Q.getFreeItems();if(!a)return 99;n.forEach((function(e,n){a.forEach((function(n){parseInt(e.item_id)==parseInt(n.this_item_id)&&(n.count_in_cart=parseInt(e.count),t.push(n),r.push(parseInt(n.item_id)))}))})),r=(0,Y.Z)(new Set(r));var i=[];r.forEach((function(e,r){t.forEach((function(t){if(parseInt(e)==parseInt(t.item_id)){var r=!1;i.forEach((function(n,a){parseInt(n.item_id)==parseInt(e)&&(r=!0,i[a].count+=t.count_in_cart*t.max_count)})),r||i.push({item_id:parseInt(e),count:t.count_in_cart*t.max_count})}}))}));var o=99;return i.forEach((function(t){parseInt(t.item_id)==parseInt(e)&&(o=parseInt(t.count))})),o}}]),e}());const X=Q;var $=r(64),ee=r(366),te=r(3957),re=r(2692),ne=r(5477),ae=r(2302),ie=r(9613),oe=r(8222),se=r(6847),le=r(3750),ce=r(7394),me=r(2663),de=r(8358),ue=r(7812),pe=r(8884),he=r(5517),fe=r(2112),ye=r(6856),ge=r(9525),ve=r(7212),_e=["children","value","index"];function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,d.Z)(e);if(t){var a=(0,d.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,m.Z)(this,r)}}var Ee=r(7563),Ie=(0,g.Z)((function(e){return{root2:{display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"center","& > svg, form":{borderRight:"0px!important"}},root3:{"& > *":{margin:e.spacing(1),width:50},"& .MuiOutlinedInput-input":{padding:"5px 10px"}},list:{width:250},fullList:{width:"auto"},root:{flexGrow:1},title:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary},paperCat:{padding:e.spacing(1),textAlign:"center",color:"#000",position:"relative",justifyContent:"space-between",height:"calc(100% - 15px)",cursor:"pointer","& svg":{color:e.palette.text.secondary}},paperCatInfo:{position:"absolute",top:0,right:0},size1:{},scrollTable:{maxHeight:250,overflow:"auto",padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}}));function Te(e){var t=e.children,r=e.value,a=e.index,i=(0,f.Z)(e,_e);return n.createElement("div",(0,h.Z)({role:"tabpanel",hidden:r!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},i),r===a&&n.createElement(N.Z,{p:3},t))}Te.propTypes={children:A().node,index:A().any.isRequired,value:A().any.isRequired};var be=(0,v.Z)((function(e){return{tooltip:{backgroundColor:"#f5f5f9",color:"rgba(0, 0, 0, 0.87)",maxWidth:220,fontSize:e.typography.pxToRem(12),border:"1px solid #dadde9"}}}))(M.ZP),we=function(e){(0,c.Z)(r,e);var t=Ze(r);function r(e){var n;return(0,o.Z)(this,r),n=t.call(this,e),(0,u.Z)((0,l.Z)(n),"_isMounted",!1),n.state={classes:n.props.classes,item:n.props.item,type:n.props.type},n}return(0,s.Z)(r,[{key:"shouldComponentUpdate",value:function(e,t){return!!t.item&&(parseInt(this.state.item.all_price)!==parseInt(t.item.all_price)||parseInt(this.state.item.count)!==parseInt(t.item.count))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,(0,F.EH)((function(){if(!0===e._isMounted&&e.state.item.item_id){var t=X.getItems().find((function(t){return t.item_id==e.state.item.item_id}));e.setState({item:t})}}))}},{key:"delItem",value:function(e){X.delItem(e)}},{key:"changeCount",value:function(e){var t=e.target.value,r=this.state.item.item_id;t.length>0&&X.AddCountItem(r,t)}},{key:"add",value:function(){X.AddItem(this.state.item.item_id)}},{key:"minus",value:function(){X.MinusItem(this.state.item.item_id)}},{key:"render",value:function(){return n.createElement(ce.Z,{hover:!0,style:0==this.state.item.count?{display:"none"}:{}},n.createElement(oe.Z,null,this.state.item.name),n.createElement(oe.Z,{style:{textAlign:"center"}},"promo"==this.state.type?n.createElement(S.Z,{component:"span",style:{padding:"11px 0",display:"block"}},this.state.item.count):n.createElement("div",{className:this.state.classes.root2},n.createElement($.Z,{onClick:this.minus.bind(this),style:{cursor:"pointer"}}),n.createElement("form",{className:this.state.classes.root3,noValidate:!0,autoComplete:"off"},n.createElement(B.Z,{variant:"outlined",onChange:this.changeCount.bind(this),value:this.state.item.count})),n.createElement(te.Z,{onClick:this.add.bind(this),style:{cursor:"pointer"}}))),n.createElement(oe.Z,null,this.state.item.all_price),n.createElement(oe.Z,null,"promo"!==this.state.type?n.createElement(ee.Z,{style:{cursor:"pointer",marginTop:5},onClick:this.delItem.bind(this,this.state.item.item_id)}):null))}}]),r}(n.Component),xe=function(e){(0,c.Z)(r,e);var t=Ze(r);function r(e){var n,a;return(0,o.Z)(this,r),a=t.call(this,e),(0,u.Z)((0,l.Z)(a),"_isMounted",!1),(0,u.Z)((0,l.Z)(a),"_isEdit",!1),(0,u.Z)((0,l.Z)(a),"clickOrderStart",!1),(0,u.Z)((0,l.Z)(a),"startOrderInterval",300),(0,u.Z)((0,l.Z)(a),"startOrderIntervalTimer",null),(0,u.Z)((0,l.Z)(a),"interval",null),(0,u.Z)((0,l.Z)(a),"componentDidMount",(function(){a._isMounted=!0,a.interval=setInterval((function(){return a.checkLogin()}),36e5),a.checkLogin();var e=X.getCartData(),t=localStorage.getItem("cityID");t?(X.setCity(t),a.setState({cityID:t,city:t})):(X.setCity(1),a.setState({cityID:1,city:1})),fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ee.stringify({type:"get_cat_center",city_id:X.getCity()})}).then((function(e){return e.json()})).then((function(e){a.setState({cats:e.arr,cityList:e.city_list,allItems:e.all_items}),X.setAllItemsCat(e.arr),X.setAllItems(e.all_items),X.setFreeItems(e.free_items)})).catch((function(e){})),fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ee.stringify({type:"get_by_mi",city_id:X.getCity(),user_id:X.getToken()})}).then((function(e){return e.json()})).then((function(t){if(a.setState({pic_point:t.get_addr_pic.points,all_addr:t.get_addr,date_pred:t.date_pred}),e.orderType&&1==parseInt(e.orderType)){var r=t.get_addr_pic.points.find((function(t){return t.id==parseInt(e.orderPic)}));a.choosePic(r)}}));var r="";if(localStorage.getItem("clientNumber")&&(r=localStorage.getItem("clientNumber"),X.clientNumber=r,a.setState({number:r,clientNumber:r}),a.getAddr()),localStorage.getItem("promo_name")){var n=localStorage.getItem("promo_name");setTimeout((function(){a.setState({promo_name:n}),a.checkPromo({target:{value:n}})}),500)}if(e.orderType||0==e.orderType){console.log("autorun orderType 1"),a.setState({newAddrStreet:e.orderAddr&&e.orderAddr.street?e.orderAddr.street:"",newAddrHome:e.orderAddr&&e.orderAddr.home?e.orderAddr.home:"",pd:e.orderAddr&&e.orderAddr.pd?e.orderAddr.pd:"",et:e.orderAddr&&e.orderAddr.et?e.orderAddr.et:"",kv:e.orderAddr&&e.orderAddr.kv?e.orderAddr.kv:"",newAddrDom:!e.orderAddr||1!=parseInt(e.orderAddr.dom_true)});var i=X.getAllPrice();1==parseInt(e.orderAddr?e.orderAddr.free_drive:0)||1==parseInt(X.free_drive)?parseInt(i)>0?X.setSumDiv(0):X.setSumDiv(1):X.setSumDiv(parseInt(e.orderAddr?e.orderAddr.sum_div:0))}e.orderComment!=a.state.comment&&a.setState({comment:e.orderComment}),parseInt(e.orderSdacha)!=parseInt(a.state.sdacha)&&a.setState({sdacha:e.orderSdacha}),(0,F.EH)((function(){if(a._isMounted){var e=X.getCity(),t=X.getCartData();if(X.cart_data,a.loadTimeWait(),parseInt(e)!=parseInt(a.state.cityID)&&(console.log("autorun change_city"),a.setState({cityID:e,pic_point:[],all_addr:[],date_pred:[]}),fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ee.stringify({type:"get_cat_center",city_id:e})}).then((function(e){return e.json()})).then((function(e){a.setState({cats:e.arr,cityList:e.city_list}),X.setAllItemsCat(e.arr),X.setAllItems(e.all_items),X.setFreeItems(e.free_items),setTimeout((function(){if(localStorage.getItem("promo_name")){var e=localStorage.getItem("promo_name");setTimeout((function(){a.setState({promo_name:e}),a.checkPromo({target:{value:e}})}),500)}a.getAddr()}),500)})).catch((function(e){})),fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ee.stringify({type:"get_by_mi",city_id:e,user_id:X.getToken()})}).then((function(e){return e.json()})).then((function(e){a.setState({pic_point:e.get_addr_pic.points,all_addr:e.get_addr,date_pred:e.date_pred})}))),parseInt(a.state.typeTime)!=parseInt(t.orderTimes)&&(a.setState({typeTime:t.orderTimes}),a.setState({time:t.orderPredTime,date:t.orderPredDay,typeTime:t.orderTimes}),0==t.orderType&&(1==parseInt(t.orderTimes)?a.loadTimePred():a.loadTimeWait()),1==t.orderType&&(1==parseInt(t.orderTimes)?a.loadTimePred():a.loadTimeWait(),a.setState({point_id:t.orderPic}))),t.orderType||0==t.orderType){var r=X.getAllPrice();1==parseInt(t.orderAddr?t.orderAddr.free_drive:0)||1==parseInt(X.free_drive)?parseInt(r)>0?X.setSumDiv(0):X.setSumDiv(1):X.setSumDiv(parseInt(t.orderAddr?t.orderAddr.sum_div:0))}if(X.updateMyPromos!=a.state.updateMyPromos){console.log("autorun updateMyPromos");var n=X.getMyPromos(),i=[],o=b()(new Date).add(-7,"days").format("YYYY-MM-DD");n=n.filter((function(e){return e.date>=o})),localStorage.setItem("MyPromos",JSON.stringify(n)),n.forEach((function(e){var t=i.find((function(t){return t.promo==e.promo}));t&&0!=t.length?i.forEach((function(t,r){t.promo==e.promo&&i[r].count++})):(e.count=1,i.push(e))})),i=i.filter((function(e){return e.count>1})),a.setState({updateMyPromos:X.updateMyPromos,MyPromos:i})}var s=X.getAllPrice(),l=X.getSumDiv();parseInt(s)!=parseInt(a.state.AllPrice)&&(a.setState({AllPrice:s}),setTimeout((function(){if(document.getElementById("promo_name")&&document.getElementById("promo_name").value.length>0){var e=document.getElementById("promo_name").value;setTimeout((function(){a.setState({promo_name:e}),console.log("check_promo 11"),a.checkPromo({target:{value:e}})}),100)}}),300)),1==parseInt(X.free_drive)?0==parseInt(s)?(X.setSumDiv(1),a.setState({sumDiv:1})):(X.setSumDiv(0),a.setState({sumDiv:0})):parseInt(l)!=parseInt(a.state.sumDiv)&&(t.orderType&&1==t.orderType?a.setState({sumDiv:0}):a.setState({sumDiv:l}));var c=X.getItems(),m=X.getAllItems(),d=X.getItemsPromo(),u=[];d.map((function(e){var t=m.find((function(t){return t.id==e.item_id}));t&&u.push({id:e.item_id,cat_id:t.cat_id,name:t.name,desc:t.tmp_desc,count:e.count,all_price:e.all_price,img:t.img_new,imgUpdate:t.img_new_update})}));var p=[],h=[];m.length>0&&(c.map((function(e){var t=m.find((function(t){return t.id==e.item_id}));t||alert("В корзине произошла ошибка"),t&&7==parseInt(t.cat_id)?h.push(e):p.push(e)})),a.setState({dop_items:h,main_items:p,promo_items:u}))}})),e&&e.orderType&&a.setState({activeTab:1==parseInt(e.orderType)?1:0,typeOrder:parseInt(e.orderType),comment:e.comment?e.comment:"",sdacha:e.sdacha?e.sdacha:""})})),(0,u.Z)((0,l.Z)(a),"changeTab",(function(e,t){(0==parseInt(t)||1==parseInt(t))&&parseInt(t),console.log("test",t),1==parseInt(t)&&(a.setState({sumDiv:0}),X.setSumDiv(0)),a.setState({activeTab:t}),setTimeout((function(){a.saveData()}),500)})),(0,u.Z)((0,l.Z)(a),"changeCat",(function(e,t){a.setState({activeCat:t})})),(0,u.Z)((0,l.Z)(a),"changeTypeTime",(function(e,t){console.log("changeTypeTime"),a.changeDataTime("typeTime",{target:{value:t}}),0==parseInt(t)?a.loadTimeWait():a.loadTimePred()})),a.state=(n={classes:a.props.classes,allItems:[],newOrder:null,errorOpen:!1,error:{title:"",text:""},orderCheck:!1,spiner:!1,cityID:0,AllPrice:0,sumDiv:0,activeTab:0,clientNumber:"",cityList:[],cats:[],all_addr:[],pic_point:[],timePred:[],date_pred:[],clientAddr:[],comment:"",sdacha:"",orderDate:"",orderTime:"",typeOrder:0,items:[],main_items:[],dop_items:[],promo_items:[],activeCat:0,thisItem:"",orderPic:0,picPointInfo:null,point_id:0,defValStreet:"",defValHome:"",newAddrInfo:"",newAddrStreet:"",newAddrHome:"",newAddrPD:"",newAddrET:"",newAddrKV:"",newAddrDom:"",pd:"",et:"",kv:"",chooseAddr:-1},(0,u.Z)(n,"point_id",0),(0,u.Z)(n,"change_point_id",0),(0,u.Z)(n,"textAvgTime","Среднее время: ~"),(0,u.Z)(n,"date",""),(0,u.Z)(n,"time",""),(0,u.Z)(n,"typeTime",0),(0,u.Z)(n,"city",X.getCity()),(0,u.Z)(n,"updateMyPromos",null),(0,u.Z)(n,"MyPromos",[]),(0,u.Z)(n,"number",""),(0,u.Z)(n,"orderPromoText",""),(0,u.Z)(n,"promo_name",""),(0,u.Z)(n,"promoST",!1),(0,u.Z)(n,"top",!1),(0,u.Z)(n,"left",!1),(0,u.Z)(n,"bottom",!1),(0,u.Z)(n,"right",!1),(0,u.Z)(n,"thisDateTimeDel",null),n),a}return(0,s.Z)(r,[{key:"componentWillUnmount",value:function(){this._isMounted=!1,clearInterval(this.interval)}},{key:"checkLogin",value:function(){var e=this;fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ee.stringify({type:"check_login_center",token:X.getToken()})}).then((function(e){return e.json()})).then((function(t){!0===t||(localStorage.removeItem("token"),clearInterval(e.interval),setTimeout((function(){window.location.href="/auth"}),500))})).catch((function(e){}))}},{key:"getAddr",value:function(){var e=this;fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ee.stringify({type:"get_user_addrs",city_id:X.getCity(),login:this.state.clientNumber})}).then((function(e){return e.json()})).then((function(t){console.log("clientAddr",t),console.log("type",{type:"get_user_addrs",city_id:X.getCity(),login:e.state.clientNumber}),e.setState({clientAddr:t})}))}},{key:"changeData",value:function(e,t){var r=t.target.value;this.setState((0,u.Z)({},e,r)),this.saveData()}},{key:"saveData",value:function(){var e=this,t=X.getCartData();setTimeout((function(){var r={orderType:0==parseInt(e.state.activeTab)||1==parseInt(e.state.activeTab)?parseInt(e.state.activeTab):0,orderAddr:t&&t.orderAddr?t.orderAddr:"",orderPic:e.state.orderPic,orderComment:e.state.comment,orderTimes:e.state.typeTime,orderPredDay:e.state.date,orderPredTime:e.state.time,orderPay:t&&t.orderPay?t.orderPay:"0",orderSdacha:e.state.sdacha};X.saveCartData(r)}),100)}},{key:"saveDataOther",value:function(){var e=this,t=X.getCartData(),r=this.state.newAddrInfo?this.state.newAddrInfo:t.orderAddr;setTimeout((function(){var n={orderType:0==parseInt(e.state.activeTab)||1==parseInt(e.state.activeTab)?parseInt(e.state.activeTab):0,orderAddr:{id:-1,street:r.street?r.street:"",home:r.home?r.home:"",kv:e.state.kv,pd:e.state.pd,et:e.state.et,dom_true:e.state.newAddrDom?0:1,free_drive:r.free_drive?r.free_drive:0,sum_div:r.sum_div?r.sum_div:0,point_id:r.point_id?r.point_id:0,xy:r.xy?r.xy:"",pay_active:r.pay_active?r.pay_active:0},orderPic:e.state.orderPic,orderComment:e.state.comment,orderTimes:e.state.typeTime,orderPredDay:e.state.date,orderPredTime:e.state.time,orderPay:t&&t.orderPay?t.orderPay:"0",orderSdacha:e.state.sdacha};X.saveCartData(n)}),100)}},{key:"startOrderNext",value:function(){var e=this;if(0==this.clickOrderStart){this.clickOrderStart=!0,clearTimeout(this.startOrderIntervalTimer);var t=X.getCartData();this.setState({spiner:!0});var r=[];if(X.getItems().forEach((function(e){e.count>0&&r.push({name:e.name,count:e.count,price:e.all_price,id:e.item_id})})),0!==parseInt(t.orderTimes)&&0==t.orderPredDay.length&&0==t.orderPredTime.length)return this.setState({error:{title:"Предупреждение",text:"Не выбрано дата / время предзаказа"},errorOpen:!0,spiner:!1}),void(this.clickOrderStart=!1);var n=localStorage.getItem("promo_name")?localStorage.getItem("promo_name"):document.getElementById("promo_name").value;fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ee.stringify({type:"createOrder",typeCreate:"center",city_id:X.getCity(),user_id:X.getToken(),timePred:JSON.stringify({value:0==parseInt(t.orderTimes)?0:t.orderPredDay+" "+t.orderPredTime}),typeOrder:t.orderType,addrPic:t.orderPic,comment:t.orderComment,sdacha:t.orderSdacha,addrDev:t.orderAddr?JSON.stringify(t.orderAddr):"",payFull:JSON.stringify({type:"cash"}),cart:JSON.stringify(r),promo_name:n,number:X.clientNumber})}).then((function(e){return e.json()})).then((function(r){if(setTimeout((function(){e.setState({spiner:!1}),e.clickOrderStart=!1}),500),r.st){if(localStorage.getItem("promo_name")&&localStorage.getItem("promo_name").length>0){var n=localStorage.getItem("promo_name"),a=X.getMyPromos();a.push({date:b()(new Date).format("YYYY-MM-DD"),promo:n}),X.setMyPromos(a)}var i=[];r.my_cart.map((function(e){3!=parseInt(e.type)&&4!=parseInt(e.type)&&i.push(e)})),r.my_cart.map((function(e){3!=parseInt(e.type)&&4!=parseInt(e.type)||i.push(e)})),e.setState({newOrder:{cart:i,order_id:r.order_id,point_id:r.point_id,point_name:r.point_name,time_wait:r.time_wait_order,typeOrder:0==parseInt(t.orderType)?"Доставка":"Самовывоз",number:X.clientNumber,comment:0==parseInt(t.orderType)?t.orderComment:"",sdacha:0==parseInt(t.orderType)?t.orderSdacha:"",timePred:0==parseInt(t.orderTimes)?"":t.orderPredDay+" "+t.orderPredTime,addr:0==parseInt(t.orderType)?t.orderAddr:{},promoName:localStorage.getItem("promo_name"),dop_text:r.dop_text}}),setTimeout((function(){e.setState({orderCheck:!0})}),500),e.startOrderIntervalTimer=setTimeout((function(){e.setState({orderCheck:!1,newOrderData:null})}),1e3*e.startOrderInterval)}else e.setState({error:{title:"Предупреждение",text:r.text_err},errorOpen:!0})}))}}},{key:"trueOrder",value:function(){var e=this;fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ee.stringify({type:"trueOrder",city_id:X.getCity(),order_id:this.state.newOrder.order_id,point_id:this.state.newOrder.point_id})}).then((function(e){return e.json()})).then((function(t){0==t.st?e.setState({error:{title:"При подтверждении оплаты произошла ошибка",text:t.text_err},errorOpen:!0}):(e.setState({error:{title:"Подтверждение заказа",text:"Заказ успешно оформлен"},errorOpen:!0,orderCheck:!1,newOrderData:null}),e.clear(),clearTimeout(e.startOrderIntervalTimer))}))}},{key:"clear",value:function(){X.clientNumber="",localStorage.removeItem("clientNumber"),localStorage.removeItem("promo_name"),X.setItems([]),X.setItemsPromo([]);var e={orderType:"0",orderAddr:"",orderPic:0,orderComment:"",orderTimes:0,orderPredDay:"",orderPredTime:"",orderPay:"",orderSdacha:"",dateTime:new Date};X.dateTimeDel=new Date,X.saveCartData(e),setTimeout((function(){X.setPromo(null,"")}),300),this.setState({number:"",promo_name:"",orderPromoText:""}),this.setState({newAddrStreet:"",newAddrHome:"",pd:"",et:"",kv:"",newAddrDom:!0,newAddrInfo:"",chooseAddr:-1,orderPic:0,picPointInfo:null,point_id:0,comment:"",sdacha:"",number:"",clientNumber:""}),X.setSumDiv(0)}},{key:"addToCart",value:function(e){X.AddItem(e)}},{key:"addItemCustom",value:function(e,t){var r=this,n=this.state.allItems.find((function(e){return e.name==t}));this.addToCart(n.id),this.setState({thisItem:n.name}),setTimeout((function(){r.setState({thisItem:""})}),100)}},{key:"choosePic",value:function(e){var t=this;this.setState({orderPic:e.id,picPointInfo:e,point_id:e.id,sumDiv:0}),X.setSumDiv(0),this.saveData(),setTimeout((function(){t.checkPromo({target:{value:t.state.promo_name}}),X.setSumDiv(0)}),300)}},{key:"checkNewAddr",value:function(){var e=this,t=document.querySelector("#newAddrStreet").value;t.length>0&&this.state.newAddrHome.length>0&&fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ee.stringify({type:"save_new_addr",city_id:X.getCity(),street:t,home:this.state.newAddrHome,user_id:X.getToken()})}).then((function(e){return e.json()})).then((function(t){if(t.st){e.setState({newAddrInfo:t.res,point_id:t.res.point_id});var r=X.getAllPrice();console.log("free_drive 2",t.res.free_drive,parseInt(X.free_drive)),1==parseInt(t.res?t.res.free_drive:0)||1==parseInt(X.free_drive)?parseInt(r)>0?X.setSumDiv(0):X.setSumDiv(1):X.setSumDiv(parseInt(t.res?t.res.sum_div:0)),e.saveDataOther(),setTimeout((function(){e.checkPromo({target:{value:e.state.promo_name}})}),300)}else alert(t.text)}))}},{key:"changeDomTrue",value:function(e){this.setState({newAddrDom:e}),this.changeDataOther("domTrue",{target:{value:e}})}},{key:"changeDataOther",value:function(e,t){var r=t.target.value;this.setState((0,u.Z)({},e,r)),this.saveDataOther()}},{key:"chooseAddr",value:function(e,t,r){var n=this,a=X.getAllPrice();console.log("free_drive 3",t.free_drive,parseInt(X.free_drive)),1==parseInt(t?t.free_drive:0)||1==parseInt(X.free_drive)?parseInt(a)>0?X.setSumDiv(0):X.setSumDiv(1):X.setSumDiv(parseInt(t?t.sum_div:0)),console.log(t),this.setState({newAddrStreet:t.street,newAddrHome:t.home,pd:t.pd,et:t.et,kv:t.kv,newAddrDom:0==parseInt(t.dom_true),point_id:t.point_id}),this.setState({chooseAddr:e});var i=X.getCartData();i.orderAddr=t,X.saveCartData(i),setTimeout((function(){n.checkPromo({target:{value:n.state.promo_name}})}),300)}},{key:"chooseAddr2",value:function(e,t,r){var n=this,a=X.getAllPrice();console.log("free_drive 4",t.free_drive,parseInt(X.free_drive)),1==parseInt(t?t.free_drive:0)||1==parseInt(X.free_drive)?parseInt(a)>0?X.setSumDiv(0):X.setSumDiv(1):X.setSumDiv(parseInt(t?t.sum_div:0)),e!=this.state.chooseAddr&&this.setState({chooseAddr:e,point_id:t.point_id}),setTimeout((function(){n.checkPromo({target:{value:n.state.promo_name}})}),300)}},{key:"loadTimePred",value:function(){var e,t,r=this,n=[],a=X.getItems(),i=X.getCartData();i.orderType+1==1&&(!i.orderAddr||i.orderAddr.point_id),a.forEach((function(e){n.push({item_id:e.item_id,count:e.count})})),fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ee.stringify({type:"get_times_pred_center",point_id:i.orderType+1==1?null!==(e=i.orderAddr.point_id)&&void 0!==e?e:0:null!==(t=i.orderPic)&&void 0!==t?t:0,type_order:i.orderType+1,date:this.state.date,cart:JSON.stringify(n)})}).then((function(e){return e.json()})).then((function(e){e.st&&r.setState({timePred:e.data})}))}},{key:"loadTimeWait",value:function(){var e,t,r=this,n=X.getCartData();fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ee.stringify({type:"load_time_wait_test",point_id:n.orderType+1==1?null!==(e=n.orderAddr.point_id)&&void 0!==e?e:0:null!==(t=n.orderPic)&&void 0!==t?t:0,type_order:n.orderType,city_id:X.getCity(),cart:JSON.stringify(X.getItems()),cartPromo:JSON.stringify(X.getItemsPromo())})}).then((function(e){return e.json()})).then((function(e){console.log(e),r.setState({textAvgTime:e.text})}))}},{key:"changeDataTime",value:function(e,t){var r=this,n=t.target.value;this.setState((0,u.Z)({},e,n)),"date"==e&&setTimeout((function(){r.loadTimePred()}),300),this.saveData()}},{key:"startData",value:function(){var e=this;this._thisEdit=!0;var t=X.getCartData();if(t){var r=t.orderPredDay;if(0==this.state.date_pred.filter((function(e){return e.date<r})).length)return this.changeTypeTime(null,0),void this.setState({time:"",date:""});this.setState({date:r}),setTimeout((function(){e.loadTimePred(),setTimeout((function(){t.orderPredTime&&(0==e.state.timePred.filter((function(e){return e.value==t.orderPredTime})).length?e.changeTypeTime(null,0):e.setState({time:t.orderPredTime}))}),1e3)}),500)}t.orderTimes&&this.setState({typeTime:t.orderTimes}),this._thisEdit=!1}},{key:"saveNumber",value:function(e){var t=this,r=e.target.value,n="";(r+="").length>0&&("7"!=(r=(r=(r=(r=(r=r.split(" ").join("")).split("(").join("")).split(")").join("")).split("-").join("")).split("+").join(""))[0]&&7!=r[0]||((n=r.split(""))[0]=8,r=n.join("")),11!=r.length)?alert("Номер введен в не верном формате!"):(this.setState({number:r,clientNumber:r}),X.clientNumber=r,localStorage.setItem("clientNumber",r),setTimeout((function(){t.getAddr()}),300))}},{key:"checkPromo",value:function(e){var t=this,r=e.target.value;fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Ee.stringify({type:"get_promo",city_id:X.getCity(),promo_name:r})}).then((function(e){return e.json()})).then((function(e){X.setPromo(JSON.stringify(e),r);var n=X.checkPromo();!1===n.st&&localStorage.removeItem("promo_name"),0==r.length?(t.setState({orderPromoText:"",promo_name:"",promoST:!1}),localStorage.removeItem("promo_name"),X.free_drive=0):t.setState({orderPromoText:n.text,promoST:n.st,promo_name:r})}))}},{key:"toggleDrawer2",value:function(e,t,r){this.setState((0,u.Z)({},e,t))}},{key:"changeCity",value:function(e){var t=e.target.value;this.setState({city:t}),X.setCity(t),localStorage.setItem("cityID",t),X.saveCartData({orderType:"0",orderAddr:"",orderPic:0,orderComment:"",orderTimes:0,orderPredDay:"",orderPredTime:"",orderPay:"",orderSdacha:""}),setTimeout((function(){}),500)}},{key:"logOut",value:function(){localStorage.removeItem("token"),setTimeout((function(){window.location.reload()}),500)}},{key:"render",value:function(){var e,t=this;return n.createElement(x.Z,{container:!0,spacing:0,style:{width:"100vw",height:"100vh"}},n.createElement(w.q,null,n.createElement("title",null,"Оформление заказа")),n.createElement(re.Z,{open:this.state.spiner,style:{zIndex:99,color:"#fff"}},n.createElement(ne.Z,{color:"inherit"})),n.createElement(x.Z,{item:!0,xs:8,style:{paddingRight:16}},this.state.cityList.length>0?n.createElement("div",{className:this.state.classes.root},n.createElement(C.Z,{position:"static",style:{backgroundColor:"#fff",color:"#000"}},n.createElement(de.Z,{style:{minHeight:48,height:48}},n.createElement(ue.Z,{edge:"start",onClick:this.toggleDrawer2.bind(this,"left",!0),color:"inherit","aria-label":"menu"},n.createElement(pe.Z,null)),n.createElement(x.Z,{container:!0,className:"headerInput"},n.createElement(x.Z,{item:!0,xs:3},n.createElement(W.Z,{className:this.state.classes.formControl},n.createElement(z.Z,{style:{paddingBottom:2}},"Город"),n.createElement(H.Z,{style:{marginTop:9},value:this.state.city,onChange:this.changeCity.bind(this)},this.state.cityList.map((function(e,t){return n.createElement(J.Z,{key:t,value:e.id},e.name)}))))),n.createElement(x.Z,{item:!0,xs:6,style:{display:"flex",alignItems:"center"}},n.createElement(j.ZP,{freeSolo:!0,label:"Промокод",variant:"outlined",size:"small",id:"promo_name",style:{minWidth:200,marginRight:8},value:this.state.promo_name,onChange:function(e,r){console.log(r),t.setState({promo_name:r})},onBlur:this.checkPromo.bind(this),options:this.state.MyPromos.map((function(e){return e.promo})),renderInput:function(e){return n.createElement(B.Z,(0,h.Z)({},e,{label:"Промокод",margin:"normal",variant:"outlined"}))}}),n.createElement(be,{placement:"bottom",title:n.createElement(n.Fragment,null,n.createElement(S.Z,{color:"inherit",className:this.state.classes.size1},this.state.orderPromoText))},n.createElement(_.Z,{variant:"contained",color:"primary",style:{padding:"2px 6px",marginTop:8,minWidth:30,marginRight:8,backgroundColor:!1===this.state.promoST&&0==this.state.orderPromoText.length?"gray":!1===this.state.promoST&&this.state.orderPromoText.length>0?"red":"green"}},"?")),n.createElement(_.Z,{variant:"contained",color:"primary",className:"btnClear",style:{padding:"2px 6px",minWidth:30,marginTop:8},onClick:this.clear.bind(this)},n.createElement(ee.Z,null))),n.createElement(x.Z,{item:!0,xs:3,style:{paddingTop:14}},n.createElement(B.Z,{label:"Телефон",variant:"outlined",size:"small",placeholder:"8 (999) 999-99-99",value:this.state.number,onChange:function(e){return t.setState({number:e.target.value})},onBlur:this.saveNumber.bind(this),style:{marginRight:4,marginLeft:4,marginBottom:6}}))))),n.createElement(fe.ZP,{anchor:"left",open:this.state.left,onClose:this.toggleDrawer2.bind(this,"left",!1)},n.createElement("div",{className:(0,y.Z)(this.state.classes.list),role:"presentation"},n.createElement(i.OL,{to:"/",style:{textDecoration:"none"}},n.createElement(E.Z,{button:!0,style:{color:"#000"}},n.createElement(S.Z,{variant:"body1"},"Оформить заказ"))),n.createElement(i.OL,{to:"/orders",style:{textDecoration:"none"}},n.createElement(E.Z,{button:!0,style:{color:"#000"}},n.createElement(S.Z,{variant:"body1"},"Список заказов"))),n.createElement(i.OL,{to:"/ordercook",style:{textDecoration:"none"}},n.createElement(E.Z,{button:!0,style:{color:"#000"}},n.createElement(S.Z,{variant:"body1"},"Заказы на кухне"))),n.createElement(he.Z,null),n.createElement(Z.Z,null,n.createElement(E.Z,{button:!0,onClick:this.logOut.bind(this)},n.createElement(I.Z,{primary:"Выйти"})))))):null),n.createElement(x.Z,{item:!0,xs:8,style:{padding:"24px 8px 0px 16px"}},n.createElement(k.Z,{style:{width:"100%"}},n.createElement(se.Z,{style:{maxHeight:350}},n.createElement(ae.Z,{stickyHeader:!0,"aria-label":"sticky table"},n.createElement(le.Z,null,n.createElement(ce.Z,null,n.createElement(oe.Z,null,"Наимнование"),n.createElement(oe.Z,{style:{textAlign:"center"}},"Кол-во"),n.createElement(oe.Z,null,"Сумма"),n.createElement(oe.Z,null," ",n.createElement(ee.Z,{style:{marginTop:5}})," "))),n.createElement(ie.Z,null,this.state.main_items.map((function(e,r){return n.createElement(we,{key:r,item:e,classes:t.state.classes,type:"main"})})),this.state.dop_items.map((function(e,r){return n.createElement(we,{key:r,item:e,classes:t.state.classes,type:"dop"})})),this.state.promo_items.map((function(e,r){return n.createElement(we,{key:r,item:e,classes:t.state.classes,type:"promo"})}))))))),n.createElement(x.Z,{item:!0,xs:4,style:{padding:"16px",marginTop:-50},className:"container"},n.createElement(P.Z,{value:this.state.activeTab,onChange:this.changeTab.bind(this),indicatorColor:"primary",textColor:"primary",centered:!0,style:{width:"100%",marginBottom:10}},n.createElement(O.Z,{label:"Доставка"}),n.createElement(O.Z,{label:"Самовывоз"}),n.createElement(O.Z,{label:"Адрес клиента"})),0==this.state.activeTab?this.state.all_addr.length>0?n.createElement(x.Z,{container:!0,spacing:3},n.createElement("div",{className:"mainAddr"},n.createElement(j.ZP,{freeSolo:!0,id:"newAddrStreet",style:{flex:3},value:this.state.newAddrStreet,onChange:function(e,r){t.setState({newAddrStreet:r})},onBlur:this.checkNewAddr.bind(this),options:this.state.all_addr.map((function(e){return e.value})),renderInput:function(e){return n.createElement(B.Z,(0,h.Z)({},e,{label:"Улица",margin:"normal",variant:"outlined"}))}}),n.createElement(B.Z,{label:"Дом",variant:"outlined",style:{margin:"16px 8px 8px 8px",flex:1},value:this.state.newAddrHome,onChange:function(e){return t.setState({newAddrHome:e.target.value})},onBlur:this.checkNewAddr.bind(this)})),n.createElement("div",{className:"otherAddr"},n.createElement(B.Z,{label:"Подъезд",variant:"outlined",style:{marginRight:4},value:this.state.pd,onChange:this.changeDataOther.bind(this,"pd"),onBlur:this.changeDataOther.bind(this,"pd")}),n.createElement(B.Z,{label:"Этаж",variant:"outlined",style:{marginRight:4,marginLeft:4},value:this.state.et,onBlur:this.changeDataOther.bind(this,"et"),onChange:this.changeDataOther.bind(this,"et")}),n.createElement(B.Z,{label:"Квартира",variant:"outlined",style:{marginRight:8,marginLeft:4},value:this.state.kv,onBlur:this.changeDataOther.bind(this,"kv"),onChange:this.changeDataOther.bind(this,"kv")})),n.createElement("div",{style:{width:"100%",marginRight:8}},n.createElement(L.Z,{disableElevation:!0,variant:"contained",className:"chooseDomTrue"},n.createElement(_.Z,{className:!0===this.state.newAddrDom?"active":"",onClick:this.changeDomTrue.bind(this,!0)},"Домофон работает"),n.createElement(_.Z,{className:!1===this.state.newAddrDom?"active":"",onClick:this.changeDomTrue.bind(this,!1)},"Домофон не работает")))):null:1==this.state.activeTab?this.state.pic_point.length>0?n.createElement(x.Z,{container:!0,direction:"column",justify:"space-between",alignItems:"stretch",spacing:3,className:"container",style:{paddingRight:8}},this.state.pic_point.map((function(e,r){return n.createElement(_.Z,{key:r,onClick:t.choosePic.bind(t,e),style:{backgroundColor:t.state.orderPic==e.id?"#6ab04c":"#e5e5e5",color:t.state.orderPic==e.id?"#fff":"#000"},className:"boxPic"},e.addr)}))):null:this.state.clientAddr.length>0?n.createElement(Z.Z,{component:"nav","aria-label":"main mailbox folders",style:{maxHeight:106,overflow:"auto",marginLeft:-13}},this.state.clientAddr.map((function(e,r){return n.createElement(E.Z,{button:!0,key:r,selected:t.state.chooseAddr===r,onClick:t.chooseAddr.bind(t,r,e),style:{paddingTop:0,paddingBottom:0}},n.createElement(I.Z,{primary:e.street+" "+e.home+(0==e.pd.length?"":", Пд. "+e.pd)+(0==e.et.length?"":", Эт. "+e.et)+(0==e.kv.length?"":", Кв. "+e.kv)}))}))):null,(0==this.state.activeTab||2==this.state.activeTab)&&this.state.all_addr.length>0?n.createElement(x.Z,{container:!0,spacing:3,style:{marginTop:12}},n.createElement("div",{className:"addrComment"},n.createElement(B.Z,(e={label:"Комментарий курьеру",variant:"outlined",multiline:!0,rowsMax:2},(0,u.Z)(e,"variant","outlined"),(0,u.Z)(e,"value",this.state.comment),(0,u.Z)(e,"onChange",this.changeData.bind(this,"comment")),e)),n.createElement(B.Z,{label:"Сдача",variant:"outlined",value:this.state.sdacha,onChange:this.changeData.bind(this,"sdacha")}))):null,this.state.date_pred.length>0?n.createElement(n.Fragment,null,n.createElement(x.Z,{container:!0,spacing:3,className:"container"},n.createElement(P.Z,{value:this.state.typeTime,onChange:this.changeTypeTime,style:{marginTop:15,width:"100%",marginBottom:10},indicatorColor:"primary",textColor:"primary",centered:!0},n.createElement(O.Z,{label:"По текущему"}),n.createElement(O.Z,{label:"Ко времени"}))),0==this.state.typeTime?n.createElement(x.Z,{container:!0,spacing:3,className:"container"},n.createElement(S.Z,{component:"span",style:{padding:"8px 0px",fontSize:"1rem"}},this.state.textAvgTime)):n.createElement(x.Z,{container:!0,spacing:3,className:"container"},n.createElement("div",{className:"formPred"},n.createElement(W.Z,{variant:"outlined",className:"formControl"},n.createElement(z.Z,null,"Дата"),n.createElement(H.Z,{value:this.state.date,onChange:this.changeData.bind(this,"date"),label:"Дата"},this.state.date_pred.map((function(e,t){return n.createElement(J.Z,{key:t,value:e.date},e.text)})))),n.createElement(W.Z,{variant:"outlined",className:"formControl"},n.createElement(z.Z,null,"Время"),n.createElement(H.Z,{value:this.state.time,onChange:this.changeData.bind(this,"time"),label:"Время"},this.state.timePred.map((function(e,t){return n.createElement(J.Z,{key:t,value:e.value},e.text)}))))))):null,n.createElement(x.Z,{container:!0,spacing:3,className:"container"},n.createElement("form",{className:"blockTotalOrder",noValidate:!0,autoComplete:"off",style:{width:"100%",marginRight:8,marginTop:3}},n.createElement("div",{style:{display:"flex",flexDirection:"column"}},n.createElement(S.Z,{variant:"h6",component:"span",style:{fontSize:"0.8rem",color:"#bababa"}},"Доставка: ",this.state.sumDiv," р"),n.createElement(S.Z,{variant:"h6",component:"span"},"К оплате: ",parseInt(this.state.AllPrice)+parseInt(this.state.sumDiv)," р")),n.createElement(_.Z,{variant:"contained",color:"primary",onClick:this.startOrderNext.bind(this)},"Оформить заказ")))),n.createElement(x.Z,{item:!0,xs:12,style:{padding:"16px 0px 0px 0px"}},this.state.cats.length>0&&this.state.allItems.length>0?n.createElement(n.Fragment,null,n.createElement(j.ZP,{freeSolo:!0,size:"small",style:{width:"30%",marginLeft:16,marginBottom:8},value:this.state.thisItem,onChange:this.addItemCustom.bind(this),options:this.state.allItems.map((function(e){return e.name})),renderInput:function(e){return n.createElement(B.Z,(0,h.Z)({},e,{label:"Все позиции",margin:"normal",variant:"outlined"}))}}),n.createElement(C.Z,{position:"static"},n.createElement(P.Z,{value:this.state.activeCat,onChange:this.changeCat,"aria-label":"simple tabs example"},this.state.cats.map((function(e,t){return n.createElement(O.Z,(0,h.Z)({label:e.name,style:{minWidth:"auto"},key:t},{id:"simple-tab-".concat(r=t),"aria-controls":"simple-tabpanel-".concat(r)}));var r})))),this.state.cats.map((function(e,r){return n.createElement(Te,{value:t.state.activeCat,index:r,key:r},n.createElement(x.Z,{container:!0,spacing:2,className:"container",style:{paddingTop:0}},e.items.map((function(e,r){return n.createElement(x.Z,{key:r,item:!0,xs:2},n.createElement(k.Z,{className:t.state.classes.paperCat,onClick:t.addToCart.bind(t,e.id)},n.createElement(x.Z,{container:!0,direction:"column",style:{height:"100%",justifyContent:"space-around"}},n.createElement(S.Z,{component:"span",className:t.state.classes.size1},e.name),n.createElement(S.Z,{component:"span",className:t.state.classes.size1},e.price," р."),n.createElement(be,{className:t.state.classes.paperCatInfo,placement:"top",title:n.createElement(n.Fragment,null,n.createElement(S.Z,{color:"inherit",className:t.state.classes.size1},e.tmp_desc),n.createElement(S.Z,{color:"inherit",className:t.state.classes.size1},e.info_weight))},n.createElement(R.Z,null)))))}))))}))):null),n.createElement(me.Z,{open:this.state.errorOpen,onClose:function(){return t.setState({errorOpen:!1})},className:"DialogErr"},n.createElement(S.Z,{variant:"h5",component:"span",className:"orderCheckTitle"},this.state.error.title),n.createElement(ee.Z,{className:"closeDialog",color:"inherit",onClick:function(){return t.setState({errorOpen:!1})}}),n.createElement(ge.Z,null,n.createElement(ve.Z,{className:"DialogErrText"},this.state.error.text)),n.createElement(ye.Z,null,n.createElement(L.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorder",onClick:function(){return t.setState({errorOpen:!1})}},n.createElement(_.Z,{variant:"contained",className:"BtnCardMain CardInCardItem"},"Хорошо")))),!0===this.state.orderCheck?n.createElement(me.Z,{open:this.state.orderCheck,fullWidth:!0,onClose:function(){return t.setState({orderCheck:!1})},className:"DialogOrderCheckDialog"},n.createElement(S.Z,{variant:"h5",component:"span",className:"orderCheckTitle"}," ",this.state.newOrder.typeOrder," #",this.state.newOrder.order_id," на ",this.state.newOrder.point_name),n.createElement(ee.Z,{className:"closeDialog",color:"inherit",onClick:function(){return t.setState({orderCheck:!1})}}),n.createElement(ge.Z,{style:{display:"flex",flexDirection:"column"}},""!==this.state.newOrder.timePred?n.createElement(S.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Время предзаказа: ",this.state.newOrder.timePred):n.createElement(S.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Время ожидания: ",this.state.newOrder.time_wait),"Доставка"==this.state.newOrder.typeOrder?n.createElement(S.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Доставка: ",this.state.newOrder.addr?this.state.newOrder.addr.street+" "+this.state.newOrder.addr.home+(0==this.state.newOrder.addr.pd.length?"":", Пд. "+this.state.newOrder.addr.pd)+(0==this.state.newOrder.addr.et.length?"":", Эт. "+this.state.newOrder.addr.et)+(0==this.state.newOrder.addr.kv.length?"":", Кв. "+this.state.newOrder.addr.kv):null):n.createElement(S.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Самовывоз: ",this.state.newOrder.point_name),"Доставка"==this.state.newOrder.typeOrder&&this.state.newOrder.addr&&1==parseInt(this.state.newOrder.addr.dom_true)?n.createElement(S.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Домофон не работает"):null,n.createElement(S.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Номер телефона: ",this.state.newOrder.number),this.state.newOrder.promoName?n.createElement(S.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Промокод: ",this.state.newOrder.promoName):null,"Доставка"==this.state.newOrder.typeOrder&&this.state.newOrder.comment.length>0?n.createElement(S.Z,{variant:"h5",component:"span",className:"nameSdacha orderCheckText"},"Комментарий: ",this.state.newOrder.comment):null,"Доставка"==this.state.newOrder.typeOrder&&this.state.newOrder.sdacha.length>0?n.createElement(S.Z,{variant:"h5",component:"span",className:"nameSdacha orderCheckText"},"Сдача с: ",this.state.newOrder.sdacha,"р"):null,"Доставка"==this.state.newOrder.typeOrder?null:this.state.newOrder.dop_text.length>0?n.createElement(S.Z,{variant:"h5",component:"span",style:{fontWeight:"bold"},className:"nameSdacha orderCheckText"},this.state.newOrder.dop_text):null,n.createElement("table",{className:"tableOrderCheck"},n.createElement("tbody",null,this.state.newOrder.cart.map((function(e,t){return parseInt(e.count)>0?n.createElement("tr",{key:t},n.createElement("td",{style:{width:"60%"}},n.createElement(S.Z,{variant:"h5",component:"span",className:"orderCheckText"},e.name)),n.createElement("td",null,n.createElement(S.Z,{variant:"h5",component:"span",className:"orderCheckText"},e.count)),n.createElement("td",null,n.createElement(S.Z,{variant:"h5",component:"span",className:"namePrice orderCheckText"},e.new_full_price?e.new_full_price:e.full_price," р"))):null})),"Доставка"==this.state.newOrder.typeOrder?n.createElement("tr",null,n.createElement("td",{style:{width:"60%"}},n.createElement(S.Z,{variant:"h5",component:"span",className:"orderCheckText"},"Доставка")),n.createElement("td",null,n.createElement(S.Z,{variant:"h5",component:"span",className:"orderCheckText"},"1")),n.createElement("td",null,n.createElement(S.Z,{variant:"h5",component:"span",className:"namePrice orderCheckText"},X.getSumDiv()," р"))):null),n.createElement("tfoot",null,n.createElement("tr",null,n.createElement("td",{colSpan:"2"},n.createElement(S.Z,{variant:"h5",component:"span",className:"orderCheckText bold"},"Сумма заказа")),n.createElement("td",null,n.createElement(S.Z,{variant:"h5",component:"span",className:"namePrice orderCheckText"},parseInt(this.state.AllPrice)+parseInt(this.state.sumDiv)," р")))))),n.createElement(ye.Z,{style:{padding:"12px 24px",paddingBottom:24}},n.createElement(L.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorder",style:{width:"100%"},onClick:this.trueOrder.bind(this)},n.createElement(_.Z,{variant:"contained",style:{width:"100%"},className:"BtnCardMain CardInCardItem"},"Подтвердить заказ")))):null)}}]),r}(n.Component);function Ce(){var e=Ie();return n.createElement("div",{className:e.root},n.createElement(xe,{classes:e}))}var Se=r(6083),ke=r(553),Pe=r(1846),Oe=r(7162),De=r(8523),Ae=r(9300),Ne=r(7827),Me=r(8736);r(6627);var Re=r(7563),je=(0,v.Z)((function(e){return{tooltip:{backgroundColor:"#f5f5f9",color:"rgba(0, 0, 0, 0.87)",maxWidth:220,fontSize:e.typography.pxToRem(12),border:"1px solid #dadde9"}}}))(M.ZP),Be=function(e){(0,c.Z)(p,e);var t,r,a=(t=p,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.Z)(t);if(r){var a=(0,d.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,m.Z)(this,e)});function p(e){var t;return(0,o.Z)(this,p),t=a.call(this,e),(0,u.Z)((0,l.Z)(t),"componentDidMount",(function(){t._isMounted=!0;var e="";if(localStorage.getItem("clientNumber")&&(e=localStorage.getItem("clientNumber"),X.clientNumber=e,t.setState({number:e})),localStorage.getItem("promo_name")){var r=localStorage.getItem("promo_name");setTimeout((function(){t.setState({promo_name:r}),t.checkPromo({target:{value:r}})}),500)}(0,F.EH)((function(){X.getCity(),X.getCartData();var e=X.dateTimeDel;if(setTimeout((function(){e=X.dateTimeDel,t.state.thisDateTimeDel!=e&&(t.setState({thisDateTimeDel:e}),t.setState({number:"",promo_name:"",orderPromoText:""}),t.clear2())}),300),t.state.promo_name&&t.state.promo_name.length>0&&t.checkPromo({target:{value:t.state.promo_name}}),X.updateMyPromos!=t.state.updateMyPromos){var r=X.getMyPromos(),n=[],a=b()(new Date).add(-7,"days").format("YYYY-MM-DD");r=r.filter((function(e){return e.date>=a})),localStorage.setItem("MyPromos",JSON.stringify(r)),r.forEach((function(e){var t=n.find((function(t){return t.promo==e.promo}));t&&0!=t.length?n.forEach((function(t,r){t.promo==e.promo&&n[r].count++})):(e.count=1,n.push(e))})),n=n.filter((function(e){return e.count>1})),t.setState({updateMyPromos:X.updateMyPromos,MyPromos:n})}!0===X.clear&&(t.clear(),X.clear=!1)}))})),t.state={classes:t.props.classes,cityList:t.props.cityList,city:X.getCity(),page:t.props.page,updateMyPromos:null,MyPromos:[],number:"",orderPromoText:"",promo_name:"",promoST:!1,top:!1,left:!1,bottom:!1,right:!1,thisDateTimeDel:null},t}return(0,s.Z)(p,[{key:"saveNumber",value:function(e){var t=e.target.value,r="";(t+="").length>0&&("7"!=(t=(t=(t=(t=(t=t.split(" ").join("")).split("(").join("")).split(")").join("")).split("-").join("")).split("+").join(""))[0]&&7!=t[0]||((r=t.split(""))[0]=8,t=r.join("")),11!=t.length)?alert("Номер введен в не верном формате!"):(this.setState({number:t}),X.clientNumber=t,localStorage.setItem("clientNumber",t))}},{key:"checkPromo",value:function(e){var t=this,r=e.target.value;console.log("promo",r),console.log("promo 555",e.target.value),fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Re.stringify({type:"get_promo",city_id:X.getCity(),promo_name:r})}).then((function(e){return e.json()})).then((function(e){X.setPromo(JSON.stringify(e),r);var n=X.checkPromo();!1===n.st&&localStorage.removeItem("promo_name"),0==r.length?(t.setState({orderPromoText:"",promo_name:"",promoST:!1}),localStorage.removeItem("promo_name")):t.setState({orderPromoText:n.text,promoST:n.st,promo_name:r})}))}},{key:"toggleDrawer2",value:function(e,t,r){this.setState((0,u.Z)({},e,t))}},{key:"clear",value:function(){var e=this;X.clientNumber="",localStorage.removeItem("clientNumber"),localStorage.removeItem("promo_name"),X.setItems([]);var t={orderType:"0",orderAddr:"",orderPic:0,orderComment:"",orderTimes:0,orderPredDay:"",orderPredTime:"",orderPay:"",orderSdacha:"",dateTime:new Date};X.dateTimeDel=new Date,X.saveCartData(t),setTimeout((function(){X.setPromo(null,""),e.checkPromo({target:{value:""}})}),300),this.setState({number:"",promo_name:"",orderPromoText:""})}},{key:"clear2",value:function(){var e=this;X.clientNumber="",localStorage.removeItem("clientNumber"),localStorage.removeItem("promo_name"),X.setItems([]);var t={orderType:"0",orderAddr:"",orderPic:0,orderComment:"",orderTimes:0,orderPredDay:"",orderPredTime:"",orderPay:"",orderSdacha:"",dateTime:new Date};X.saveCartData(t),setTimeout((function(){X.setPromo(null,""),e.checkPromo({target:{value:""}})}),300),this.setState({number:"",promo_name:"",orderPromoText:""})}},{key:"changeCity",value:function(e){var t=e.target.value;this.setState({city:t}),X.setCity(t),localStorage.setItem("cityID",t),X.saveCartData({orderType:"0",orderAddr:"",orderPic:0,orderComment:"",orderTimes:0,orderPredDay:"",orderPredTime:"",orderPay:"",orderSdacha:""}),setTimeout((function(){}),500)}},{key:"logOut",value:function(){localStorage.removeItem("token"),setTimeout((function(){window.location.reload()}),500)}},{key:"render",value:function(){var e=this;return n.createElement("div",{className:this.state.classes.root},n.createElement(C.Z,{position:"static",style:{backgroundColor:"#fff",color:"#000"}},n.createElement(de.Z,{style:{minHeight:48,height:48}},n.createElement(ue.Z,{edge:"start",onClick:this.toggleDrawer2.bind(this,"left",!0),color:"inherit","aria-label":"menu"},n.createElement(pe.Z,null)),"createOrder"==this.state.page?n.createElement(x.Z,{container:!0,className:"headerInput"},n.createElement(x.Z,{item:!0,xs:3},n.createElement(W.Z,{className:this.state.classes.formControl},n.createElement(z.Z,{style:{paddingBottom:2}},"Город"),n.createElement(H.Z,{style:{marginTop:9},value:this.state.city,onChange:this.changeCity.bind(this)},this.state.cityList.map((function(e,t){return n.createElement(J.Z,{key:t,value:e.id},e.name)}))))),n.createElement(x.Z,{item:!0,xs:6,style:{display:"flex",alignItems:"center"}},n.createElement(j.ZP,{freeSolo:!0,label:"Промокод",variant:"outlined",size:"small",style:{minWidth:200,marginRight:8},value:this.state.promo_name,onChange:function(t,r){console.log(r),e.setState({promo_name:r})},onBlur:this.checkPromo.bind(this),options:this.state.MyPromos.map((function(e){return e.promo})),renderInput:function(e){return n.createElement(B.Z,(0,h.Z)({},e,{label:"Промокод",margin:"normal",variant:"outlined"}))}}),n.createElement(je,{placement:"bottom",title:n.createElement(n.Fragment,null,n.createElement(S.Z,{color:"inherit",className:this.state.classes.size1},this.state.orderPromoText))},n.createElement(_.Z,{variant:"contained",color:"primary",style:{padding:"2px 6px",marginTop:8,minWidth:30,marginRight:8,backgroundColor:!1===this.state.promoST&&0==this.state.orderPromoText.length?"gray":!1===this.state.promoST&&this.state.orderPromoText.length>0?"red":"green"}},"?")),n.createElement(_.Z,{variant:"contained",color:"primary",className:"btnClear",style:{padding:"2px 6px",minWidth:30,marginTop:8},onClick:this.clear.bind(this)},n.createElement(ee.Z,null))),n.createElement(x.Z,{item:!0,xs:3,style:{paddingTop:14}},n.createElement(B.Z,{label:"Телефон",variant:"outlined",size:"small",placeholder:"8 (999) 999-99-99",value:this.state.number,onChange:function(t){return e.setState({number:t.target.value})},onBlur:this.saveNumber.bind(this),style:{marginRight:4,marginLeft:4,marginBottom:6}}))):null)),n.createElement(fe.ZP,{anchor:"left",open:this.state.left,onClose:this.toggleDrawer2.bind(this,"left",!1)},n.createElement("div",{className:(0,y.Z)(this.state.classes.list),role:"presentation"},n.createElement(i.OL,{to:"/",style:{textDecoration:"none"}},n.createElement(E.Z,{button:!0,style:{color:"#000"}},n.createElement(S.Z,{variant:"body1"},"Оформить заказ"))),n.createElement(i.OL,{to:"/orders",style:{textDecoration:"none"}},n.createElement(E.Z,{button:!0,style:{color:"#000"}},n.createElement(S.Z,{variant:"body1"},"Список заказов"))),n.createElement(i.OL,{to:"/ordercook",style:{textDecoration:"none"}},n.createElement(E.Z,{button:!0,style:{color:"#000"}},n.createElement(S.Z,{variant:"body1"},"Заказы на кухне"))),n.createElement(he.Z,null),n.createElement(Z.Z,null,n.createElement(E.Z,{button:!0,onClick:this.logOut.bind(this)},n.createElement(I.Z,{primary:"Выйти"}))))))}}]),p}(n.Component),Le=["children","value","index"];var ze=r(7563),Je=(0,g.Z)((function(e){return{root2:{display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"center","& > svg, form":{borderRight:"0px!important"}},root3:{"& > *":{margin:e.spacing(1),width:50},"& .MuiOutlinedInput-input":{padding:"5px 10px"}},list:{width:250},fullList:{width:"auto"},root:{flexGrow:1},title:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary},paperCat:{padding:e.spacing(1),textAlign:"center",color:e.palette.text.secondary,position:"relative",justifyContent:"space-between",height:"calc(100% - 15px)",cursor:"pointer"},paperCatInfo:{position:"absolute",top:0,right:0},size1:{fontSize:"0.8rem"},scrollTable:{maxHeight:250,overflow:"auto",padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}}));function We(e){var t=e.children,r=e.value,a=e.index,i=(0,f.Z)(e,Le);return n.createElement("div",(0,h.Z)({role:"tabpanel",hidden:r!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},i),r===a&&n.createElement(N.Z,{p:3},t))}function He(e){var t=new Date(e),r=""+(t.getMonth()+1),n=""+t.getDate(),a=t.getFullYear();return r.length<2&&(r="0"+r),n.length<2&&(n="0"+n),[a,r,n].join("-")}We.propTypes={children:A().node,index:A().any.isRequired,value:A().any.isRequired};var Ye=function(e){(0,c.Z)(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.Z)(t);if(r){var a=(0,d.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,m.Z)(this,e)});function i(e){var t;return(0,o.Z)(this,i),t=a.call(this,e),(0,u.Z)((0,l.Z)(t),"interval",null),(0,u.Z)((0,l.Z)(t),"componentDidMount",(function(){t.interval=setInterval((function(){return t.checkLogin()}),36e5),t.checkLogin(),fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:ze.stringify({type:"get_cat_center",city_id:1})}).then((function(e){return e.json()})).then((function(e){t.setState({cityList:e.city_list}),X.setAllItems(e.all_items),t.getPoints()})).catch((function(e){}))})),(0,u.Z)((0,l.Z)(t),"changeCat",(function(e,r){var n=t.state.points.find((function(e,t){return t==r}));t.setState({activeCat:r,point:n}),t.getOrders()})),(0,u.Z)((0,l.Z)(t),"changeAddr",(function(e){t.setState({typeDel:e.target.value})})),t.state={classes:t.props.classes,cityList:[],spiner:!1,selectedCity:1,selectedDate:He(new Date),points:[],point:null,activeCat:0,orders:[],orderCheck:!1,showOrder:null,openDialog:!1,delOrder:!1,radiogroup_options:[{id:"0",label:"Решили отредактировать заказ",value:0},{id:"1",label:"Не устраивает время ожидания",value:0},{id:"2",label:"Изменились планы",value:0},{id:"3",label:"Недостаточно средств",value:0},{id:"4",label:"Другое",value:0}],textDel:"",typeDel:-1,number:""},t}return(0,s.Z)(i,[{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"checkLogin",value:function(){var e=this;fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:ze.stringify({type:"check_login_center",token:X.getToken()})}).then((function(e){return e.json()})).then((function(t){!0===t||(localStorage.removeItem("token"),clearInterval(e.interval),setTimeout((function(){window.location.href="/auth"}),500))})).catch((function(e){}))}},{key:"handleDateChange",value:function(e){var t=this;this.setState({selectedDate:He(e)}),setTimeout((function(){t.getOrders()}),500)}},{key:"changeCity",value:function(e){var t=this,r=e.target.value;this.setState({selectedCity:r}),setTimeout((function(){t.getPoints()}),500)}},{key:"getPoints",value:function(){var e=this;fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:ze.stringify({type:"get_points",city_id:this.state.selectedCity})}).then((function(e){return e.json()})).then((function(t){e.setState({points:t,point:t[0]}),setTimeout((function(){e.getOrders()}),500)})).catch((function(e){}))}},{key:"getOrders",value:function(){var e=this;setTimeout((function(){fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:ze.stringify({type:"get_orders",city_id:e.state.selectedCity,point_id:e.state.point.id,date:e.state.selectedDate})}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({orders:t.orders}),setTimeout((function(){e.changeNumber()}),100)})).catch((function(e){}))}),500)}},{key:"getOrder",value:function(e){var t=this;fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:ze.stringify({type:"get_order",point_id:this.state.point.id,order_id:e})}).then((function(e){return e.json()})).then((function(e){console.log(e),t.setState({showOrder:e,openDialog:!0})})).catch((function(e){}))}},{key:"closeDialog",value:function(){this.setState({openDialog:!1})}},{key:"closeOrder",value:function(e,t){this.setState({delOrder:!0})}},{key:"closeOrderTrue",value:function(){var e=this,t=this.state.radiogroup_options.find((function(t){return t.id==e.state.typeDel}));"4"==t.id&&(t.label=this.state.textDel),confirm("Отменить заказ #"+this.state.showOrder.order.order_id)&&fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:ze.stringify({type:"close_order_center",typeCreate:"center",user_id:X.getToken(),order_id:this.state.showOrder.order.order_id,point_id:this.state.showOrder.order.point_id,ans:t.label})}).then((function(e){return e.json()})).then((function(t){console.log(t),setTimeout((function(){t.st?(e.setState({delOrder:!1,openDialog:!1}),e.getOrders()):alert(t.text)}),300)}))}},{key:"repeatOrder",value:function(){var e=[],t=X.getAllItems(),r=null;localStorage.setItem("cityID",this.state.selectedCity),this.state.showOrder.order_items.map((function(n){if(r=t.find((function(e){return e.id==n.item_id}))){var a=parseInt(r.price),i=parseInt(n.count)*parseInt(r.price);e.push({name:n.name,item_id:n.item_id,count:n.count,one_price:a,all_price:i})}}));var n={orderType:parseInt(this.state.showOrder.order.type_order_)-1,orderAddr:this.state.showOrder.street.name,orderPic:parseInt(this.state.showOrder.order.point_id),orderComment:"",orderTimes:"1",orderPredDay:"",orderPredTime:"",orderPay:1==parseInt(this.state.showOrder.order.type_order_)?"cash":"in",orderSdacha:""};X.saveCartData(n),this.state.showOrder.order.promo_name&&""!=this.state.showOrder.order.promo_name&&X.setPromo(this.state.showOrder.promo_info,this.state.showOrder.order.promo_name),X.setItems(e),setTimeout((function(){window.location.pathname="/"}),500)}},{key:"changeText",value:function(e){this.setState({textDel:e.target.value})}},{key:"changeNumber",value:function(){var e=document.querySelectorAll(".order"),t=this.state.number;0==t.length?e.forEach((function(e){e.classList.remove("dis_none")})):e.forEach((function(e){e.getAttribute("datanumber").indexOf(t)>=0?e.classList.remove("dis_none"):e.classList.add("dis_none")}))}},{key:"render",value:function(){var e=this;return n.createElement(x.Z,{container:!0,spacing:0},n.createElement(w.q,null,n.createElement("title",null,"Оформленные заказы")),n.createElement(re.Z,{open:this.state.spiner,style:{zIndex:99,color:"#fff"}},n.createElement(ne.Z,{color:"inherit"})),n.createElement(x.Z,{item:!0,xs:12},this.state.cityList.length>0?n.createElement(Be,{classes:this.state.classes,cityList:this.state.cityList,page:"statOrder"}):null),n.createElement(x.Z,{item:!0,xs:4},n.createElement(Ne.M,{utils:Ae.Z,locale:De.Z},n.createElement(x.Z,{container:!0,justify:"space-around",style:{alignItems:"baseline"}},n.createElement(W.Z,{className:this.state.classes.formControl},n.createElement(z.Z,null,"Город"),n.createElement(H.Z,{value:this.state.selectedCity,onChange:this.changeCity.bind(this)},this.state.cityList.map((function(e,t){return n.createElement(J.Z,{key:t,value:e.id},e.name)})))),n.createElement(Me.e,{disableToolbar:!0,variant:"inline",format:"yyyy-MM-dd",margin:"normal",id:"date-picker-inline",label:"Дата",value:this.state.selectedDate,onChange:this.handleDateChange.bind(this),KeyboardButtonProps:{"aria-label":"change date"}})))),n.createElement(x.Z,{item:!0,xs:3},n.createElement(B.Z,{label:"Номер телефона",style:{margin:"16px 8px 8px 8px",flex:1},value:this.state.number,onChange:function(t){return e.setState({number:t.target.value})},onBlur:this.changeNumber.bind(this)})),n.createElement(x.Z,{item:!0,xs:12},n.createElement(C.Z,{position:"static"},n.createElement(P.Z,{value:this.state.activeCat,onChange:this.changeCat,"aria-label":"simple tabs example"},this.state.points.map((function(e,t){return n.createElement(O.Z,(0,h.Z)({label:e.addr,style:{minWidth:"auto"},key:t},{id:"simple-tab-".concat(r=t),"aria-controls":"simple-tabpanel-".concat(r)}));var r})))),this.state.points.map((function(t,r){return n.createElement(We,{value:e.state.activeCat,index:r,key:r},n.createElement(se.Z,null,n.createElement(ae.Z,null,n.createElement(le.Z,null,n.createElement(ce.Z,null,n.createElement(oe.Z,null,"#"),n.createElement(oe.Z,null,"Оформил"),n.createElement(oe.Z,null,"Телефон"),n.createElement(oe.Z,null,"Адрес"),n.createElement(oe.Z,null,"Оформлен"),n.createElement(oe.Z,null,"Ко времени"),n.createElement(oe.Z,null,"Закрыт на кухне"),n.createElement(oe.Z,null,"Получен клиентом"),n.createElement(oe.Z,null,"Тип"),n.createElement(oe.Z,null,"Статус"),n.createElement(oe.Z,null,"Сумма"),n.createElement(oe.Z,null,"Оплата"),n.createElement(oe.Z,null,"Курьер"))),n.createElement(ie.Z,null,e.state.orders.map((function(t,r){return n.createElement(ce.Z,{key:r,className:"order",id:t.id,datanumber:t.number,style:1==t.is_delete?{backgroundColor:"red",color:"#fff"}:{}},n.createElement(oe.Z,{style:{color:"inherit",cursor:"pointer"},onClick:e.getOrder.bind(e,t.id)},t.id),n.createElement(oe.Z,{style:{color:"inherit"}},t.type_user),n.createElement(oe.Z,{style:{color:"inherit"}},t.number),n.createElement(oe.Z,{style:{color:"inherit"}},t.street," ",t.home),n.createElement(oe.Z,{style:{color:"inherit"}},t.date_time_order),n.createElement(oe.Z,{style:{color:"inherit"}},"00:00:00"==t.date_time_preorder?"":t.date_time_preorder),n.createElement(oe.Z,{style:{color:"inherit"}},"00:00:00"==t.give_data_time?"":t.give_data_time),n.createElement(oe.Z,{style:{color:"inherit"}},t.close_order),n.createElement(oe.Z,{style:{color:"inherit"}},t.type_order),n.createElement(oe.Z,{style:{color:"inherit"}},t.status),n.createElement(oe.Z,{style:{color:"inherit"}},t.order_price),n.createElement(oe.Z,{style:{color:"inherit"}},t.type_pay),n.createElement(oe.Z,{style:{color:"inherit"}},t.driver))}))))))}))),this.state.showOrder?n.createElement(me.Z,{onClose:this.closeDialog.bind(this),"aria-labelledby":"customized-dialog-title",className:"showOrderDialog",open:this.state.openDialog,fullWidth:!0},n.createElement(Se.Z,{disableTypography:!0,style:{margin:0,padding:8}},n.createElement(S.Z,{variant:"h6"},"Заказ ",this.state.showOrder.order.order_id),n.createElement(ue.Z,{"aria-label":"close",style:{position:"absolute",top:0,right:0,color:"#000"},onClick:this.closeDialog.bind(this)},n.createElement(ee.Z,null))),n.createElement(ge.Z,{className:"showOrderDialogContent"},n.createElement(S.Z,{variant:"h6",component:"span"},this.state.showOrder.order.type_order,": ",this.state.showOrder.order.type_order_addr_new),n.createElement(S.Z,{variant:"h6",component:"span"},this.state.showOrder.order.time_order_name,": ",this.state.showOrder.order.time_order),n.createElement(x.Z,{container:!0,spacing:0},this.state.showOrder.order.number.length>1?n.createElement(x.Z,{item:!0,xs:12},n.createElement(S.Z,{variant:"h6",component:"b"},"Телефон: "),n.createElement(S.Z,{variant:"h6",component:"span"},this.state.showOrder.order.number)):null),this.state.showOrder.order.delete_reason.length>0?n.createElement(S.Z,{variant:"h6",component:"span",style:{color:"red"}},"Удален: ",this.state.showOrder.order.date_time_delete):null,this.state.showOrder.order.delete_reason.length>0?n.createElement(S.Z,{variant:"h6",component:"span",style:{color:"red"}},this.state.showOrder.order.delete_reason):null,1==parseInt(this.state.showOrder.order.is_preorder)?null:n.createElement(S.Z,{variant:"h6",component:"span"},this.state.showOrder.order.text_time,this.state.showOrder.order.time_to_client),n.createElement(S.Z,{variant:"h6",component:"span"},this.state.showOrder.order.textTime),n.createElement(x.Z,{container:!0,spacing:0},null==this.state.showOrder.order.promo_name||0==this.state.showOrder.order.promo_name.length?null:n.createElement(n.Fragment,null,n.createElement(x.Z,{item:!0,xs:12},n.createElement(S.Z,{variant:"h6",component:"b"},"Промокод: "),n.createElement(S.Z,{variant:"h6",component:"span"},this.state.showOrder.order.promo_name)),n.createElement(x.Z,{item:!0,xs:12},n.createElement(S.Z,{variant:"h6",component:"span",className:"noSpace"},this.state.showOrder.order.promo_text))),null==this.state.showOrder.order.comment||0==this.state.showOrder.order.comment.length?null:n.createElement(x.Z,{item:!0,xs:12},n.createElement(S.Z,{variant:"h6",component:"b"},"Комментарий: "),n.createElement(S.Z,{variant:"h6",component:"span"},this.state.showOrder.order.comment)),null==this.state.showOrder.order.sdacha||0==parseInt(this.state.showOrder.order.sdacha)?null:n.createElement(x.Z,{item:!0,xs:12},n.createElement(S.Z,{variant:"h6",component:"b"},"Сдача: "),n.createElement(S.Z,{variant:"h6",component:"span"},this.state.showOrder.order.sdacha))),n.createElement("table",{className:"tableOrderCheck"},n.createElement("tbody",null,this.state.showOrder.order_items.map((function(e,t){return n.createElement("tr",{key:t},n.createElement("td",null,n.createElement(S.Z,{variant:"h5",component:"span"},e.name)),n.createElement("td",null,n.createElement(S.Z,{variant:"h5",component:"span"},e.count)),n.createElement("td",null,n.createElement(S.Z,{variant:"h5",component:"span"},e.price," р")))})),1==parseInt(this.state.showOrder.order.type_order_)?n.createElement("tr",null,n.createElement("td",null,n.createElement(S.Z,{variant:"h5",component:"span"},"Доставка")),n.createElement("td",null,n.createElement(S.Z,{variant:"h5",component:"span"})),n.createElement("td",null,n.createElement(S.Z,{variant:"h5",component:"span"},this.state.showOrder.order.sum_div," р"))):null),n.createElement("tfoot",null,n.createElement("tr",null,n.createElement("th",{style:{textAlign:"left"}},n.createElement(S.Z,{variant:"h5",component:"span"},"Сумма закза")),n.createElement("td",null,n.createElement(S.Z,{variant:"h5",component:"span"})),n.createElement("th",{style:{textAlign:"left"}},n.createElement(S.Z,{variant:"h5",component:"span"},this.state.showOrder.order.sum_order," р")))))),0==parseInt(this.state.showOrder.order.is_delete)&&6!==parseInt(this.state.showOrder.order.status_order)?n.createElement(ye.Z,{style:{justifyContent:"flex-end",padding:"15px 0px"}},n.createElement(L.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorderOther",style:{marginRight:24}},n.createElement(_.Z,{variant:"contained",className:"BtnCardMain CardInCardItem",onClick:this.closeOrder.bind(this,this.state.showOrder.order.order_id,this.state.showOrder.order.point_id)},"Отменить заказ"))):null,1==parseInt(this.state.showOrder.order.is_delete)||6==parseInt(this.state.showOrder.order.status_order)?n.createElement(ye.Z,{style:{justifyContent:"flex-end",padding:"15px 0px"}},n.createElement(L.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorderOther",style:{marginRight:24}},n.createElement(_.Z,{variant:"contained",className:"BtnCardMain CardInCardItem",onClick:this.repeatOrder.bind(this,this.state.showOrder.order.order_id,this.state.showOrder.order.point_id)},"Повторить заказ"))):null):null,this.state.showOrder?n.createElement(me.Z,{open:this.state.delOrder,onClose:function(){e.setState({delOrder:!1})},"aria-labelledby":"form-dialog-title"},n.createElement(Se.Z,{disableTypography:!0,style:{margin:0,padding:8}},n.createElement(S.Z,{variant:"h6"},"Отмена заказа ",this.state.showOrder.order.order_id),n.createElement(ue.Z,{"aria-label":"close",style:{position:"absolute",top:0,right:0,color:"#000"},onClick:function(){e.setState({delOrder:!1})}},n.createElement(ee.Z,null))),n.createElement(ge.Z,null,n.createElement(W.Z,{component:"fieldset"},n.createElement(Oe.Z,{name:"typeDel",value:this.state.typeDel,onChange:this.changeAddr},this.state.radiogroup_options.map((function(e,t){return n.createElement(ke.Z,{key:t,value:e.id,control:n.createElement(Pe.Z,null),label:e.label})})))),n.createElement(B.Z,{onFocus:function(){e.setState({typeDel:"4"})},value:this.state.textDel,onChange:this.changeText.bind(this),margin:"dense",id:"name",label:"Причина отмены",type:"text",fullWidth:!0})),n.createElement(ye.Z,{style:{paddingBottom:24}},n.createElement(L.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorderOther",style:{marginRight:24}},n.createElement(_.Z,{variant:"contained",className:"BtnCardMain CardInCardItem",onClick:function(){e.setState({delOrder:!1})}},"К заказу")),n.createElement(L.Z,{disableElevation:!0,disableRipple:!0,variant:"contained",className:"BtnBorderOther",style:{marginRight:24}},n.createElement(_.Z,{variant:"contained",className:"BtnCardMain CardInCardItem",onClick:this.closeOrderTrue.bind(this)},"Отменить заказ")))):null)}}]),i}(n.Component);function Fe(){var e=Je();return n.createElement("div",{className:e.root},n.createElement(Ye,{classes:e}))}var Ue=r(5685);var qe=r(7563),Ke=(0,g.Z)((function(e){return{root2:{display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"center","& > svg, form":{borderRight:"0px!important"}},root3:{"& > *":{margin:e.spacing(1),width:50},"& .MuiOutlinedInput-input":{padding:"5px 10px"}},list:{width:250},fullList:{width:"auto"},root:{flexGrow:1},title:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary},paperCat:{padding:e.spacing(1),textAlign:"center",color:e.palette.text.secondary,position:"relative",justifyContent:"space-between",height:"calc(100% - 15px)",cursor:"pointer"},paperCatInfo:{position:"absolute",top:0,right:0},size1:{fontSize:"0.8rem"},scrollTable:{maxHeight:250,overflow:"auto",padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}}));A().node,A().any.isRequired,A().any.isRequired;var Ge=function(e){(0,c.Z)(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.Z)(t);if(r){var a=(0,d.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,m.Z)(this,e)});function i(e){var t,r,n,s,c,m;return(0,o.Z)(this,i),t=a.call(this,e),(0,u.Z)((0,l.Z)(t),"interval",null),(0,u.Z)((0,l.Z)(t),"componentDidMount",(function(){t.setState({spiner:!0}),t.interval=setInterval((function(){return t.checkLogin()}),36e5),t.checkLogin(),fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:qe.stringify({type:"get_cat_center",city_id:1})}).then((function(e){return e.json()})).then((function(e){t.setState({cityList:e.city_list})})).catch((function(e){})),fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:qe.stringify({type:"get_points",city_id:1})}).then((function(e){return e.json()})).then((function(e){console.log(e),t.setState({points:e,point:e[0]}),setTimeout((function(){t.getCookOrders()}),500)})).catch((function(e){}))})),t.state={classes:t.props.classes,cityList:[],spiner:!1,data:[],selectedPoint:1,selectedDate:(r=new Date,n=new Date(r),s=""+(n.getMonth()+1),c=""+n.getDate(),m=n.getFullYear(),s.length<2&&(s="0"+s),c.length<2&&(c="0"+c),[m,s,c].join("-")),points:[],point:null,activeCat:0,orders:[],orderCheck:!1,showOrder:null,openDialog:!1,delOrder:!1,radiogroup_options:[{id:"0",label:"Решили отредактировать заказ",value:0},{id:"1",label:"Не устраивает время ожидания",value:0},{id:"2",label:"Изминились планы",value:0},{id:"3",label:"Недостаточно средств",value:0},{id:"4",label:"Другое",value:0}],textDel:"",typeDel:-1},t}return(0,s.Z)(i,[{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"checkLogin",value:function(){var e=this;fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:qe.stringify({type:"check_login_center",token:X.getToken()})}).then((function(e){return e.json()})).then((function(t){!0===t||(localStorage.removeItem("token"),clearInterval(e.interval),setTimeout((function(){window.location.href="/auth"}),500))})).catch((function(e){}))}},{key:"changePoint",value:function(e){var t=this,r=e.target.value;this.setState({selectedPoint:r}),setTimeout((function(){t.getCookOrders()}),500)}},{key:"getCookOrders",value:function(){var e=this;this.setState({spiner:!0}),fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:qe.stringify({type:"getCookOrders",point_id:this.state.selectedPoint})}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({data:t}),setTimeout((function(){e.setState({spiner:!1})}),500)})).catch((function(e){}))}},{key:"render",value:function(){return n.createElement(x.Z,{container:!0,spacing:0},n.createElement(w.q,null,n.createElement("title",null,"Заказы на кухне")),n.createElement(re.Z,{open:this.state.spiner,style:{zIndex:99,color:"#fff"}},n.createElement(ne.Z,{color:"inherit"})),n.createElement(x.Z,{item:!0,xs:12},this.state.cityList.length>0?n.createElement(Be,{classes:this.state.classes,cityList:this.state.cityList,page:"OrderCook"}):null),n.createElement(x.Z,{item:!0,xs:12,style:{display:"flex",alignItems:"center",justifyContent:"center"}},n.createElement(W.Z,{className:this.state.classes.formControl},n.createElement(z.Z,null,"Точка"),n.createElement(H.Z,{value:this.state.selectedPoint,onChange:this.changePoint.bind(this)},this.state.points.map((function(e,t){return n.createElement(J.Z,{key:t,value:e.id},e.addr)})))),n.createElement(_.Z,{variant:"contained",color:"primary",className:"btnClear",style:{padding:"2px 6px",minWidth:30},onClick:this.getCookOrders.bind(this)},n.createElement(Ue.Z,null))),n.createElement(x.Z,{item:!0,xs:12},n.createElement(se.Z,null,n.createElement(ae.Z,null,n.createElement(le.Z,null,n.createElement(ce.Z,null,n.createElement(oe.Z,null,"#"),n.createElement(oe.Z,null,"Тип"),n.createElement(oe.Z,null,"Статус"),n.createElement(oe.Z,null,"Время заказа / предзаказа"),n.createElement(oe.Z,null,"Время выхода на стол"),n.createElement(oe.Z,null,"Во сколько собрали"),n.createElement(oe.Z,null,"Закрыли"),n.createElement(oe.Z,null,"Приготовили"),n.createElement(oe.Z,null,"Отдали"),n.createElement(oe.Z,null,"Обещали"))),n.createElement(ie.Z,null,this.state.data.ready?this.state.data.ready.map((function(e,t){return n.createElement(ce.Z,{key:t,style:{backgroundColor:"green"}},n.createElement(oe.Z,{style:{color:"inherit"}},e.id),n.createElement(oe.Z,{style:{color:"inherit"}},e.type_order),n.createElement(oe.Z,{style:{color:"inherit"}},e.status),n.createElement(oe.Z,{style:{color:"inherit"}},1==parseInt(e.preorder)?e.date_time_preorder_:e.date_time_order),n.createElement(oe.Z,{style:{color:"inherit"}},e.unix_start_stol_or),n.createElement(oe.Z,{style:{color:"inherit"}},e.give_data_time_),n.createElement(oe.Z,{style:{color:"inherit"}},e.close_date_time_order),n.createElement(oe.Z,{style:{color:"inherit"}},e.time_),n.createElement(oe.Z,{style:{color:"inherit"}},e.test_time),n.createElement(oe.Z,{style:{color:"inherit"}},0==parseInt(e.preorder)?e.unix_time_to_client:""))})):null,this.state.data.onstol?this.state.data.onstol.map((function(e,t){return n.createElement(ce.Z,{key:t,style:{backgroundColor:"yellow"}},n.createElement(oe.Z,{style:{color:"inherit"}},e.id),n.createElement(oe.Z,{style:{color:"inherit"}},e.type_order),n.createElement(oe.Z,{style:{color:"inherit"}},e.status),n.createElement(oe.Z,{style:{color:"inherit"}},1==parseInt(e.preorder)?e.date_time_preorder_:e.date_time_order),n.createElement(oe.Z,{style:{color:"inherit"}},e.unix_start_stol_or),n.createElement(oe.Z,{style:{color:"inherit"}},e.give_data_time_),n.createElement(oe.Z,{style:{color:"inherit"}},e.close_date_time_order),n.createElement(oe.Z,{style:{color:"inherit"}},e.time_),n.createElement(oe.Z,{style:{color:"inherit"}},e.test_time),n.createElement(oe.Z,{style:{color:"inherit"}},0==parseInt(e.preorder)?e.unix_time_to_client:""))})):null,this.state.data.prestol_new?this.state.data.prestol_new.map((function(e,t){return n.createElement(ce.Z,{key:t},n.createElement(oe.Z,{style:{color:"inherit"}},e.id),n.createElement(oe.Z,{style:{color:"inherit"}},e.type_order),n.createElement(oe.Z,{style:{color:"inherit"}},e.status),n.createElement(oe.Z,{style:{color:"inherit"}},1==parseInt(e.preorder)?e.date_time_preorder:e.date_time_order),n.createElement(oe.Z,{style:{color:"inherit"}},e.time_start_order),n.createElement(oe.Z,{style:{color:"inherit"}},e.give_data_time_),n.createElement(oe.Z,{style:{color:"inherit"}},e.close_date_time_order),n.createElement(oe.Z,{style:{color:"inherit"}},e.time_),n.createElement(oe.Z,{style:{color:"inherit"}},e.test_time),n.createElement(oe.Z,{style:{color:"inherit"}},0==parseInt(e.preorder)?e.unix_time_to_client:""))})):null)))))}}]),i}(n.Component);function Ve(){var e=Ke();return n.createElement("div",{className:e.root},n.createElement(Ge,{classes:e}))}var Qe=r(8799);var Xe=r(7563),$e=function(e){(0,c.Z)(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.Z)(t);if(r){var a=(0,d.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,m.Z)(this,e)});function i(e){var t;return(0,o.Z)(this,i),t=a.call(this,e),(0,u.Z)((0,l.Z)(t),"componentDidMount",(function(){})),t.state={number:"",pass:""},t}return(0,s.Z)(i,[{key:"login",value:function(){fetch(G().urlApi,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Xe.stringify({type:"login_center",number:this.state.number,pass:this.state.pass})}).then((function(e){return e.json()})).then((function(e){e.st?(X.setToken(e.token,e.name),setTimeout((function(){window.location.href="/"}),500)):alert(e.text)}))}},{key:"handleKeyPress",value:function(e){13==e.charCode&&this.state.number.length>0&&this.state.pass.length>0&&this.login()}},{key:"render",value:function(){var e=this;return n.createElement(x.Z,{container:!0,direction:"column",justify:"center",alignItems:"center",style:{height:"100vh"}},n.createElement(x.Z,{container:!0,item:!0,xs:3},n.createElement("img",{alt:"Жако доставка роллов и пиццы",src:"../assets/logo.png",style:{height:"auto",width:"inherit"}})),n.createElement(x.Z,{container:!0,item:!0,xs:3,direction:"column"},n.createElement(W.Z,null,n.createElement(z.Z,{htmlFor:"my-input"},"Номер телефона"),n.createElement(Qe.Z,{id:"my-input",type:"login","aria-describedby":"my-helper-text",value:this.state.number,onChange:function(t){e.setState({number:t.target.value})},onKeyPress:this.handleKeyPress})),n.createElement(W.Z,null,n.createElement(z.Z,{htmlFor:"my-input2"},"Пароль"),n.createElement(Qe.Z,{id:"my-input2",type:"password","aria-describedby":"my-helper-text",value:this.state.pass,onChange:function(t){e.setState({pass:t.target.value})},onKeyPress:this.handleKeyPress})),n.createElement(W.Z,{style:{paddingTop:8}},n.createElement(_.Z,{variant:"contained",style:{backgroundColor:"#CC0033",color:"#fff"},onClick:this.login.bind(this)},"Войти"))))}}]),i}(n.Component),et=r(150);var tt={itemsStore:X};function rt(e){var t=e.code,r=e.children;return n.createElement(p.AW,{render:function(e){var n=e.staticContext;return n&&(n.status=t),r}})}function nt(){return n.createElement(rt,{code:404},n.createElement(x.Z,{container:!0,className:"Contact mainContainer MuiGrid-spacing-xs-3",style:{marginTop:64}},n.createElement(x.Z,{item:!0,xs:12},n.createElement(S.Z,{variant:"h5",component:"h1"},"404 Страница не найдена"))))}var at=function(e){(0,c.Z)(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.Z)(t);if(r){var a=(0,d.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,m.Z)(this,e)});function i(e){var t;return(0,o.Z)(this,i),t=a.call(this,e),(0,u.Z)((0,l.Z)(t),"componentDidMount",(function(){})),t.state={},t}return(0,s.Z)(i,[{key:"render",value:function(){return n.createElement(et.zt,tt,n.createElement(p.rs,null,n.createElement(p.AW,{path:"/",exact:!0,component:Ce}),n.createElement(p.AW,{path:"/orders",exact:!0,component:Fe}),n.createElement(p.AW,{path:"/ordercook",exact:!0,component:Ve}),n.createElement(p.AW,{path:"/auth",exact:!0,component:$e}),n.createElement(p.AW,{component:nt})))}}]),i}(n.Component);a.hydrate(n.createElement(i.VK,null,n.createElement(at,null)),document.getElementById("app"))},8811:e=>{e.exports={urlApi:"https://jacochef.ru/api/site/test_app.php"}},8293:(e,t,r)=>{var n={"./ru":1793,"./ru.js":1793};function a(e){var t=i(e);return r(t)}function i(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=i,e.exports=a,a.id=8293}},e=>{"use strict";e.O(0,[216],(()=>(5858,e(e.s=5858)))),e.O()}]);
//# sourceMappingURL=main.6b44553333ca8bcf2916.js.map